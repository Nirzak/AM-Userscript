// ==UserScript==
// @namespace   ame-applemusic
// @name        Ame (Apple Music)
// @version     1.11.0
// @author      Original Author
// @run-at      document-start
// @match       https://music.apple.com/*
// @grant       GM.addStyle
// @grant       GM.setClipboard
// @grant       GM.xmlHttpRequest
// ==/UserScript==

(function(Gl){typeof define=="function"&&define.amd?define(Gl):Gl()})(function(){"use strict";const Gl=`@charset "UTF-8";/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 * 
 * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in
 * Gdynia, Poland, at Aleja Zwycięstwa 96-98, registered by the District Court in Gdansk under number
 * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 * 
 * This software is protected by applicable copyright laws, including international treaties, and dual-
 * licensed – depending on whether your use for commercial purposes, meaning intended for or
 * resulting in commercial advantage or monetary compensation, or not.
 * 
 * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing
 * the suitability, performance, and usefulness of this software outside the production environment,
 * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.
 * 
 * Your use of this software for commercial purposes is subject to the terms included in an applicable
 * license agreement.
 * 
 * In any case, you must not make any such use of this software as to develop software which may be
 * considered competitive with this software.
 * 
 * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO
 * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,
 * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM
 * USE OR INABILITY TO USE THIS SOFTWARE.
 * 
 * Version: 13.0.0
 * Release date: 22/06/2023 (built at 22/06/2023 12:52:47)
 */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{height:auto;position:relative;width:0}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:auto}.handsontable table.htCore{border-collapse:separate;border-spacing:0;border-width:0;cursor:default;margin:0;max-height:none;max-width:none;outline-width:0;table-layout:fixed;width:0}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{background-color:#fff;border-bottom:1px solid #ccc;border-left-width:0;border-right:1px solid #ccc;border-top-width:0;empty-cells:show;height:22px;line-height:21px;outline-width:0;overflow:hidden;padding:0 4px;vertical-align:top;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-left:1px solid #ccc;border-right-width:0}.handsontable th:last-child{border-bottom:1px solid #ccc;border-left:none;border-right:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-left:1px solid #ccc;border-right:none}.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2){border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-left:1px solid #ccc;border-right-width:0}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left:1px solid #ccc;border-right-width:0}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;font-weight:400;text-align:center;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{font-size:0;position:absolute}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{cursor:crosshair;font-size:0}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:13px;font-weight:400;touch-action:manipulation}.handsontable a{color:#104acc}.handsontable.htAutoSize{left:-99000px;position:absolute;top:-99000px;visibility:hidden}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}.hot-display-license-info{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:10px;font-weight:400;padding:5px 0 3px;text-align:left}.hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{cursor:col-resize;height:25px;position:absolute;top:0;width:5px;z-index:210}.handsontable .manualRowResizer{cursor:row-resize;height:5px;left:0;position:absolute;width:50px;z-index:210}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{background-color:#34a9db;border-left:none;border-right:1px dashed #777;display:none;margin-left:5px;margin-right:unset;position:absolute;right:unset;top:0;width:0}[dir=rtl].handsontable .manualColumnResizerGuide{border-left:1px dashed #777;border-right:none;left:unset;margin-left:unset;margin-right:5px}.handsontable .manualRowResizerGuide{background-color:#34a9db;border-bottom:1px dashed #777;bottom:0;display:none;height:0;left:0;margin-top:5px;position:absolute}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{cursor:pointer;text-decoration:underline}.handsontable span.colHeader.columnSorting:before{background-position-x:right;background-repeat:no-repeat;background-size:contain;content:"";height:10px;left:unset;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;top:50%;width:5px}[dir=rtl].handsontable span.colHeader.columnSorting:before{background-position-x:left;left:-9px;padding-left:0;padding-right:8px;right:unset}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC)}.handsontable span.colHeader.columnSorting.descending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=)}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;padding-right:20px;position:relative}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{background:#005eff;bottom:0;bottom:-100%\\	;content:"";left:0;position:absolute;right:0;top:0}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{background-color:#fff;border:none;border-radius:0;box-shadow:inset 0 0 0 2px #5292f7;color:#000;display:block;font-family:inherit;font-size:inherit;line-height:21px;margin:0;outline-width:0;padding:1px 5px 0;resize:none}.handsontableInput:focus{outline:none}.handsontableInputHolder{left:0;position:absolute;top:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{color:#777;content:"▶";font-size:9px;position:absolute;right:5px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{color:#777;content:"◀";font-size:9px;left:5px;position:absolute}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{background:#fff;border:1px solid #ccc;border-collapse:separate}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{text-overflow:ellipsis;white-space:nowrap}.handsontable.listbox td.htDimmed{color:inherit;cursor:default;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable .collapsibleIndicator{background:#eee;border:1px solid #a6a6a6;border-radius:10px;-webkit-box-shadow:0 0 0 6px #eee;-moz-box-shadow:0 0 0 6px #eee;box-shadow:0 0 0 6px #eee;color:#222;cursor:pointer;font-size:10px;height:10px;left:unset;line-height:8px;position:absolute;right:5px;text-align:center;top:50%;transform:translateY(-50%);width:10px}[dir=rtl].handsontable .collapsibleIndicator{left:5px;right:unset}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.handsontable.mobile .handsontableInput:focus{-webkit-appearance:none;-webkit-box-shadow:inset 0 0 0 2px #5292f7;-moz-box-shadow:inset 0 0 0 2px #5292f7;box-shadow:inset 0 0 0 2px #5292f7}.topSelectionHandle-HitArea:not(.ht_master .topSelectionHandle-HitArea),.topSelectionHandle:not(.ht_master .topSelectionHandle){z-index:9999}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:unset;top:-10000px}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{left:unset;right:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}/*!
 * Pikaday
 * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/
 */.pika-single{background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;color:#333;display:block;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;position:relative;z-index:9999}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{box-shadow:0 5px 15px -5px #00000080;position:absolute}.pika-lendar{float:left;margin:8px;width:240px}.pika-title{position:relative;text-align:center}.pika-label{background-color:#fff;display:inline-block;font-size:14px;font-weight:700;line-height:20px;margin:0;overflow:hidden;padding:5px 3px;position:relative;z-index:9999}.pika-title select{cursor:pointer;left:0;margin:0;opacity:0;position:absolute;top:5px;z-index:9998}.pika-next,.pika-prev{background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;border:0;cursor:pointer;display:block;height:30px;opacity:.5;outline:none;overflow:hidden;padding:0;position:relative;text-indent:20px;white-space:nowrap;width:20px}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==);float:left}.is-rtl .pika-prev,.pika-next{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=);float:right}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{border:0;border-collapse:collapse;border-spacing:0;width:100%}.pika-table td,.pika-table th{padding:0;width:14.2857142857%}.pika-table th{color:#999;font-size:12px;font-weight:700;line-height:25px;text-align:center}.pika-button{background:#f5f5f5;border:0;box-sizing:border-box;-moz-box-sizing:border-box;color:#666;cursor:pointer;display:block;font-size:12px;height:auto;line-height:15px;margin:0;outline:none;padding:5px;text-align:right;width:100%}.pika-week{color:#999;font-size:11px}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{background:#3af;border-radius:3px;box-shadow:inset 0 1px 3px #178fe5;color:#fff;font-weight:700}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{background:#6cb31d;border-radius:3px;box-shadow:none;color:#fff}.is-endrange .pika-button{background:#3af;border-radius:3px;box-shadow:none;color:#fff}.is-disabled .pika-button{color:#999;cursor:default;opacity:.3;pointer-events:none}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{cursor:default;pointer-events:none}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{background:#ff8000;border-radius:3px;box-shadow:none;color:#fff}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{color:#eee;cursor:default;float:right;font-size:10px;text-align:center;width:16px}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;font-size:inherit;vertical-align:middle}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{border-left:6px solid transparent;border-right:none;border-top:6px solid #000;content:"";left:unset;position:absolute;right:0;top:0}[dir=rtl].handsontable .htCommentCell:after{border-left:none;border-right:6px solid transparent;left:0;right:unset}.htCommentsContainer .htComments{display:none;position:absolute;z-index:1059}.htCommentsContainer .htCommentTextArea{-webkit-appearance:none;background-color:#fff;border:none;border-left:3px solid #ccc;box-shadow:0 1px 3px #0000001e,0 1px 2px #0000003d;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-size:12px;height:90px;outline:0!important;padding:5px;width:215px}[dir=rtl].htCommentsContainer .htCommentTextArea{border-left:none;border-right:3px solid #ccc}.htCommentsContainer .htCommentTextArea:focus{border-left:3px solid #5292f7;border-right:none;box-shadow:0 1px 3px #0000001e,0 1px 2px #0000003d,inset 0 0 0 1px #5292f7}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-left:none;border-right:3px solid #5292f7}/*!
 * Handsontable ContextMenu
 */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-left-width:2px;border-right-width:1px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htContextMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}[dir=rtl].htContextMenu table tbody tr td .htItemWrapper{margin-left:6px;margin-right:10px}.htContextMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htContextMenu table tbody tr td div span.selected{left:0;right:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{opacity:0;outline:0 none!important;overflow:hidden;position:fixed!important;right:100%!important;top:0!important}/*!
 * Handsontable DropdownMenu
 */.handsontable .changeType{background:#eee;border:1px solid #bbb;border-radius:2px;color:#bbb;float:right;font-size:9px;line-height:9px;margin:3px 1px 0 5px;padding:2px}[dir=rtl].handsontable .changeType{float:left}.handsontable .changeType:before{content:"▼ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-left-width:2px;border-right-width:1px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper,[dir=rtl].htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htDropdownMenu table tbody tr td div span.selected{left:0;right:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}/*!
 * Handsontable Filters
 */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{padding-bottom:3px;padding-top:10px;text-align:center}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{box-sizing:border-box;font-family:inherit;font-size:.75em;padding:4px;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{background-color:#d2e0d9;border:1px solid #509272;color:#18804e}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-left:10px;margin-right:0}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{height:1em;margin:0 5px 0 0;vertical-align:middle}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border:1px solid #d2d1d1;border-radius:2px}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-left:10px;margin-right:0}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border:1px solid #d2d1d1;border-radius:2px;font-family:inherit;font-size:.75em;font-weight:700;overflow:hidden;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"▲";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"▼";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border:1px solid #d2d1d1;border-radius:2px;padding:3px}.handsontable .htUIRadio{display:inline-block;height:100%;margin-left:0;margin-right:5px}[dir=rtl].handsontable .htUIRadio{margin-left:5px;margin-right:0}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-left:.5ex;margin-right:0}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;font-size:5pt;position:absolute;top:50%;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{content:"◀";right:1px}[dir=rtl].handsontable th.beforeHiddenColumn:after{content:"▶";left:1px;right:auto}.handsontable th.afterHiddenColumn:before{content:"▶";left:1px}[dir=rtl].handsontable th.afterHiddenColumn:before{content:"◀";left:auto;right:1px}/*!
 * Handsontable HiddenRows
 */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;left:2px;line-height:6pt;position:absolute}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{bottom:2px;content:"▲"}.handsontable th.afterHiddenRow:after{content:"▼";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{display:none;height:100%;position:absolute}.handsontable .ht__manualColumnMove--guideline{background:#757575;margin-inline-end:0;margin-inline-start:-1px;top:0;width:2px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:#34343440;display:none;pointer-events:none;z-index:205}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{display:none;position:absolute;width:100%}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:#34343440;display:none;pointer-events:none;z-index:205}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{font-size:8px;height:8px;left:unset;line-height:1.1;margin-top:-2px;padding-left:5px;padding-right:unset;position:absolute;right:-15px;text-decoration:underline;top:50%}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;padding-left:unset;padding-right:5px;right:unset}.handsontable span.colHeader.columnSorting:after{text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{padding-left:7px;text-align:left}[dir=rtl].handsontable th.ht_nestingLevels{padding-right:7px;text-align:right}.handsontable th div.ht_nestingLevels{display:inline-block;left:11px;position:absolute;right:unset}[dir=rtl].handsontable th div.ht_nestingLevels{left:unset;right:11px}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:unset;right:10px}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:unset}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;float:left;height:1px;width:10px}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{bottom:3px;content:"┐";display:inline-block;font-size:9px;position:relative}.handsontable th div.ht_nestingButton{cursor:pointer;display:inline-block;left:unset;position:absolute;right:-2px}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:unset}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:unset;right:0}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:unset}`;function Qt(e){const t=document.createElement("template");return t.innerHTML=e,t.content.firstElementChild}function Yl(e,t){return new Promise(r=>{const n=t==null?void 0:t.waitSelector,i=(t==null?void 0:t.timeout)??3e3;if(i!==0){const s=document.querySelector(e);if(s){r(s);return}}const o=setTimeout(()=>{i!==0&&(a.disconnect(),r(null))},i),a=new MutationObserver(s=>{for(const l of s)for(const u of Array.from(l.addedNodes))if(u instanceof Element&&u.matches(n??e)){i!==0&&(a.disconnect(),clearTimeout(o)),r(n?document.querySelector(e):u);return}});a.observe(document.body,{childList:!0,subtree:!0})})}const zA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 80" height="32">
	<path d="M25.5 14.9c-6.9 1.7-13.4 6.9-15.4 12.4-.6 1.6-1.1 5.2-1.1 8.1 0 7.3 5.3 17.9 13 25.7 5.6 5.7 6 5.9 10.9 5.9H38l-6.3-6.4c-8-8.2-11.7-15-12.4-22.5-.7-7.6 2-13.2 7.9-16.2 3.8-2 5.3-2.1 16.3-1.6 7.8.3 14.6 1.3 19.4 2.7 4 1.1 7.6 1.8 7.9 1.5 2.3-2.2-12.4-7.5-26.4-9.5-8.4-1.1-14.4-1.2-18.9-.1z" />
	<path d="M38 27.2c-12.8 6.5-11.9 21.3 2.1 34.3 4.6 4.2 6.7 5.5 9.1 5.5h3.1l-5.5-5.8c-7.2-7.5-10.2-13.3-9.5-18.3.6-4.7 3.2-8.4 7.4-10.4 3.5-1.7 17.3-2 23.6-.6 2.9.7 3.7.6 3.7-.5 0-1.8-3.5-3.2-12.8-5-10.5-2-16-1.8-21.2.8zM95.2 41.3c-3.4 8.9-6.2 16.6-6.2 17 0 .4.9.7 1.9.7 1.4 0 2.4-1.3 3.7-4.5l1.7-4.5h14.5l1.4 4.2c1.1 3.1 2.1 4.4 3.6 4.6 1.2.2 2.2 0 2.2-.5 0-.4-2.8-8.1-6.2-17-8.3-21.6-8.3-21.6-16.6 0zm13.8 4.4c0 .2-2.5.3-5.6.3-4.1 0-5.5-.3-5.2-1.3.3-.6 1.5-4.3 2.8-8.1l2.3-6.9 2.8 7.8c1.6 4.4 2.9 8 2.9 8.2zM126.2 41.3c-3.4 8.9-6.2 16.5-6.2 16.9 0 .5.9.8 1.9.8 1.4 0 2.4-1.3 3.7-4.5l1.7-4.5h14.5l1.4 4.2c1.1 3.2 2.1 4.4 3.7 4.6 2.8.4 3 1.2-4.4-18.1-8-20.9-8-20.9-16.3.6zm13.8 4.4c0 .2-2.5.3-5.6.3-4.1 0-5.5-.3-5.2-1.3.3-.6 1.5-4.3 2.8-8.1l2.3-7 2.8 8c1.6 4.3 2.9 8 2.9 8.1zM160.3 27.1c-8.3 4.1-11.6 15.2-7.1 23.9 2.8 5.5 7.3 8.2 13.6 8.3 6.2.1 9.2-1 9.2-3.3 0-1.7-.4-1.8-3.1-.8-4.3 1.5-10.6.4-13.5-2.3-3-2.8-4.7-8.8-3.8-13.5 1.4-7.6 9.1-12.5 16.4-10.4 1.9.6 3.6 1 3.7 1 1.1 0 0-3.9-1.3-4.4-3.2-1.2-10-.5-14.1 1.5z" />
	<path d="M54.3 35.7c-2.8.5-7.2 4.9-7.9 8-1.1 4.1.6 9.1 4.6 14.1 5.5 7 9.5 9.2 16.5 9.2h5.7l-.4-14.1c-.3-13.4-.5-14.2-2.7-16-2.3-1.8-9.6-2.4-15.8-1.2z" />
</svg>
`,UA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 20" height="32">
	<path fill="#aeaeae" d="M17.48 1.22A2.78 2.78 0 0 1 19 3.88v11.25a2.722 2.722 0 0 1-1.34 2.59 2.204 2.204 0 0 1-1.1.28 4.2 4.2 0 0 1-2.68-1.24l-4.24-3.38a.81.81 0 0 1-.295-.757.805.805 0 0 1 .175-.383.84.84 0 0 1 1.16-.12l4.25 3.4c.81.69 1.52 1 1.9.77.14-.08.5-.28.5-1.18V3.88a1.229 1.229 0 0 0-.56-1.19c-.79-.36-1.72.63-2.08 1.07-.55.59-2.34 2.94-4.18 5.39l-.62.85-1.58 2.11c-1.52 2-2.84 3.81-3.31 4.38-1.23 1.7-2.47 1.66-3.29 1.33A2.998 2.998 0 0 1 0 14.76V9.59a2.785 2.785 0 0 1 1.45-2.78 3.084 3.084 0 0 1 3.42.83L6.47 9a.805.805 0 0 1 .28.761.795.795 0 0 1-.18.379.832.832 0 0 1-1.16.09L3.8 8.87c-1-.9-1.43-.71-1.62-.62-.19.09-.52.26-.53 1.35v5.16c0 .48.09 1.32.68 1.56.17.07.6.24 1.34-.78C4.13 15 5.45 13.2 7 11.15L7.85 10l.65-.87c2.16-2.89 4.25-5.65 4.94-6.4C15.26.54 16.87 1 17.48 1.22ZM43.15 3.42a1.294 1.294 0 0 0-1.119.665 1.29 1.29 0 0 0-.161.655h2.5a1.206 1.206 0 0 0-.577-1.144 1.205 1.205 0 0 0-.643-.176ZM25 2.27h-.08l-1 2.79h2Zm11.1 1.2c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.34 1.71.83 0 1.33-.64 1.33-1.71 0-1.07-.55-1.71-1.38-1.71Zm-5.34 0c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.33 1.71.82 0 1.25-.64 1.25-1.71 0-1.07-.46-1.71-1.29-1.71Zm-5.29-2.36 2.38 6.53h-1.09l-.6-1.77h-2.51l-.6 1.77H22l2.37-6.53ZM40.12.8v6.84h-1V.8Zm3 1.83a2.172 2.172 0 0 1 2.21 2.48v.33h-3.5a1.327 1.327 0 0 0 .617 1.262c.211.131.455.199.703.198a1.183 1.183 0 0 0 1.18-.62h.94a1.999 1.999 0 0 1-2.15 1.41 2.245 2.245 0 0 1-2.093-1.276 2.238 2.238 0 0 1-.197-1.264 2.282 2.282 0 0 1 2.33-2.52ZM31 2.64c1.26 0 2.06 1 2.06 2.54S32.24 7.72 31 7.72a1.617 1.617 0 0 1-1.53-.82h-.07v2.37h-1V2.73h.94v.81h.07a1.738 1.738 0 0 1 1.59-.9Zm5.34 0c1.27 0 2.06 1 2.06 2.54s-.79 2.54-2.05 2.54a1.61 1.61 0 0 1-1.52-.82h-.08v2.37h-1V2.73h.94v.81h.07a1.753 1.753 0 0 1 1.56-.9Zm.26 8.27a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm-7.3 0a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm43 2.8A1.278 1.278 0 0 0 71 15h2.5a1.203 1.203 0 0 0-.587-1.119 1.214 1.214 0 0 0-.633-.171Zm-39.46 0c-.85 0-1.32.64-1.32 1.64 0 1 .47 1.65 1.32 1.65.85 0 1.34-.64 1.34-1.65 0-1.01-.53-1.59-1.36-1.59Zm-8-1.49h-1.31V17h1.24c1.37 0 2.17-.87 2.17-2.39a2.099 2.099 0 0 0-.2-1.177 2.096 2.096 0 0 0-1.97-1.163Zm36 3.41-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72a1.17 1.17 0 0 0 1.28-1.11ZM44 15.68l-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72A1.168 1.168 0 0 0 44 16.11ZM24.88 11.4a2.894 2.894 0 0 1 2.83 1.572c.261.515.362 1.096.29 1.668 0 2.08-1.13 3.28-3.09 3.28h-2.4V11.4Zm4.89 1.6v4.91h-1V13Zm21.58-1.6 2.09 5.1h.08l2.1-5.1h1.19v6.52h-1v-4.78h-.01l-1.93 4.67h-.77l-1.93-4.67h-.06v4.78h-1V11.4ZM47 11.09v6.83h-1v-6.83ZM37.07 13v4.91h-1V13Zm40.49-.08c.149.015.296.041.44.08v.92a2.427 2.427 0 0 0-.55-.06 1.174 1.174 0 0 0-1.079.541 1.165 1.165 0 0 0-.181.599v2.93h-1V13h.94v.75h.07a1.34 1.34 0 0 1 1.36-.82Zm-38.19-1.15V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm29.17 0V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm-8.73 1.15c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69h-.08a1.678 1.678 0 0 1-1.49.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47l1.34-.07v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-.94c.05-.83.85-1.37 1.97-1.37Zm-16.75 0c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69H44a1.682 1.682 0 0 1-1.5.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47L44 15v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-1c.14-.83.94-1.37 2.06-1.37Zm21.44 0c1.12 0 1.84.51 1.94 1.36h-.94c-.09-.36-.44-.6-1-.6s-1 .26-1 .66.25.49.79.62l.82.19c.94.22 1.39.62 1.39 1.34 0 .91-.87 1.53-2.06 1.53s-2-.53-2-1.39h1c.082.212.233.39.429.505.197.114.426.158.651.125.61 0 1-.28 1-.68s-.23-.51-.73-.63l-.87-.2c-.94-.22-1.38-.63-1.38-1.36 0-.73.84-1.47 1.96-1.47Zm7.79 0a2.158 2.158 0 0 1 2.21 2.47v.34H71a1.326 1.326 0 0 0 .62 1.253c.21.13.453.198.7.197a1.174 1.174 0 0 0 1.18-.61h.94A2 2 0 0 1 72.29 18a2.237 2.237 0 0 1-2.085-1.265A2.245 2.245 0 0 1 70 15.48a2.29 2.29 0 0 1 .205-1.263 2.28 2.28 0 0 1 2.085-1.297Zm-39.74 0a1.73 1.73 0 0 1 1.56.86h.07V13h.94v5c0 1.12-.89 1.83-2.29 1.83-1.24 0-2-.55-2.15-1.37h1c.08.37.49.6 1.15.6.82 0 1.3-.4 1.3-1.06v-1h-.07a1.665 1.665 0 0 1-.647.632 1.667 1.667 0 0 1-.883.198c-1.27 0-2.05-1-2.05-2.45 0-1.45.8-2.45 2.07-2.45Z" />
	<path fill="#aeaeae" d="M43.15 3.42a1.294 1.294 0 0 0-1.119.665 1.29 1.29 0 0 0-.161.655h2.5a1.206 1.206 0 0 0-.577-1.144 1.205 1.205 0 0 0-.643-.176ZM25 2.27h-.08l-1 2.79h2Zm11.1 1.2c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.34 1.71.83 0 1.33-.64 1.33-1.71 0-1.07-.55-1.71-1.38-1.71Zm-5.34 0c-.83 0-1.34.66-1.34 1.71 0 1.05.51 1.71 1.33 1.71.82 0 1.25-.64 1.25-1.71 0-1.07-.46-1.71-1.29-1.71Zm-5.29-2.36 2.38 6.53h-1.09l-.6-1.77h-2.51l-.6 1.77H22l2.37-6.53ZM40.12.8v6.84h-1V.8Zm3 1.83a2.172 2.172 0 0 1 2.21 2.48v.33h-3.5a1.327 1.327 0 0 0 .617 1.262c.211.131.455.199.703.198a1.183 1.183 0 0 0 1.18-.62h.94a1.999 1.999 0 0 1-2.15 1.41 2.245 2.245 0 0 1-2.093-1.276 2.238 2.238 0 0 1-.197-1.264 2.282 2.282 0 0 1 2.33-2.52ZM31 2.64c1.26 0 2.06 1 2.06 2.54S32.24 7.72 31 7.72a1.617 1.617 0 0 1-1.53-.82h-.07v2.37h-1V2.73h.94v.81h.07a1.738 1.738 0 0 1 1.59-.9Zm5.34 0c1.27 0 2.06 1 2.06 2.54s-.79 2.54-2.05 2.54a1.61 1.61 0 0 1-1.52-.82h-.08v2.37h-1V2.73h.94v.81h.07a1.753 1.753 0 0 1 1.56-.9Zm.26 8.27a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm-7.3 0a.621.621 0 0 1 .557.893.625.625 0 0 1-.702.33.621.621 0 0 1 .125-1.223Zm43 2.8A1.278 1.278 0 0 0 71 15h2.5a1.203 1.203 0 0 0-.587-1.119 1.214 1.214 0 0 0-.633-.171Zm-39.46 0c-.85 0-1.32.64-1.32 1.64 0 1 .47 1.65 1.32 1.65.85 0 1.34-.64 1.34-1.65 0-1.01-.53-1.59-1.36-1.59Zm-8-1.49h-1.31V17h1.24c1.37 0 2.17-.87 2.17-2.39a2.099 2.099 0 0 0-.2-1.177 2.096 2.096 0 0 0-1.97-1.163Zm36 3.41-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72a1.17 1.17 0 0 0 1.28-1.11ZM44 15.68l-1.21.09c-.68 0-1 .28-1 .73 0 .45.39.72.92.72A1.168 1.168 0 0 0 44 16.11ZM24.88 11.4a2.894 2.894 0 0 1 2.83 1.572c.261.515.362 1.096.29 1.668 0 2.08-1.13 3.28-3.09 3.28h-2.4V11.4Zm4.89 1.6v4.91h-1V13Zm21.58-1.6 2.09 5.1h.08l2.1-5.1h1.19v6.52h-1v-4.78h-.01l-1.93 4.67h-.77l-1.93-4.67h-.06v4.78h-1V11.4ZM47 11.09v6.83h-1v-6.83ZM37.07 13v4.91h-1V13Zm40.49-.08c.149.015.296.041.44.08v.92a2.427 2.427 0 0 0-.55-.06 1.174 1.174 0 0 0-1.079.541 1.165 1.165 0 0 0-.181.599v2.93h-1V13h.94v.75h.07a1.34 1.34 0 0 1 1.36-.82Zm-38.19-1.15V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm29.17 0V13h1.07v.77h-1.07v2.6c0 .52.21.75.7.75.123.011.247.011.37 0v.78a4.26 4.26 0 0 1-.53 0c-1.09 0-1.52-.37-1.52-1.32V13.8h-.79V13h.79v-1.23Zm-8.73 1.15c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69h-.08a1.678 1.678 0 0 1-1.49.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47l1.34-.07v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-.94c.05-.83.85-1.37 1.97-1.37Zm-16.75 0c1.25 0 1.95.61 1.95 1.64v3.36h-.94v-.69H44a1.682 1.682 0 0 1-1.5.77 1.493 1.493 0 0 1-1.424-.675 1.497 1.497 0 0 1-.236-.785c0-.88.67-1.39 1.85-1.47L44 15v-.43c0-.53-.34-.84-1-.84-.66 0-.93.21-1 .56h-1c.14-.83.94-1.37 2.06-1.37Zm21.44 0c1.12 0 1.84.51 1.94 1.36h-.94c-.09-.36-.44-.6-1-.6s-1 .26-1 .66.25.49.79.62l.82.19c.94.22 1.39.62 1.39 1.34 0 .91-.87 1.53-2.06 1.53s-2-.53-2-1.39h1c.082.212.233.39.429.505.197.114.426.158.651.125.61 0 1-.28 1-.68s-.23-.51-.73-.63l-.87-.2c-.94-.22-1.38-.63-1.38-1.36 0-.73.84-1.47 1.96-1.47Zm7.79 0a2.158 2.158 0 0 1 2.21 2.47v.34H71a1.326 1.326 0 0 0 .62 1.253c.21.13.453.198.7.197a1.174 1.174 0 0 0 1.18-.61h.94A2 2 0 0 1 72.29 18a2.237 2.237 0 0 1-2.085-1.265A2.245 2.245 0 0 1 70 15.48a2.29 2.29 0 0 1 .205-1.263 2.28 2.28 0 0 1 2.085-1.297Zm-39.74 0a1.73 1.73 0 0 1 1.56.86h.07V13h.94v5c0 1.12-.89 1.83-2.29 1.83-1.24 0-2-.55-2.15-1.37h1c.08.37.49.6 1.15.6.82 0 1.3-.4 1.3-1.06v-1h-.07a1.665 1.665 0 0 1-.647.632 1.667 1.667 0 0 1-.883.198c-1.27 0-2.05-1-2.05-2.45 0-1.45.8-2.45 2.07-2.45ZM0 0" />
</svg>
`,GA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43 20" height="32">
	<path d="m11.418 12.526 2.344 5.44h-1.107l-.507-1.245H9.79l-.492 1.245H8.215l2.366-5.44h.837Zm6.521 0v.845h-1.668v4.595h-.968v-4.595h-1.667v-.845h4.303Zm2.721 0 1.413 3.865h.023l1.398-3.865h1.522v5.44h-.961v-4.372h-.015l-1.652 4.372h-.676l-1.628-4.372h-.016v4.372h-.922v-5.44h1.514Zm8.281.001c.405 0 .778.063 1.119.189.341.127.636.308.885.542.248.233.442.517.581.851.139.334.208.708.208 1.122 0 .405-.069.774-.208 1.108a2.57 2.57 0 0 1-.581.863 2.652 2.652 0 0 1-.885.563 3.034 3.034 0 0 1-1.119.201c-.399 0-.769-.067-1.107-.201a2.61 2.61 0 0 1-.878-.563 2.59 2.59 0 0 1-.577-.863 2.855 2.855 0 0 1-.208-1.108c0-.414.069-.788.208-1.122a2.453 2.453 0 0 1 1.455-1.393 3.15 3.15 0 0 1 1.107-.189Zm5.722.008c.262 0 .528.046.798.138.27.093.504.231.703.416l-.597.656a1.118 1.118 0 0 0-.412-.317 1.232 1.232 0 0 0-.857-.088.972.972 0 0 0-.291.124.682.682 0 0 0-.215.219.601.601 0 0 0-.084.324.576.576 0 0 0 .273.51c.085.059.189.11.31.153.122.044.255.088.401.132.165.053.337.114.514.182.177.068.34.158.488.269.148.112.27.253.365.423.094.17.142.382.142.634 0 .277-.051.519-.153.725a1.483 1.483 0 0 1-.409.514 1.74 1.74 0 0 1-.597.306 2.52 2.52 0 0 1-.722.102 2.71 2.71 0 0 1-.984-.186 1.895 1.895 0 0 1-.787-.55l.656-.612c.126.175.295.313.507.415.211.102.419.153.623.153.107 0 .216-.013.328-.04a.86.86 0 0 0 .302-.134.774.774 0 0 0 .219-.237.687.687 0 0 0 .084-.354.577.577 0 0 0-.095-.339.847.847 0 0 0-.255-.233 1.778 1.778 0 0 0-.379-.171l-.459-.153a4.663 4.663 0 0 1-.467-.175 1.55 1.55 0 0 1-.419-.27 1.29 1.29 0 0 1-.302-.412 1.4 1.4 0 0 1-.117-.608c0-.263.055-.489.164-.678.109-.189.253-.346.43-.47.178-.124.379-.216.605-.277.226-.061.456-.091.689-.091Zm-5.714.876a1.62 1.62 0 0 0-1.238.527c-.15.164-.266.356-.348.576-.082.221-.123.46-.123.718 0 .267.041.512.123.734.082.223.199.417.352.581.152.164.332.291.541.383.209.091.44.137.693.137.253 0 .485-.046.696-.137a1.61 1.61 0 0 0 .545-.383c.152-.164.269-.358.351-.581.082-.222.124-.467.124-.734 0-.258-.042-.497-.124-.718a1.763 1.763 0 0 0-.347-.576 1.627 1.627 0 0 0-.542-.387 1.707 1.707 0 0 0-.703-.14Zm-17.976.268-.853 2.212h1.69l-.837-2.212ZM38.017 3.527l1.55 3.484 1.549-3.484h1.3l-3.081 6.884a1.542 1.542 0 0 1-2.031.782l-.412-.184-.002-.001.148-.331.332-.747.171.076a.634.634 0 0 0 .837-.322l.003-.008.476-1.075.016-.035.044-.096-2.199-4.943h1.299ZM30.294 1.11v7.855h-1.189V1.11h1.189Zm2.192.001v2.905c.44-.308.976-.49 1.554-.49a2.722 2.722 0 0 1 2.719 2.719 2.722 2.722 0 0 1-2.719 2.718 2.702 2.702 0 0 1-1.554-.49v.492h-1.192V1.111h1.192Zm-6.869 2.415a2.72 2.72 0 0 1 2.718 2.718 2.72 2.72 0 0 1-2.718 2.719 2.721 2.721 0 0 1-2.719-2.719 2.72 2.72 0 0 1 2.719-2.718ZM3.157 1.109A3.93 3.93 0 0 1 7.08 5.032a3.93 3.93 0 0 1-3.923 3.923H2V1.109h1.157Zm10.005 0v7.846h-1.157a3.93 3.93 0 0 1-3.924-3.923 3.93 3.93 0 0 1 3.924-3.923h1.157Zm5.21 0a3.928 3.928 0 0 1 3.923 3.923 3.928 3.928 0 0 1-3.923 3.923h-2.834V1.109Zm7.245 3.486a1.64 1.64 0 0 0 0 3.278 1.64 1.64 0 0 0 1.639-1.639c0-.899-.74-1.639-1.639-1.639Zm8.423 0a1.64 1.64 0 0 0 0 3.279c.9 0 1.639-.73 1.639-1.639 0-.9-.739-1.64-1.639-1.64ZM18.372 2.299h-1.645v5.467h1.645a2.738 2.738 0 0 0 2.733-2.734 2.737 2.737 0 0 0-2.733-2.733Z" stroke="#00000000" fill-rule="evenodd" />
</svg>
`,YA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 20" height="32">
	<path d="M9.21 3.13c.131.166.249.344.35.53a7.554 7.554 0 0 0-.49.94c-.1-.2-.2-.4-.31-.59.134-.301.284-.595.45-.88ZM7.64 7.82c.08.25.17.51.25.77-.15.76-.25 1.46-.32 2a.204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.1-.75.25-1.72.45-2.72Zm-2-4.69c.135.166.255.343.36.53a19.651 19.651 0 0 0-2 7 .204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.29-2.12.8-5.43 2.01-7.48Zm13.23 4.92a.192.192 0 0 1 .159.118.187.187 0 0 1 .011.102C19 9.07 18.8 10 18.6 11l-.25-.77c.14-.76.25-1.46.32-2a.204.204 0 0 1 .065-.129.202.202 0 0 1 .135-.051Zm3.58 0a.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.32 2.09-.83 5.4-2 7.45a5.451 5.451 0 0 1-.35-.53 19.87 19.87 0 0 0 2-7 .21.21 0 0 1 .064-.096.204.204 0 0 1 .106-.044Zm-5.28 6.21.3.59a7.082 7.082 0 0 1-.44.88 4.454 4.454 0 0 1-.35-.53c.179-.305.343-.618.49-.94Zm-8.64-13a2.895 2.895 0 0 1 1.75.62 4.1 4.1 0 0 1 .54.48c2.71 2.79 3.86 10.16 5.68 13.14.085.153.185.297.3.43a1.81 1.81 0 0 0 1.38.88c.19-.002.377-.043.55-.12.175.189.366.363.57.52a3 3 0 0 1-1.59.44A2.861 2.861 0 0 1 16 17a5.34 5.34 0 0 1-.55-.48c-2.7-2.8-3.85-10.16-5.67-13.14-.55-.9-1.26-1.58-2.23-1.19a4.765 4.765 0 0 0-.57-.53 3.003 3.003 0 0 1 1.55-.43Zm-4.06 0c6-.81 6.42 15.51 10.13 15.51.19-.002.377-.043.55-.12.173.192.363.366.57.52-.48.289-1.03.442-1.59.44C10.88 17.62 9.26 11.88 8 8c-.08-.26-.17-.51-.25-.76a19.99 19.99 0 0 0-1.6-3.87 4.491 4.491 0 0 0-.37-.53 1.53 1.53 0 0 0-2.36-.38C1.55 3.82.68 8.33.41 10.62a.211.211 0 0 1-.21.18.211.211 0 0 1-.2-.22C.41 8 1.08 3.57 3 1.92a2.878 2.878 0 0 1 1.47-.65Zm7.64 0c3.25 0 4.86 5.75 6.12 9.61.08.26.17.51.25.76a19.99 19.99 0 0 0 1.6 3.87c.111.18.231.353.36.52a1.743 1.743 0 0 0 1.32.79 1.817 1.817 0 0 0 1-.4c1.87-1.35 2.74-5.85 3-8.14a.195.195 0 0 1 .068-.122.196.196 0 0 1 .132-.048.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.41 2.59-1.08 7-3 8.66a3 3 0 0 1-1.93.69c-5.43 0-6.07-15.54-9.65-15.54-.19.002-.377.043-.55.12a4.765 4.765 0 0 0-.57-.53 3 3 0 0 1 1.67-.49ZM36.59 1a.6.6 0 1 1-.021 1.2.6.6 0 0 1 .021-1.2Zm7.81 1.31H43v2.28h1.44a1.07 1.07 0 0 0 1.21-1.14 1.097 1.097 0 0 0-.623-1.042 1.094 1.094 0 0 0-.627-.098Zm5 1.43A1.259 1.259 0 0 0 48.1 5h2.45a1.19 1.19 0 0 0-1.19-1.26Zm-8.42 1.1v.88H38v-.88Zm3.6-3.36a1.915 1.915 0 0 1 1.865.94c.186.321.275.69.255 1.06a1.826 1.826 0 0 1-1.24 1.82l1.44 2.6h-1.19L44.4 5.4H43v2.45h-1V1.48Zm-7.52 1.57v4.8h-1v-4.8Zm-6.29-1.57v2.69h3.29V1.48h1v6.37h-1V5h-3.29v2.85h-1V1.48ZM49.36 3a2.118 2.118 0 0 1 2.16 2.42v.33H48.1a1.305 1.305 0 0 0 .608 1.224c.204.127.441.195.682.196a1.153 1.153 0 0 0 1.15-.6h.92A1.998 1.998 0 0 1 49.36 8a2.193 2.193 0 0 1-2.041-1.254 2.193 2.193 0 0 1-.189-1.236 2.214 2.214 0 0 1 1.024-2.173c.362-.225.78-.343 1.206-.337ZM54 3c1.09 0 1.8.51 1.89 1.34H55a.902.902 0 0 0-1-.6c-.53 0-.94.27-.94.65s.25.49.77.61l.8.19c.92.21 1.36.6 1.36 1.3 0 .89-.85 1.5-2 1.5s-1.9-.52-2-1.35h1a1.004 1.004 0 0 0 1 .6c.6 0 1-.27 1-.66s-.23-.5-.71-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.8-1.44 1.91-1.44Zm-2 10.79a1.247 1.247 0 0 0-1.096.64 1.245 1.245 0 0 0-.154.64h2.44A1.18 1.18 0 0 0 52 13.79Zm-15.75 0c-.83 0-1.29.62-1.29 1.69 0 1.07.46 1.68 1.29 1.68.83 0 1.3-.62 1.3-1.68s-.44-1.66-1.27-1.66Zm12.79-2.6v6.69h-1v-6.66Zm-18.3.31v5.52h3v.86h-4v-6.35ZM45.39 13c1.08 0 1.8.51 1.89 1.34h-.92c-.09-.36-.43-.59-1-.59-.57 0-.94.26-.94.65s.24.48.77.6l.8.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35h1a1.003 1.003 0 0 0 1 .61c.59 0 1-.28 1-.67s-.23-.49-.71-.61l-.85-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.86-1.44 1.96-1.44ZM41 13c1.09 0 1.8.51 1.9 1.34H42c-.09-.36-.43-.59-1-.59-.57 0-.93.26-.93.65s.24.48.76.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35H40a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.23-.49-.72-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.78-1.44 1.85-1.44Zm15.63 0c1.09 0 1.8.51 1.9 1.34h-.92c-.09-.36-.44-.59-1-.59s-.94.26-.94.65.25.48.77.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.9-.52-2-1.35h1a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.21-.48-.66-.58l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.75-1.47 1.84-1.47ZM61 13c1.09 0 1.8.51 1.9 1.34H62c-.09-.36-.43-.59-1-.59-.57 0-.93.26-.93.65s.24.48.76.6l.81.19c.92.21 1.35.6 1.35 1.3 0 .89-.85 1.5-2 1.5s-1.91-.52-2-1.35h1a.995.995 0 0 0 1.06.61c.59 0 1-.28 1-.67s-.23-.49-.72-.61l-.84-.2c-.92-.21-1.35-.62-1.35-1.33 0-.71.78-1.44 1.86-1.44Zm-24.72 0a2.23 2.23 0 0 1 2.29 2.5 2.294 2.294 0 0 1-1.549 2.32A2.29 2.29 0 0 1 34 15.5a2.217 2.217 0 0 1 2.28-2.5ZM52 13a2.118 2.118 0 0 1 2.16 2.42v.33h-3.38a1.29 1.29 0 0 0 1.28 1.42 1.158 1.158 0 0 0 1.16-.6h.92A2.002 2.002 0 0 1 52 18a2.194 2.194 0 0 1-2.046-1.246 2.185 2.185 0 0 1-.194-1.234A2.232 2.232 0 0 1 52 13Z" fill-rule="evenodd" />
</svg>
`,KA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 20" height="32">
	<path d="M9.21 3.13c.131.166.249.344.35.53a7.554 7.554 0 0 0-.49.94c-.1-.2-.2-.4-.31-.59.134-.301.284-.595.45-.88ZM7.64 7.82c.08.25.17.51.25.77-.15.76-.25 1.46-.32 2a.204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.1-.75.25-1.72.45-2.72Zm-2-4.69c.135.166.255.343.36.53a19.651 19.651 0 0 0-2 7 .204.204 0 0 1-.065.129.202.202 0 0 1-.135.051.21.21 0 0 1-.18-.23c.29-2.12.8-5.43 2.01-7.48Zm13.23 4.92a.192.192 0 0 1 .159.118.187.187 0 0 1 .011.102C19 9.07 18.8 10 18.6 11l-.25-.77c.14-.76.25-1.46.32-2a.204.204 0 0 1 .065-.129.202.202 0 0 1 .135-.051Zm3.58 0a.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.32 2.09-.83 5.4-2 7.45a5.451 5.451 0 0 1-.35-.53 19.87 19.87 0 0 0 2-7 .21.21 0 0 1 .064-.096.204.204 0 0 1 .106-.044Zm-5.28 6.21.3.59a7.082 7.082 0 0 1-.44.88 4.454 4.454 0 0 1-.35-.53c.179-.305.343-.618.49-.94Zm-8.64-13a2.895 2.895 0 0 1 1.75.62 4.1 4.1 0 0 1 .54.48c2.71 2.79 3.86 10.16 5.68 13.14.085.153.185.297.3.43a1.81 1.81 0 0 0 1.38.88c.19-.002.377-.043.55-.12.175.189.366.363.57.52a3 3 0 0 1-1.59.44A2.861 2.861 0 0 1 16 17a5.34 5.34 0 0 1-.55-.48c-2.7-2.8-3.85-10.16-5.67-13.14-.55-.9-1.26-1.58-2.23-1.19a4.765 4.765 0 0 0-.57-.53 3.003 3.003 0 0 1 1.55-.43Zm-4.06 0c6-.81 6.42 15.51 10.13 15.51.19-.002.377-.043.55-.12.173.192.363.366.57.52-.48.289-1.03.442-1.59.44C10.88 17.62 9.26 11.88 8 8c-.08-.26-.17-.51-.25-.76a19.99 19.99 0 0 0-1.6-3.87 4.491 4.491 0 0 0-.37-.53 1.53 1.53 0 0 0-2.36-.38C1.55 3.82.68 8.33.41 10.62a.211.211 0 0 1-.21.18.211.211 0 0 1-.2-.22C.41 8 1.08 3.57 3 1.92a2.878 2.878 0 0 1 1.47-.65Zm7.64 0c3.25 0 4.86 5.75 6.12 9.61.08.26.17.51.25.76a19.99 19.99 0 0 0 1.6 3.87c.111.18.231.353.36.52a1.743 1.743 0 0 0 1.32.79 1.817 1.817 0 0 0 1-.4c1.87-1.35 2.74-5.85 3-8.14a.195.195 0 0 1 .068-.122.196.196 0 0 1 .132-.048.206.206 0 0 1 .164.117c.014.032.02.068.016.103-.41 2.59-1.08 7-3 8.66a3 3 0 0 1-1.93.69c-5.43 0-6.07-15.54-9.65-15.54-.19.002-.377.043-.55.12a4.765 4.765 0 0 0-.57-.53 3 3 0 0 1 1.67-.49ZM52.68 8.17a1.313 1.313 0 0 0-1.3 1.34h2.53a1.233 1.233 0 0 0-1.23-1.34Zm-16.25 0c-.86 0-1.34.64-1.34 1.75 0 1.11.48 1.74 1.34 1.74.86 0 1.34-.64 1.34-1.74s-.49-1.71-1.34-1.71Zm13.19-2.65v6.93h-1V5.52Zm-18.88.31v5.72h3.1v.9h-4.13V5.83ZM62 7.37c1.12 0 1.86.52 1.95 1.39H63a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.79.62l.83.2c.95.22 1.4.63 1.4 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21C60.45 10 60 9.6 60 8.86c0-.74.82-1.49 2-1.49Zm-4.5 0c1.12 0 1.86.52 1.95 1.39h-.94a.938.938 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.79.62l.83.2c.95.22 1.4.63 1.4 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21C56 10 55.51 9.6 55.51 8.86c0-.74.81-1.49 1.94-1.49Zm-4.77 0c1.39 0 2.23 1 2.23 2.51v.34h-3.58a1.34 1.34 0 0 0 1.33 1.47 1.178 1.178 0 0 0 1.19-.63h1a2.003 2.003 0 0 1-2.16 1.43A2.26 2.26 0 0 1 50.38 10a2.3 2.3 0 0 1 2.3-2.63Zm-6.86 0c1.12 0 1.86.52 2 1.39h-.94a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.26.5.8.62l.83.2c1 .22 1.39.63 1.39 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.12.39.49.63 1.09.63.6 0 1.05-.28 1.05-.69 0-.41-.24-.51-.74-.63l-.87-.21c-1-.22-1.39-.64-1.39-1.38 0-.74.67-1.49 1.8-1.49Zm-9.39 0a2.292 2.292 0 0 1 2.3 2.63 2.357 2.357 0 0 1-1.597 2.388 2.356 2.356 0 0 1-2.72-.923A2.357 2.357 0 0 1 34.07 10a2.295 2.295 0 0 1 1.076-2.299c.386-.235.833-.35 1.284-.331Zm4.89 0c1.12 0 1.86.52 2 1.39h-.94a.93.93 0 0 0-1-.62c-.55 0-1 .27-1 .68 0 .41.25.5.8.62l.83.2c1 .22 1.39.63 1.39 1.35 0 .93-.88 1.55-2.07 1.55s-2-.53-2-1.4h1c.082.212.233.39.429.505.197.114.426.158.651.125.62 0 1-.28 1-.69 0-.41-.23-.51-.73-.63l-.87-.21c-1-.22-1.39-.64-1.39-1.38 0-.74.72-1.49 1.85-1.49Z" fill-rule="evenodd" />
</svg>
`,ZA=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1869 900" height="38">
	<path d="M508.4 55.6c13.5 13.9 1 29.8-29.9 38.1-9.3 2.5-11.4 2.7-31.5 2.7-22.9.1-31.2-1.1-45.2-6.4-20.6-7.7-28.6-22.4-18.4-33.9l2.1-2.4-3.4 1.9c-7.8 4.3-14.1 12.8-14.1 18.9 0 13.3 21 26.1 50.7 30.9 38.1 6.1 80.1-.7 99-16 4.7-3.8 8.3-10.5 8.3-15.3 0-7-6.7-14.9-16.9-20.1l-4.4-2.2 3.7 3.8z" />
	<path d="M353.3 79.9c-20.1 9.6-31.3 22.3-31.3 35.8 0 23.7 33.9 43.1 89.5 51.5 11.9 1.7 61.9 1.7 73 0 26.8-4.3 47-10.1 61.2-17.7 19.7-10.4 28.6-21.1 28.5-34.1-.1-9.5-4.4-16.7-15.4-25.7-4.8-3.9-13.3-8.8-19.3-11.2l-4-1.6 3 2.3c11.8 9 17 16.9 16.9 26.3 0 7.9-2.3 12.5-9.9 20-13 13-39.9 22.9-71.4 26.5-12.1 1.4-40.1 1.4-52.2 0-31.5-3.6-58.3-13.5-71.4-26.5-7.6-7.5-9.9-12.1-9.9-20-.1-9.4 5.3-17.7 16.9-26.2 4-3 3.2-2.9-4.2.6zM1053.5 181c-29.2 3.1-51.5 19.4-57.5 41.9-1.8 6.9-1.4 21.6.8 28.8 6.7 21.5 23.1 31.9 64.3 40.8 26.1 5.7 33.8 8.6 41.7 15.8 6.2 5.8 8.2 10.4 8.2 19.7 0 21-16.9 33.3-46 33.3-27.5-.1-44.9-10.2-49.9-29.1l-1.2-4.2H990v3.2c0 1.8.7 5.8 1.5 8.8 5.3 20.1 21.3 34.6 45.6 41.2 7.3 2 10.8 2.3 26.4 2.3 21.3 0 28-1.3 42.5-8.2 20.5-9.8 30.3-25.9 30.2-49.3-.1-15.7-4.5-26.5-14.8-35.9-10.2-9.4-23.1-14.2-60.3-22.6-23.2-5.2-33.6-10.8-38.5-20.7-2.9-5.8-3.5-14.8-1.5-20.9 1.8-5.1 6.3-10.8 11.6-14.6 13.3-9.4 39.5-10.8 55.8-2.9 9.5 4.7 17.6 15.1 19.1 24.5l.7 4.1h12.3c14.3 0 13.6.7 10.9-10.9-4.7-19.8-21.6-36.3-43.5-42.5-5.4-1.5-21.5-3.7-25.5-3.5-1.1.1-5.1.5-9 .9zM1740 282.5V381h23V184h-23v98.5zM1547.1 186.7c-10.7 5.6-10.6 21 .2 26.2 2.4 1.2 5.3 2.1 6.5 2.1 6.4 0 13.6-6.2 14.8-12.6.9-4.8-1.9-11.8-5.8-14.5-4.2-3-11.3-3.5-15.7-1.2zM1463 219.5V239h-21v18.9l10.3.3 10.2.3.5 50c.5 48 .6 50.2 2.6 55.1 3.3 8 6.9 12.1 13.8 15.4 7.6 3.7 17.8 5.4 27.4 4.5l7.2-.7v-18.5l-8.5-.5c-9.5-.5-12.5-2-16-7.9-1.9-3.3-2-5.2-2-50.4v-47l13.3-.3 13.2-.3V239h-27v-39h-24v19.5zM766.7 226.5c-23.5 6.1-34.1 50.8-25.2 106.5 5.9 36.8 20 75.1 37.6 102 7 10.7 22.8 27.1 30.1 31.3 9.9 5.7 19.9 6.7 27.8 2.7 10.6-5.4 19.8-23 22.4-43l.6-4.5-2 5.3c-5.7 15.6-14.7 23.5-26.6 23.6-23.2 0-51.2-35.7-65.8-83.7-7-23.3-9.8-41.6-9.9-64.2 0-25.6 5.1-44 15-53.9 5.7-5.7 8.8-7 16.8-7.1 8.1 0 14.6 2.8 23 9.8 5.8 4.9 5.2 3.5-2.4-5.2-13.7-15.7-28.9-22.9-41.4-19.6zM109.2 229.5c-7.2 3.6-18.5 13.3-24.4 20.8-1.8 2.3-2.6 3.7-1.8 3.1.8-.6 3.6-2.7 6.2-4.7 8.9-6.7 18.5-9 27.3-6.6 5.3 1.4 13.5 9.9 17 17.5 8.5 18.6 9.9 51.9 3.5 83.4-9.4 46.1-31.2 86.5-54.8 101.8-17.8 11.5-33.7 5.7-42.8-15.6l-2.5-5.7.7 4.5c2.4 17.8 10.5 34.1 19.7 39.5 13.4 7.8 27.3 3.7 44.3-13.1C133.2 423 158 353.3 158 295.8c0-29.5-5.7-51-16.4-61.8-6.1-6.2-10.3-8-18.4-8-5.9 0-8 .5-14 3.5zM1222 236.7c-13.5 2.3-27.5 11.4-33.8 22.3l-2.7 4.5-.3-12.3-.3-12.2H1161v190h24v-72.2l4.4 5.9c10.3 14 23.9 20.7 42.1 20.7 27.7 0 48.4-17.1 56.7-47 1.9-6.8 2.2-10.5 2.2-26.4.1-16.4-.2-19.4-2.2-26.5-7.3-25.4-22.9-41.4-44.7-46-6.6-1.4-16-1.7-21.5-.8zm14.5 21.8c17.9 4.6 29 21.7 30.2 47 1.5 31.2-11.4 52.7-34 56.5-20.8 3.6-38.9-9.8-45.3-33.3-.8-2.9-1.7-9.5-2-14.7-2.2-37.6 21.3-63.1 51.1-55.5zM1360.5 236.6c-23.5 3.8-39.1 16.2-44 34.9-2.3 9-2.9 8.5 10 8.5h11.4l1.3-4.3c.8-2.7 3-6 6.3-9.3 6.6-6.6 12.7-8.8 25-8.9 11.5 0 17.9 2.1 23.9 8 5.5 5.3 7.6 11.6 7.6 23.2 0 7.9-.1 8.3-2.2 8.3-11 .1-48.9 3.2-54.1 4.4-15.4 3.6-26.8 11.4-32.3 22.3-2.7 5.4-2.9 6.6-2.9 17.3 0 10.8.2 11.9 3.1 18 3.9 8.2 7.5 12.4 14 16.6 8.5 5.5 16.5 7.7 27.9 7.8 17.7.2 32-6.4 41.8-19.3l4.7-6.2V381h24v-50.8c0-32.5-.4-53-1.1-56.8-4.1-22.5-22.7-36.1-50.4-36.9-6-.2-12.3-.1-14 .1zm41.3 88.7c-.3 9.2-.7 11-3.6 17-6.8 13.8-21.5 21.6-38.7 20.5-14.2-.9-23.8-8.4-25.1-19.4-.8-6.3.8-11.4 4.9-16 6.3-7.3 13-9 41.2-10.8 11-.7 20.4-1.4 20.9-1.5.4 0 .7 4.5.4 10.2zM1642.5 236.6c-23.5 3.8-39.1 16.2-44 34.9-2.3 9-2.9 8.5 10 8.5h11.4l1.3-4.3c.8-2.7 3-6 6.3-9.3 6.6-6.6 12.7-8.8 25-8.9 11.5 0 17.9 2.1 23.9 8 5.5 5.3 7.6 11.6 7.6 23.2 0 7.9-.1 8.3-2.2 8.3-11 .1-48.9 3.2-54.1 4.4-15.4 3.6-26.8 11.4-32.3 22.3-2.7 5.4-2.9 6.6-2.9 17.3 0 10.8.2 11.9 3.1 18 3.9 8.2 7.5 12.4 14 16.6 8.5 5.5 16.5 7.7 27.9 7.8 17.7.2 32-6.4 41.8-19.3l4.7-6.2V381h24v-50.8c0-32.5-.4-53-1.1-56.8-4.1-22.5-22.7-36.1-50.4-36.9-6-.2-12.3-.1-14 .1zm41.3 88.7c-.3 9.2-.7 11-3.6 17-6.8 13.8-21.5 21.6-38.7 20.5-14.2-.9-23.8-8.4-25.1-19.4-.8-6.3.8-11.4 4.9-16 6.3-7.3 13-9 41.2-10.8 11-.7 20.4-1.4 20.9-1.5.4 0 .7 4.5.4 10.2zM1542 310v71h24V239h-24v71z" />
	<path d="M65.5 263.9c-3.8 1.7-15 10.9-14.2 11.7.2.2 2.1-.5 4.2-1.6 12.6-6.4 23.5 2.7 27 22.6 1.8 10.2 1.8 15.8 0 29.7-3.6 27.5-14.5 52.8-28.9 67.3-11.8 11.8-21.3 13.2-29 4.2l-3.5-4.1.9 3.2c8.7 30.5 35.2 22.1 54.8-17.5 15-30.1 21.6-68.7 16.1-94.4-4-18.9-14.4-26.9-27.4-21.1zM816.2 263.7c-4.4 2.1-8.8 8.5-11.4 16.3-1.7 5.2-2.2 9.7-2.6 22.6-.3 14.2-.1 17.8 2.2 30 5.1 27.8 15.3 51.9 28.9 68.5 15.5 18.7 31.4 19.1 39.4 1.1 3.1-7.1 2.9-8-1-3.9-17.2 18.3-45.7-13.8-56.3-63.3-2.8-13-2.6-36.2.3-45.5 3.5-11 10.2-17.5 18.1-17.5 1.6 0 4.9 1.1 7.5 2.3 4.1 2.1 4.4 2.2 3.3.5-2.3-3.3-9.3-8.8-13.8-10.8-5.2-2.4-10.2-2.5-14.6-.3zM430 290.1c-80.7 10-144.1 73-153.6 152.9-1.8 15.1-1.7 26.3.1 40.7 10.3 79.2 72.3 141.5 151.2 151.8 85.1 11.2 168.7-45.9 189.9-129.5 20.2-80-17.5-161.3-92.1-198.5-16.1-8-31.2-13.1-47.5-16-11.3-1.9-37.5-2.8-48-1.4zm29.6 76c13.9 2.5 29 13.2 37.4 26.4 14.4 22.9 13.1 55.4-3.2 77-6.5 8.5-17.1 16.4-26.5 19.7-9.7 3.3-25.9 3.3-35.5 0-23.3-8-39-30.1-40.5-57.3-1.7-29.7 16-56.6 42.7-64.7 7.6-2.3 16.7-2.7 25.6-1.1zm9.4 156.4c17.5 2.3 34.3 7.1 46.5 13.2 13.5 6.8 29 19 34 26.7l1.9 2.9-5.9 5.4c-19.1 17-42.5 28.8-68.8 34.5-14.7 3.2-43.7 3.2-58.3 0-27-5.8-51-17.8-68.5-33.9-3.2-3-5.9-6.3-5.9-7.3 0-2.2 12.8-14.4 21-20 26.7-18.1 67.1-26.5 104-21.5zM1115.6 520.8c-.6 1-71.7 192-72.4 194.5-.4 1.6.5 1.7 12.4 1.5l12.8-.3 8.3-23.5c4.6-12.9 9-25.4 9.9-27.8l1.6-4.2h79.6l4.2 11.7c2.3 6.5 6.7 19.1 9.8 28l5.7 16.3h12.8c7 0 12.7-.3 12.7-.8 0-.4-16.4-44.6-36.3-98.2l-36.2-97.5-12.2-.3c-6.7-.1-12.4.1-12.7.6zm28.4 72.8c8.5 24 15.6 44.3 15.8 45 .3 1.2-5.2 1.4-31.8 1.4-26.2 0-32.1-.2-31.8-1.3 1-4.1 31.3-88.7 31.8-88.7.3 0 7.5 19.6 16 43.6zM1475 559c0 21.4-.3 39-.7 39-.5 0-1.9-1.9-3.3-4.1-3.4-5.6-11.2-12.5-18.2-16-27.8-14-61.4-2.2-75.3 26.4-5.3 11.1-7.4 18.8-8.4 31.6-2.5 29.2 5.1 53.7 21.6 69.2 23.3 22.1 62.4 18.8 79.9-6.7l3.9-5.7.3 12.2.3 12.1h22.9V520h-23v39zm-25.4 38c16 7.9 24.8 25.2 24.8 49 0 18.8-4.4 31.2-14.8 41.6-8.1 8-14.7 10.7-26.7 10.7-7.5 0-9.4-.4-15.2-3.1-17.3-8-25.6-26.4-24.4-53.6.6-14.6 2.9-22.8 9-31.8 10.4-15.6 30.6-21 47.3-12.8zM1537.1 522.7c-10.7 5.6-10.6 21 .2 26.2 2.4 1.2 5.3 2.1 6.5 2.1 6.4 0 13.6-6.2 14.8-12.6.9-4.8-1.9-11.8-5.8-14.5-4.2-3-11.3-3.5-15.7-1.2zM1632.5 573.5c-3.8.8-10.7 3.3-15.4 5.5-25 12-38.1 40.8-35 76.9 2.8 32 20.3 54.5 47.9 61.8 8.6 2.3 26.2 2.3 34.9 0 11.7-3.1 18.9-7.3 27.6-16.1 9.2-9.2 13.1-15.9 17.1-29.1 2.5-8.3 2.8-10.4 2.8-26 .1-19.9-1.1-25.8-8-40.2-7.6-15.9-21.2-27.2-38.4-31.9-8.1-2.2-25.1-2.6-33.5-.9zm24.6 20.9c14.4 3.3 24.8 14.5 29.5 31.7 2.4 8.9 2.5 30 .1 38.9-4.1 15.2-13 26.7-24.2 31-8.4 3.3-21.5 3.3-30 0-7.5-2.9-17-12-20.7-20-5.5-11.7-7.4-32.3-4.3-47.1 5.5-26.3 25.6-40.2 49.6-34.5zM1227 625.8c0 47.1.1 51.4 1.9 58.5 2.6 10 5.3 15 11.7 21.8 20.1 21 61.5 17.3 77.8-7.1 1.5-2.4 1.6-2.1 1.6 7.8V717h24V575h-23.9l-.3 47.7c-.3 47.3-.3 47.9-2.6 53.5-6.5 16-23.2 24.8-41.1 21.8-8.3-1.4-14.7-5.1-19.1-11.1-5.9-8.2-6-9.4-6-63.1V575h-24v50.8zM1532 646v71h24V575h-24v71zM725 667.1c-46.8 7.1-115.5 65.6-143.5 122.4-8.4 17-11.6 28-11.7 40.5-.1 14.9 3.8 22.7 14 27.7 5.2 2.6 6.6 2.8 16.7 2.7 9.5-.1 12.3-.5 20.8-3.3 5.3-1.8 9.7-3.3 9.7-3.5 0-.1-4.1 0-9 .2-15.2.7-24-3.3-28.5-13.1-5.8-12.4-3.5-28.7 7.2-50.5 21.1-43.3 70.8-88 110.8-99.7 13.1-3.8 24.5-3.8 32.3.1 10.4 5.3 14.2 14.3 12.9 30.8-.7 8.5.2 7.4 3.9-5 3.6-12 4-27.6.8-34.4-5.8-12.3-18.6-17.6-36.4-14.9zM153 667.9c-18.5 6.1-23.5 24.3-14.4 52.3 1.4 4.3 2.7 7.8 2.9 7.8.1 0 0-4-.3-9-.8-15 3-23.4 12.9-28.4 4.6-2.2 6.6-2.6 14.5-2.6 22.6 0 51.7 14.7 79.9 40.3 28.2 25.7 48.7 54.9 55.9 79.9 3.6 12.5 4.1 19.1 2.2 26.9-2.1 8-5.6 12.6-12.7 16.2-5.2 2.7-5.9 2.8-16.7 2.5l-11.3-.4 6.1 2.3c15.2 5.7 31.8 6.7 41.3 2.5 5.9-2.6 10.9-8 13.1-14.2 2.9-7.9 1.9-23.6-2.2-36.1-8.2-24.8-26.6-52.8-52.1-79.2-26.3-27.2-59.4-49.6-86.1-58.2-6.6-2.2-10.9-2.8-19.5-3.1-6-.2-12.1 0-13.5.5z" />
	<path d="M732.8 732.2c-10.8 1.4-26.2 8.9-41.4 20.1-9.6 7.1-29.8 27.6-36.6 37.3-20.2 28.4-24.5 52.8-10.8 60.8 4.3 2.5 16.3 2.7 22.5.3l4-1.6h-3.9c-6.3-.1-12.1-3.5-14.5-8.5-12.5-25.6 35.7-85 77.2-95.2 5.7-1.4 7.6-1.5 12.2-.5 6.8 1.5 11.2 5.6 12.1 11.2.4 2.1 1 3.9 1.5 3.9 1.2 0 2.2-8.7 1.5-13.7-1.5-11.3-9.5-16-23.8-14.1zM148.9 734.1c-2 1.2-4.4 3.5-5.4 5.1-2.1 3.6-3 12.9-1.7 18.3l.9 4 .7-3c3.4-14.8 15.6-18 36-9.5 27 11.2 57.3 43.1 66 69.2 6.1 18.3.4 30.6-14.5 30.9l-4.4.1 4.5 1.5c7.1 2.3 18.8 2.2 23-.2 14.1-8.2 8.7-34.5-12.9-63.5-7.6-10.2-24.7-27.2-35.4-35.2-22.5-16.7-45.9-24-56.8-17.7z" />
</svg>
`,Ei=(unsafeWindow==null?void 0:unsafeWindow.wrappedJSObject)??unsafeWindow,qA=typeof cloneInto=="function"?cloneInto:e=>e,XA=typeof exportFunction=="function"?exportFunction:e=>e;function QA(e){return qA(e,Ei,{cloneFunctions:!0,wrapReflectors:!0})}function JA(e){return XA(e,Ei)}function ex(e,t){return t??(t=Ei),function(...r){return e.call(t,...QA(r))}}const qf={},tx=ex(Ei.history.pushState,Ei.history);Ei.history.pushState=JA(rx);function rx(e,t,r){tx(e,t,r),mg()}addEventListener("popstate",()=>{mg()});function mg(){for(const e of Object.values(qf)){const t=e.pattern.test(location.pathname)?e.onCallbacks:e.offCallbacks;for(const r of t)r()}}function yg(e){const t=new RegExp(`^/${e.replaceAll("/","\\/")}$`);let r=qf[e];return r||(r={pattern:t,onCallbacks:[],offCallbacks:[]},qf[e]=r,r)}function nx(e,t){const r=yg(e),n=r.pattern.test(location.pathname);r.onCallbacks.push(t),n&&t()}function ix(e,t){const r=yg(e),n=r.pattern.test(location.pathname);r.offCallbacks.push(t),n||t()}const pg="[a-z]{2}/album/.+/.+";function Ln(e){nx(pg,e)}function fa(e){ix(pg,e)}const gg=new Map;function Fn(e,t){return new Promise((r,n)=>{const i=gg.get(e);if(i){r(i.clone());return}GM.xmlHttpRequest({url:e,method:(t==null?void 0:t.method)??"GET",headers:Object.fromEntries(new Headers(t==null?void 0:t.headers)),responseType:"blob",onload(o){if((o.status<200||o.status>299)&&o.status!==404){n(new Error(`Fetching "${e}" responded with an erroneous status code.`));return}const a=o.responseHeaders.split(`\r
`).slice(0,-1).map(l=>l.split(": ")),s=new Response(o.response,{headers:Object.fromEntries(a),status:o.status,statusText:o.statusText});Object.defineProperty(s,"url",{value:e}),gg.set(e,s.clone()),r(s)},onerror(){n(new Error("Network request errored."))},ontimeout(){n(new Error("Network request timed out."))}})})}function ox(){return Object.fromEntries(document.cookie.split("; ").map(e=>e.split("=",2)))}function ha(e){return new Promise(t=>{setTimeout(t,e)})}function ax(e,t){const r=URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.download=t,n.href=r,document.body.appendChild(n),n.click(),URL.revokeObjectURL(r)}function sx(e){return new Promise(t=>{const r=setInterval(()=>{const n=e();n!=null&&(clearInterval(r),t(n))},100)})}let Kl="";async function Zl(){if(Kl)return Kl;const e=document.querySelector("script[type='module']");if(!e)throw new Error("Failed to find script with auth token.");const n=(await(await Fn(e.src)).text()).match(new RegExp('(?<=")eyJhbGciOiJ.+?(?=")'));if(!n)throw new Error("Failed to find auth token from script.");return Kl=n[0],Kl}function bg(){return location.pathname.split("/")[1]}function wg(){return ox().itua||null}async function Sg(){return(await(await Fn("https://api.music.apple.com/v1/storefronts",{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Zl()}`}})).json()).data}function Xf(){return location.pathname.split("/")[4]}async function da(e,t){t??(t=bg());const r=await Fn(`https://amp-api.music.apple.com/v1/catalog/${t}/albums/${e}?extend=extendedAssetUrls`,{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Zl()}`}});return r.status===404?null:(await r.json()).data[0]}Ln(async()=>{const e=await da(Xf());if(!e)return;const t=await Yl(".headings__metadata-bottom");if(!t)return;const r=e.attributes.audioTraits;e.attributes.isMasteredForItunes&&r.push("adm");const n=Qt('<p class="ame-album-badges-container"></p>');r.includes("lossy-stereo")&&n.insertAdjacentHTML("beforeend",zA),r.includes("lossless")&&n.insertAdjacentHTML("beforeend",KA),r.includes("hi-res-lossless")&&n.insertAdjacentHTML("beforeend",YA),r.includes("atmos")&&n.insertAdjacentHTML("beforeend",GA),r.includes("adm")&&n.insertAdjacentHTML("beforeend",UA),r.includes("spatial")&&n.insertAdjacentHTML("beforeend",ZA),t.after(n)});const lx=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
	<path d="M11.5 42q-.65 0-1.075-.425Q10 41.15 10 40.5v-31q0-.65.425-1.075Q10.85 8 11.5 8h14.45q.55 0 .95.325.4.325.5.875l.7 3.1h10.4q.65 0 1.075.425Q40 13.15 40 13.8v15.5q0 .65-.425 1.075-.425.425-1.075.425H28.4q-.5 0-.925-.3-.425-.3-.525-.85l-.7-3.1H13V40.5q0 .65-.425 1.075Q12.15 42 11.5 42ZM25 19.4Zm4.75 8.4H37V15.3H25.55L24.6 11H13v12.55h15.8Z" />
</svg>
`;function ux(e,t){let r=document.querySelector(e);if(r)return _g(r);try{t()}catch{console.error(`Could not create menu reference element for selector "${e}".`)}if(r=document.querySelector(e),r)return _g(r);throw new Error(`Could not find menu reference element by selector "${e}".`)}function _g(e){return e.addMenuItem=(t,r)=>{let n=e;for(let i=0;i<100;i++){const o=n.nextElementSibling;if(!o||Number(o.getAttribute("data-index"))>r)break;n=o}return t.setAttribute("data-index",r.toString()),n.after(t),t},e}function ki(e,t){return Qt(`
		<li class="ame-sidebar-button navigation-item" data-ame>
			<a class="navigation-item__link" tabindex="0" data-ame>
				${t}
				<span>${e}</span>
			</a>
		</li>
    `)}async function Ai(e,t){await Yl("amp-chrome-player"),ux("#ame-sidebar",()=>{const n=document.querySelector(".navigation__scrollable-container");n==null||n.appendChild(Qt(`
			<div class="navigation-items" data-ame>
				<div class="navigation-items__header" data-ame>
					<span>Ame</span>
				</div>
				<ul class="navigation-items__list" data-ame>
					<li id="ame-sidebar" style="display: none;"></li>
				</ul>
			</div>
		`))}).addMenuItem(e,t)}async function va(e){e.remove()}const Qf=["jp","kr","us","nz","au","de","fr","gb","in","it","es","br","cn","hk"];Qf.reverse();let Rr=null;const Jf=ki("Check Storefronts",lx);Jf.addEventListener("click",async()=>{const e=document.querySelector(".section");e&&await Cg(e)}),Ln(async()=>{const e=await Yl(".page-error");e&&await Cg(e)}),Ln(()=>{Ai(Jf,100),Rr==null||Rr.abort(),Rr=null}),fa(()=>{va(Jf),Rr==null||Rr.abort(),Rr=null});async function Cg(e){if(Rr)return;const t=new AbortController;Rr=t;const r=Xf(),n=Qt('<div class="section ame-album-storefronts-header">Availability in the following storefronts:</div>'),i=Qt(`
		<div class="section ame-album-storefronts-container">
			<div class="ame-color-primary"></div>
			<div class="ame-color-secondary"></div>
			<div class="ame-color-tertiary"></div>
		</div>
	`),o=i.children[0],a=i.children[1],s=i.children[2];e.append(n),e.append(i);let l=await Sg();l=l.map(u=>(u.attributes.name=u.attributes.name.split(", ").slice(0,1).join(" "),u)).sort((u,c)=>Math.max(Qf.indexOf(c.id),0)-Math.max(Qf.indexOf(u.id),0));for(const u of l){if(t.signal.aborted)break;const c=await da(r,u.id);if(!c){s.append(Qt(`<span data-storefront="${u.id}" title="Totally unavailable">${u.attributes.name}, </span>`)),await ha(250);continue}const h=Math.max(...c.relationships.tracks.data.map(y=>y.attributes.discNumber)),d=c.relationships.tracks.data.filter(y=>y.type==="songs"),f=c.relationships.tracks.data.filter(y=>y.type!=="songs"),v=new Set;for(let y=1;y<=c.attributes.trackCount-f.length;y++)v.add(y);if(d.forEach((y,m)=>{y.attributes.extendedAssetUrls&&y.attributes.playParams&&v.delete(h>1?m+1:y.attributes.trackNumber)}),v.size){const y=h>1?`${v.size} tracks`:Array.from(v).join(", ");a.append(Qt(`<span data-storefront="${u.id}"><a target="_blank" href="https://music.apple.com/${u.id}/album/${r}" title="Partially available, missing:
${y}">${u.attributes.name}</a>, </span>`)),await ha(250);continue}o.append(Qt(`<span data-storefront="${u.id}"><a target="_blank" href="https://music.apple.com/${u.id}/album/${r}" title="Fully available">${u.attributes.name}</a>, </span>`)),await ha(250)}}const eh=ki("Search Covers",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
	<path d="M24 44q-4.1 0-7.75-1.575-3.65-1.575-6.375-4.3-2.725-2.725-4.3-6.375Q4 28.1 4 24q0-4.25 1.6-7.9 1.6-3.65 4.375-6.35 2.775-2.7 6.5-4.225Q20.2 4 24.45 4q3.95 0 7.5 1.325T38.175 9q2.675 2.35 4.25 5.575Q44 17.8 44 21.65q0 5.4-3.15 8.525T32.5 33.3h-3.75q-.9 0-1.55.7t-.65 1.55q0 1.35.725 2.3.725.95.725 2.2 0 1.9-1.05 2.925T24 44Zm0-20Zm-11.65 1.3q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm6.3-8.5q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm10.7 0q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75Zm6.55 8.5q1 0 1.75-.75t.75-1.75q0-1-.75-1.75t-1.75-.75q-1 0-1.75.75t-.75 1.75q0 1 .75 1.75t1.75.75ZM24 41q.55 0 .775-.225.225-.225.225-.725 0-.7-.725-1.3-.725-.6-.725-2.65 0-2.3 1.5-4.05t3.8-1.75h3.65q3.8 0 6.15-2.225Q41 25.85 41 21.65q0-6.6-5-10.625T24.45 7q-7.3 0-12.375 4.925T7 24q0 7.05 4.975 12.025Q16.95 41 24 41Z" />
</svg>
`);eh.addEventListener("click",()=>{const e=document.querySelector(".headings__subtitles > a"),t=document.querySelector(".headings__title");if(!t)return;const r=e==null?void 0:e.innerText.trim(),n=t.innerText.trim().replace(/ - Single$/i,"").replace(/ - EP$/i,""),i=new URLSearchParams;r&&i.set("artist",r),i.set("album",n),open(`https://covers.musichoarders.xyz?${i}`,"_blank")}),Ln(()=>{Ai(eh,400)}),fa(()=>{va(eh)}),addEventListener("mousedown",async e=>{if(e.button!==2)return;const t=e.target;if(!t.matches(".artwork-component__image:not(.ame-full-sized)"))return;t.classList.add("ame-full-sized");const r=document.querySelector(".artwork__radiosity source");if(!r)return;const n=t.parentElement.querySelectorAll("source");for(const i of Array.from(n))i.srcset=cx(r.srcset)},{passive:!0});function cx(e){return e.split(" ",2)[0].replace(/is\d-ssl/,"a1").replace("image/thumb","r40").split("/").slice(0,-1).join("/")}const Og=ki("Copy Authorization",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
	<path d="M24 43.95q-7-1.75-11.5-8.125T8 21.85V9.95l16-6 16 6v11.9q0 7.6-4.5 13.975T24 43.95Zm0-3.1q5.75-1.9 9.375-7.175T37 21.85v-9.8l-13-4.9-13 4.9v9.8q0 6.55 3.625 11.825Q18.25 38.95 24 40.85ZM24 24Z" />
</svg>
`);Og.addEventListener("click",async()=>{GM.setClipboard(await Zl())}),Ai(Og,0);const fx=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" slot="app-icon">
	<path d="M29.75 33.4h2.5v-3.25h2.05q.7 0 1.2-.475T36 28.5v-8.95q0-.7-.5-1.2t-1.2-.5H28q-.7 0-1.35.5-.65.5-.65 1.2v8.95q0 .7.65 1.175.65.475 1.35.475h1.75ZM12 30.15h2.5V25.7h5v4.45H22v-12.3h-2.5v5.35h-5v-5.35H12Zm16.5-2.5v-7.3h5v7.3ZM7 40q-1.2 0-2.1-.9Q4 38.2 4 37V11q0-1.2.9-2.1Q5.8 8 7 8h34q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h34V11H7v26Zm0 0V11v26Z" />
</svg>
`,Tg=["ec+3","alac","aac ","aach"],Rg=["BINAURAL","DOWNMIX"];let Er=null;const th=ki("Check Qualities",fx);th.addEventListener("click",async()=>{if(Er)return;const e=new AbortController;Er=e;const t=await da(Xf());if(!t)return;const r=Array.from(document.querySelectorAll(".songs-list-row__song-wrapper"));for(const n of t.relationships.tracks.data){if(e.signal.aborted)break;if(n.type!=="songs")continue;const i=r.shift();if(!i)continue;if(!n.attributes.extendedAssetUrls){i.append(Qt('<span class="ame-track-quality ame-color-warning">[unavailable]</span>'));continue}const o=n.attributes.extendedAssetUrls.enhancedHls;if(!o){i.append(Qt('<span class="ame-track-quality ame-color-warning">[lossy]</span>'));continue}const a=await Fn(o).then(h=>h.text());await ha(150);let s=null;for(const h of a.split(`
`))if(h.startsWith('#EXT-X-SESSION-DATA:DATA-ID="com.apple.hls.audioAssetMetadata"')){s=JSON.parse(atob(h.split("VALUE=")[1].slice(1,-1)));break}if(!s)throw new Error("Could not find data from track manifest.");const l=Object.values(s);l.sort(Eg);const u=await hx(o,l);u&&l.push(u),l.sort(Eg);const c=l.find(h=>parseInt(h["CHANNEL-COUNT"])<=2);i.append(Qt(`<span class="ame-track-quality ame-color-tertiary" title="${l.map(kg).join(`
`)}">${kg(c)}</span>`))}}),Ln(()=>{Ai(th,200),Er==null||Er.abort(),Er=null}),fa(()=>{va(th),Er==null||Er.abort(),Er=null});function Eg(e,t){return Tg.indexOf(e["AUDIO-FORMAT-ID"])-Tg.indexOf(t["AUDIO-FORMAT-ID"])||t["BIT-DEPTH"]-e["BIT-DEPTH"]||t["SAMPLE-RATE"]-e["SAMPLE-RATE"]||(t["BIT-RATE"]??NaN)-(e["BIT-RATE"]??NaN)||Rg.indexOf(e["CHANNEL-USAGE"]??"")-Rg.indexOf(t["CHANNEL-USAGE"]??"")||-Number(e.__ACTUAL__)}function kg(e){const t=[];return t.push(e["AUDIO-FORMAT-ID"]),e["CHANNEL-COUNT"]&&t.push(`${e["CHANNEL-COUNT"]}ch`),e["BIT-RATE"]&&t.push(`${Math.floor(Number(e["BIT-RATE"])/1e3)}kbps`),e["BIT-DEPTH"]&&t.push(`${e["BIT-DEPTH"]}bit`),e["SAMPLE-RATE"]&&t.push(`${Math.floor(Number(e["SAMPLE-RATE"])/1e3)}kHz`),e["CHANNEL-USAGE"]&&t.push(e["CHANNEL-USAGE"].toLowerCase()),e["IS-ATMOS"]&&t.push("atmos"),e.__ACTUAL__&&t.push("[ACTUAL]"),t.join("  ")}async function hx(e,t){var l;const r=e.split("/").slice(0,-1).join("/"),n=(l=t.filter(u=>u["AUDIO-FORMAT-ID"]==="alac"&&parseInt(u["CHANNEL-COUNT"])<=2).at(-1))==null?void 0:l["FIRST-SEGMENT-URI"];if(!n)return null;const i=await Fn(`${r}/${n}`,{headers:{Range:"bytes=0-16384"}}),o=new DataView(await i.arrayBuffer());if(o.getInt32(4)!==1718909296||o.getInt32(8)!==1769172789)return null;let a=0,s=0;for(;a<o.byteLength;){const u=o.getInt32(a);switch(o.getInt32(a+4)){case 1836019574:case 1953653099:case 1835297121:case 1835626086:case 1937007212:a+=8;break;case 1937011556:a+=16;break;case 1701733217:a+=36;case 1634492771:return{"FIRST-SEGMENT-URI":n,"AUDIO-FORMAT-ID":"alac","CHANNEL-COUNT":o.getUint8(a+8+13).toString(),"BIT-DEPTH":o.getUint8(a+8+9),"SAMPLE-RATE":o.getInt32(a+8+24),__ACTUAL__:!0};default:a+=u;break}if(s++>100)break}return null}var jn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ag(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Te=function(e){try{return!!e()}catch{return!0}},dx=Te,ma=!dx(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),xg=ma,Ig=Function.prototype,rh=Ig.call,vx=xg&&Ig.bind.bind(rh,rh),Ee=xg?vx:function(e){return function(){return rh.apply(e,arguments)}},Pg=Ee,mx=Pg({}.toString),yx=Pg("".slice),kr=function(e){return yx(mx(e),8,-1)},px=Ee,gx=Te,bx=kr,nh=Object,wx=px("".split),ya=gx(function(){return!nh("z").propertyIsEnumerable(0)})?function(e){return bx(e)=="String"?wx(e,""):nh(e)}:nh,Ar=function(e){return e==null},Sx=Ar,_x=TypeError,cr=function(e){if(Sx(e))throw _x("Can't call method on "+e);return e},Cx=ya,Ox=cr,Ut=function(e){return Cx(Ox(e))},ql=function(e){return e&&e.Math==Math&&e},Fe=ql(typeof globalThis=="object"&&globalThis)||ql(typeof window=="object"&&window)||ql(typeof self=="object"&&self)||ql(typeof jn=="object"&&jn)||function(){return this}()||jn||Function("return this")(),$g={exports:{}},Tx=!1,Mg=Fe,Rx=Object.defineProperty,ih=function(e,t){try{Rx(Mg,e,{value:t,configurable:!0,writable:!0})}catch{Mg[e]=t}return t},Ex=Fe,kx=ih,Ng="__core-js_shared__",Ax=Ex[Ng]||kx(Ng,{}),oh=Ax,Dg=oh;($g.exports=function(e,t){return Dg[e]||(Dg[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var xi=$g.exports,xx=cr,Ix=Object,Ht=function(e){return Ix(xx(e))},Px=Ee,$x=Ht,Mx=Px({}.hasOwnProperty),Qe=Object.hasOwn||function(t,r){return Mx($x(t),r)},Nx=Ee,Dx=0,Hx=Math.random(),Lx=Nx(1 .toString),Xl=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Lx(++Dx+Hx,36)},Bn=typeof navigator<"u"&&String(navigator.userAgent)||"",Hg=Fe,ah=Bn,Lg=Hg.process,Fg=Hg.Deno,jg=Lg&&Lg.versions||Fg&&Fg.version,Bg=jg&&jg.v8,fr,Ql;Bg&&(fr=Bg.split("."),Ql=fr[0]>0&&fr[0]<4?1:+(fr[0]+fr[1])),!Ql&&ah&&(fr=ah.match(/Edge\/(\d+)/),(!fr||fr[1]>=74)&&(fr=ah.match(/Chrome\/(\d+)/),fr&&(Ql=+fr[1])));var pa=Ql,Wg=pa,Fx=Te,jx=Fe,Bx=jx.String,Ii=!!Object.getOwnPropertySymbols&&!Fx(function(){var e=Symbol();return!Bx(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Wg&&Wg<41}),Wx=Ii,Vg=Wx&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Vx=Fe,zx=xi,zg=Qe,Ux=Xl,Gx=Ii,Yx=Vg,Pi=Vx.Symbol,sh=zx("wks"),Kx=Yx?Pi.for||Pi:Pi&&Pi.withoutSetter||Ux,Ve=function(e){return zg(sh,e)||(sh[e]=Gx&&zg(Pi,e)?Pi[e]:Kx("Symbol."+e)),sh[e]},lh=typeof document=="object"&&document.all,Zx=typeof lh>"u"&&lh!==void 0,Ug={all:lh,IS_HTMLDDA:Zx},Gg=Ug,qx=Gg.all,ze=Gg.IS_HTMLDDA?function(e){return typeof e=="function"||e===qx}:function(e){return typeof e=="function"},Yg=ze,Kg=Ug,Xx=Kg.all,tt=Kg.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Yg(e)||e===Xx}:function(e){return typeof e=="object"?e!==null:Yg(e)},Qx=tt,Jx=String,e3=TypeError,rt=function(e){if(Qx(e))return e;throw e3(Jx(e)+" is not an object")},uh={},t3=Te,nt=!t3(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),r3=nt,n3=Te,Zg=r3&&n3(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),At={},i3=Fe,qg=tt,ch=i3.document,o3=qg(ch)&&qg(ch.createElement),Jl=function(e){return o3?ch.createElement(e):{}},a3=nt,s3=Te,l3=Jl,Xg=!a3&&!s3(function(){return Object.defineProperty(l3("div"),"a",{get:function(){return 7}}).a!=7}),u3=ma,eu=Function.prototype.call,ct=u3?eu.bind(eu):function(){return eu.apply(eu,arguments)},fh=Fe,c3=ze,f3=function(e){return c3(e)?e:void 0},Br=function(e,t){return arguments.length<2?f3(fh[e]):fh[e]&&fh[e][t]},h3=Ee,vn=h3({}.isPrototypeOf),d3=Br,v3=ze,m3=vn,y3=Vg,p3=Object,ga=y3?function(e){return typeof e=="symbol"}:function(e){var t=d3("Symbol");return v3(t)&&m3(t.prototype,p3(e))},g3=String,$i=function(e){try{return g3(e)}catch{return"Object"}},b3=ze,w3=$i,S3=TypeError,Wn=function(e){if(b3(e))return e;throw S3(w3(e)+" is not a function")},_3=Wn,C3=Ar,Mi=function(e,t){var r=e[t];return C3(r)?void 0:_3(r)},hh=ct,dh=ze,vh=tt,O3=TypeError,Qg=function(e,t){var r,n;if(t==="string"&&dh(r=e.toString)&&!vh(n=hh(r,e))||dh(r=e.valueOf)&&!vh(n=hh(r,e))||t!=="string"&&dh(r=e.toString)&&!vh(n=hh(r,e)))return n;throw O3("Can't convert object to primitive value")},T3=ct,Jg=tt,eb=ga,R3=Mi,E3=Qg,k3=Ve,A3=TypeError,x3=k3("toPrimitive"),tb=function(e,t){if(!Jg(e)||eb(e))return e;var r=R3(e,x3),n;if(r){if(t===void 0&&(t="default"),n=T3(r,e,t),!Jg(n)||eb(n))return n;throw A3("Can't convert object to primitive value")}return t===void 0&&(t="number"),E3(e,t)},I3=tb,P3=ga,tu=function(e){var t=I3(e,"string");return P3(t)?t:t+""},$3=nt,M3=Xg,N3=Zg,ru=rt,rb=tu,D3=TypeError,mh=Object.defineProperty,H3=Object.getOwnPropertyDescriptor,yh="enumerable",ph="configurable",gh="writable";At.f=$3?N3?function(t,r,n){if(ru(t),r=rb(r),ru(n),typeof t=="function"&&r==="prototype"&&"value"in n&&gh in n&&!n[gh]){var i=H3(t,r);i&&i[gh]&&(t[r]=n.value,n={configurable:ph in n?n[ph]:i[ph],enumerable:yh in n?n[yh]:i[yh],writable:!1})}return mh(t,r,n)}:mh:function(t,r,n){if(ru(t),r=rb(r),ru(n),M3)try{return mh(t,r,n)}catch{}if("get"in n||"set"in n)throw D3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var L3=Math.ceil,F3=Math.floor,j3=Math.trunc||function(t){var r=+t;return(r>0?F3:L3)(r)},B3=j3,Vn=function(e){var t=+e;return t!==t||t===0?0:B3(t)},W3=Vn,V3=Math.max,z3=Math.min,ba=function(e,t){var r=W3(e);return r<0?V3(r+t,0):z3(r,t)},U3=Vn,G3=Math.min,Ni=function(e){return e>0?G3(U3(e),9007199254740991):0},Y3=Ni,Jt=function(e){return Y3(e.length)},K3=Ut,Z3=ba,q3=Jt,nb=function(e){return function(t,r,n){var i=K3(t),o=q3(i),a=Z3(n,o),s;if(e&&r!=r){for(;o>a;)if(s=i[a++],s!=s)return!0}else for(;o>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},bh={includes:nb(!0),indexOf:nb(!1)},wa={},X3=Ee,wh=Qe,Q3=Ut,J3=bh.indexOf,eI=wa,ib=X3([].push),ob=function(e,t){var r=Q3(e),n=0,i=[],o;for(o in r)!wh(eI,o)&&wh(r,o)&&ib(i,o);for(;t.length>n;)wh(r,o=t[n++])&&(~J3(i,o)||ib(i,o));return i},Sh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],tI=ob,rI=Sh,Sa=Object.keys||function(t){return tI(t,rI)},nI=nt,iI=Zg,oI=At,aI=rt,sI=Ut,lI=Sa;uh.f=nI&&!iI?Object.defineProperties:function(t,r){aI(t);for(var n=sI(r),i=lI(r),o=i.length,a=0,s;o>a;)oI.f(t,s=i[a++],n[s]);return t};var uI=Br,ab=uI("document","documentElement"),cI=xi,fI=Xl,sb=cI("keys"),nu=function(e){return sb[e]||(sb[e]=fI(e))},hI=rt,dI=uh,lb=Sh,vI=wa,mI=ab,yI=Jl,pI=nu,ub=">",cb="<",_h="prototype",Ch="script",fb=pI("IE_PROTO"),Oh=function(){},hb=function(e){return cb+Ch+ub+e+cb+"/"+Ch+ub},db=function(e){e.write(hb("")),e.close();var t=e.parentWindow.Object;return e=null,t},gI=function(){var e=yI("iframe"),t="java"+Ch+":",r;return e.style.display="none",mI.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(hb("document.F=Object")),r.close(),r.F},iu,ou=function(){try{iu=new ActiveXObject("htmlfile")}catch{}ou=typeof document<"u"?document.domain&&iu?db(iu):gI():db(iu);for(var e=lb.length;e--;)delete ou[_h][lb[e]];return ou()};vI[fb]=!0;var Di=Object.create||function(t,r){var n;return t!==null?(Oh[_h]=hI(t),n=new Oh,Oh[_h]=null,n[fb]=t):n=ou(),r===void 0?n:dI.f(n,r)},bI=Ve,wI=Di,SI=At.f,Th=bI("unscopables"),Rh=Array.prototype;Rh[Th]==null&&SI(Rh,Th,{configurable:!0,value:wI(null)});var _a=function(e){Rh[Th][e]=!0},Ca={},_I=Fe,CI=ze,vb=_I.WeakMap,mb=CI(vb)&&/native code/.test(String(vb)),Oa=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},OI=nt,TI=At,RI=Oa,zn=OI?function(e,t,r){return TI.f(e,t,RI(1,r))}:function(e,t,r){return e[t]=r,e},EI=mb,yb=Fe,kI=tt,AI=zn,Eh=Qe,kh=oh,xI=nu,II=wa,pb="Object already initialized",Ah=yb.TypeError,PI=yb.WeakMap,au,Ta,su,$I=function(e){return su(e)?Ta(e):au(e,{})},MI=function(e){return function(t){var r;if(!kI(t)||(r=Ta(t)).type!==e)throw Ah("Incompatible receiver, "+e+" required");return r}};if(EI||kh.state){var xr=kh.state||(kh.state=new PI);xr.get=xr.get,xr.has=xr.has,xr.set=xr.set,au=function(e,t){if(xr.has(e))throw Ah(pb);return t.facade=e,xr.set(e,t),t},Ta=function(e){return xr.get(e)||{}},su=function(e){return xr.has(e)}}else{var Hi=xI("state");II[Hi]=!0,au=function(e,t){if(Eh(e,Hi))throw Ah(pb);return t.facade=e,AI(e,Hi,t),t},Ta=function(e){return Eh(e,Hi)?e[Hi]:{}},su=function(e){return Eh(e,Hi)}}var Wr={set:au,get:Ta,has:su,enforce:$I,getterFor:MI},Vr={},Ra={},gb={}.propertyIsEnumerable,bb=Object.getOwnPropertyDescriptor,NI=bb&&!gb.call({1:2},1);Ra.f=NI?function(t){var r=bb(this,t);return!!r&&r.enumerable}:gb;var DI=nt,HI=ct,LI=Ra,FI=Oa,jI=Ut,BI=tu,WI=Qe,VI=Xg,wb=Object.getOwnPropertyDescriptor;Vr.f=DI?wb:function(t,r){if(t=jI(t),r=BI(r),VI)try{return wb(t,r)}catch{}if(WI(t,r))return FI(!HI(LI.f,t,r),t[r])};var Sb={exports:{}},xh=nt,zI=Qe,_b=Function.prototype,UI=xh&&Object.getOwnPropertyDescriptor,Ih=zI(_b,"name"),GI=Ih&&(function(){}).name==="something",YI=Ih&&(!xh||xh&&UI(_b,"name").configurable),Ea={EXISTS:Ih,PROPER:GI,CONFIGURABLE:YI},KI=Ee,ZI=ze,Ph=oh,qI=KI(Function.toString);ZI(Ph.inspectSource)||(Ph.inspectSource=function(e){return qI(e)});var Cb=Ph.inspectSource,$h=Ee,XI=Te,QI=ze,lu=Qe,Mh=nt,JI=Ea.CONFIGURABLE,eP=Cb,Ob=Wr,tP=Ob.enforce,rP=Ob.get,Tb=String,uu=Object.defineProperty,nP=$h("".slice),iP=$h("".replace),oP=$h([].join),aP=Mh&&!XI(function(){return uu(function(){},"length",{value:8}).length!==8}),sP=String(String).split("String"),lP=Sb.exports=function(e,t,r){nP(Tb(t),0,7)==="Symbol("&&(t="["+iP(Tb(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!lu(e,"name")||JI&&e.name!==t)&&(Mh?uu(e,"name",{value:t,configurable:!0}):e.name=t),aP&&r&&lu(r,"arity")&&e.length!==r.arity&&uu(e,"length",{value:r.arity});try{r&&lu(r,"constructor")&&r.constructor?Mh&&uu(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=tP(e);return lu(n,"source")||(n.source=oP(sP,typeof t=="string"?t:"")),e};Function.prototype.toString=lP(function(){return QI(this)&&rP(this).source||eP(this)},"toString");var Rb=Sb.exports,uP=ze,cP=At,fP=Rb,hP=ih,er=function(e,t,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:t;if(uP(r)&&fP(r,o,n),n.global)i?e[t]=r:hP(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:cP.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Un={},dP=ob,vP=Sh,mP=vP.concat("length","prototype");Un.f=Object.getOwnPropertyNames||function(t){return dP(t,mP)};var ka={};ka.f=Object.getOwnPropertySymbols;var yP=Br,pP=Ee,gP=Un,bP=ka,wP=rt,SP=pP([].concat),Eb=yP("Reflect","ownKeys")||function(t){var r=gP.f(wP(t)),n=bP.f;return n?SP(r,n(t)):r},kb=Qe,_P=Eb,CP=Vr,OP=At,Ab=function(e,t,r){for(var n=_P(t),i=OP.f,o=CP.f,a=0;a<n.length;a++){var s=n[a];!kb(e,s)&&!(r&&kb(r,s))&&i(e,s,o(t,s))}},TP=Te,RP=ze,EP=/#|\.prototype\./,Aa=function(e,t){var r=AP[kP(e)];return r==IP?!0:r==xP?!1:RP(t)?TP(t):!!t},kP=Aa.normalize=function(e){return String(e).replace(EP,".").toLowerCase()},AP=Aa.data={},xP=Aa.NATIVE="N",IP=Aa.POLYFILL="P",cu=Aa,Nh=Fe,PP=Vr.f,$P=zn,MP=er,NP=ih,DP=Ab,HP=cu,we=function(e,t){var r=e.target,n=e.global,i=e.stat,o,a,s,l,u,c;if(n?a=Nh:i?a=Nh[r]||NP(r,{}):a=(Nh[r]||{}).prototype,a)for(s in t){if(u=t[s],e.dontCallGetSet?(c=PP(a,s),l=c&&c.value):l=a[s],o=HP(n?s:r+(i?".":"#")+s,e.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;DP(u,l)}(e.sham||l&&l.sham)&&$P(u,"sham",!0),MP(a,s,u,e)}},LP=Te,xb=!LP(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),FP=Qe,jP=ze,BP=Ht,WP=nu,VP=xb,Ib=WP("IE_PROTO"),Dh=Object,zP=Dh.prototype,xa=VP?Dh.getPrototypeOf:function(e){var t=BP(e);if(FP(t,Ib))return t[Ib];var r=t.constructor;return jP(r)&&t instanceof r?r.prototype:t instanceof Dh?zP:null},UP=Te,GP=ze,YP=tt,Pb=xa,KP=er,ZP=Ve,Hh=ZP("iterator"),$b=!1,Gn,Lh,Fh;[].keys&&(Fh=[].keys(),"next"in Fh?(Lh=Pb(Pb(Fh)),Lh!==Object.prototype&&(Gn=Lh)):$b=!0);var qP=!YP(Gn)||UP(function(){var e={};return Gn[Hh].call(e)!==e});qP&&(Gn={}),GP(Gn[Hh])||KP(Gn,Hh,function(){return this});var Mb={IteratorPrototype:Gn,BUGGY_SAFARI_ITERATORS:$b},XP=At.f,QP=Qe,JP=Ve,Nb=JP("toStringTag"),fu=function(e,t,r){e&&!r&&(e=e.prototype),e&&!QP(e,Nb)&&XP(e,Nb,{configurable:!0,value:t})},e5=Mb.IteratorPrototype,t5=Di,r5=Oa,n5=fu,i5=Ca,o5=function(){return this},a5=function(e,t,r,n){var i=t+" Iterator";return e.prototype=t5(e5,{next:r5(+!n,r)}),n5(e,i,!1),i5[i]=o5,e},s5=Ee,l5=Wn,u5=function(e,t,r){try{return s5(l5(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},c5=ze,f5=String,h5=TypeError,d5=function(e){if(typeof e=="object"||c5(e))return e;throw h5("Can't set "+f5(e)+" as a prototype")},v5=u5,m5=rt,y5=d5,jh=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=v5(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,o){return m5(i),y5(o),e?r(i,o):i.__proto__=o,i}}():void 0),p5=we,g5=ct,Db=Ea,b5=ze,w5=a5,Hb=xa,Lb=jh,S5=fu,_5=zn,Bh=er,C5=Ve,O5=Ca,Fb=Mb,T5=Db.PROPER,R5=Db.CONFIGURABLE,jb=Fb.IteratorPrototype,hu=Fb.BUGGY_SAFARI_ITERATORS,Ia=C5("iterator"),Bb="keys",Pa="values",Wb="entries",E5=function(){return this},Wh=function(e,t,r,n,i,o,a){w5(r,t,n);var s=function(S){if(S===i&&d)return d;if(!hu&&S in c)return c[S];switch(S){case Bb:return function(){return new r(this,S)};case Pa:return function(){return new r(this,S)};case Wb:return function(){return new r(this,S)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,c=e.prototype,h=c[Ia]||c["@@iterator"]||i&&c[i],d=!hu&&h||s(i),f=t=="Array"&&c.entries||h,v,y,m;if(f&&(v=Hb(f.call(new e)),v!==Object.prototype&&v.next&&(Hb(v)!==jb&&(Lb?Lb(v,jb):b5(v[Ia])||Bh(v,Ia,E5)),S5(v,l,!0))),T5&&i==Pa&&h&&h.name!==Pa&&(R5?_5(c,"name",Pa):(u=!0,d=function(){return g5(h,this)})),i)if(y={values:s(Pa),keys:o?d:s(Bb),entries:s(Wb)},a)for(m in y)(hu||u||!(m in c))&&Bh(c,m,y[m]);else p5({target:t,proto:!0,forced:hu||u},y);return c[Ia]!==d&&Bh(c,Ia,d,{name:i}),O5[t]=d,y},Vh=function(e,t){return{value:e,done:t}},k5=Ut,zh=_a,Vb=Ca,zb=Wr,A5=At.f,x5=Wh,du=Vh,I5=nt,Ub="Array Iterator",P5=zb.set,$5=zb.getterFor(Ub),M5=x5(Array,"Array",function(e,t){P5(this,{type:Ub,target:k5(e),index:0,kind:t})},function(){var e=$5(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,du(void 0,!0)):r=="keys"?du(n,!1):r=="values"?du(t[n],!1):du([n,t[n]],!1)},"values"),Gb=Vb.Arguments=Vb.Array;if(zh("keys"),zh("values"),zh("entries"),I5&&Gb.name!=="values")try{A5(Gb,"name",{value:"values"})}catch{}var N5=Ve,D5=N5("toStringTag"),Yb={};Yb[D5]="z";var Uh=String(Yb)==="[object z]",H5=Uh,L5=ze,vu=kr,F5=Ve,j5=F5("toStringTag"),B5=Object,W5=vu(function(){return arguments}())=="Arguments",V5=function(e,t){try{return e[t]}catch{}},mu=H5?vu:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=V5(t=B5(e),j5))=="string"?r:W5?vu(t):(n=vu(t))=="Object"&&L5(t.callee)?"Arguments":n},z5=Uh,U5=mu,G5=z5?{}.toString:function(){return"[object "+U5(this)+"]"},Y5=Uh,K5=er,Z5=G5;Y5||K5(Object.prototype,"toString",Z5,{unsafe:!0});var Kb={exports:{}},Gh={},q5=tu,X5=At,Q5=Oa,Li=function(e,t,r){var n=q5(t);n in e?X5.f(e,n,Q5(0,r)):e[n]=r},Zb=ba,J5=Jt,e$=Li,t$=Array,r$=Math.max,Yh=function(e,t,r){for(var n=J5(e),i=Zb(t,n),o=Zb(r===void 0?n:r,n),a=t$(r$(o-i,0)),s=0;i<o;i++,s++)e$(a,s,e[i]);return a.length=s,a},n$=kr,i$=Ut,qb=Un.f,o$=Yh,Xb=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a$=function(e){try{return qb(e)}catch{return o$(Xb)}};Gh.f=function(t){return Xb&&n$(t)=="Window"?a$(t):qb(i$(t))};var s$=Te,l$=s$(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),u$=Te,c$=tt,f$=kr,Qb=l$,yu=Object.isExtensible,h$=u$(function(){yu(1)}),d$=h$||Qb?function(t){return!c$(t)||Qb&&f$(t)=="ArrayBuffer"?!1:yu?yu(t):!0}:yu,v$=Te,Kh=!v$(function(){return Object.isExtensible(Object.preventExtensions({}))}),m$=we,y$=Ee,p$=wa,g$=tt,Zh=Qe,b$=At.f,Jb=Un,w$=Gh,qh=d$,S$=Xl,_$=Kh,e1=!1,zr=S$("meta"),C$=0,Xh=function(e){b$(e,zr,{value:{objectID:"O"+C$++,weakData:{}}})},O$=function(e,t){if(!g$(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!Zh(e,zr)){if(!qh(e))return"F";if(!t)return"E";Xh(e)}return e[zr].objectID},T$=function(e,t){if(!Zh(e,zr)){if(!qh(e))return!0;if(!t)return!1;Xh(e)}return e[zr].weakData},R$=function(e){return _$&&e1&&qh(e)&&!Zh(e,zr)&&Xh(e),e},E$=function(){k$.enable=function(){},e1=!0;var e=Jb.f,t=y$([].splice),r={};r[zr]=1,e(r).length&&(Jb.f=function(n){for(var i=e(n),o=0,a=i.length;o<a;o++)if(i[o]===zr){t(i,o,1);break}return i},m$({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:w$.f}))},k$=Kb.exports={enable:E$,fastKey:O$,getWeakData:T$,onFreeze:R$};p$[zr]=!0;var $a=Kb.exports,A$=kr,x$=Ee,pu=function(e){if(A$(e)==="Function")return x$(e)},t1=pu,I$=Wn,P$=ma,$$=t1(t1.bind),Ma=function(e,t){return I$(e),t===void 0?e:P$?$$(e,t):function(){return e.apply(t,arguments)}},M$=Ve,N$=Ca,D$=M$("iterator"),H$=Array.prototype,r1=function(e){return e!==void 0&&(N$.Array===e||H$[D$]===e)},L$=mu,n1=Mi,F$=Ar,j$=Ca,B$=Ve,W$=B$("iterator"),Qh=function(e){if(!F$(e))return n1(e,W$)||n1(e,"@@iterator")||j$[L$(e)]},V$=ct,z$=Wn,U$=rt,G$=$i,Y$=Qh,K$=TypeError,i1=function(e,t){var r=arguments.length<2?Y$(e):t;if(z$(r))return U$(V$(r,e));throw K$(G$(e)+" is not iterable")},Z$=ct,o1=rt,q$=Mi,a1=function(e,t,r){var n,i;o1(e);try{if(n=q$(e,"return"),!n){if(t==="throw")throw r;return r}n=Z$(n,e)}catch(o){i=!0,n=o}if(t==="throw")throw r;if(i)throw n;return o1(n),r},X$=Ma,Q$=ct,J$=rt,eM=$i,tM=r1,rM=Jt,s1=vn,nM=i1,iM=Qh,l1=a1,oM=TypeError,gu=function(e,t){this.stopped=e,this.result=t},u1=gu.prototype,Jh=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=X$(t,n),u,c,h,d,f,v,y,m=function(_){return u&&l1(u,"normal",_),new gu(!0,_)},S=function(_){return i?(J$(_),s?l(_[0],_[1],m):l(_[0],_[1])):s?l(_,m):l(_)};if(o)u=e.iterator;else if(a)u=e;else{if(c=iM(e),!c)throw oM(eM(e)+" is not iterable");if(tM(c)){for(h=0,d=rM(e);d>h;h++)if(f=S(e[h]),f&&s1(u1,f))return f;return new gu(!1)}u=nM(e,c)}for(v=o?e.next:u.next;!(y=Q$(v,u)).done;){try{f=S(y.value)}catch(_){l1(u,"throw",_)}if(typeof f=="object"&&f&&s1(u1,f))return f}return new gu(!1)},aM=vn,sM=TypeError,ed=function(e,t){if(aM(t,e))return e;throw sM("Incorrect invocation")},lM=Ve,c1=lM("iterator"),f1=!1;try{var uM=0,h1={next:function(){return{done:!!uM++}},return:function(){f1=!0}};h1[c1]=function(){return this},Array.from(h1,function(){throw 2})}catch{}var d1=function(e,t){if(!t&&!f1)return!1;var r=!1;try{var n={};n[c1]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},cM=ze,fM=tt,v1=jh,td=function(e,t,r){var n,i;return v1&&cM(n=t.constructor)&&n!==r&&fM(i=n.prototype)&&i!==r.prototype&&v1(e,i),e},hM=we,dM=Fe,vM=Ee,m1=cu,mM=er,yM=$a,pM=Jh,gM=ed,bM=ze,wM=Ar,rd=tt,nd=Te,SM=d1,_M=fu,CM=td,bu=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,o=n?"set":"add",a=dM[e],s=a&&a.prototype,l=a,u={},c=function(S){var _=vM(s[S]);mM(s,S,S=="add"?function(R){return _(this,R===0?0:R),this}:S=="delete"?function(O){return i&&!rd(O)?!1:_(this,O===0?0:O)}:S=="get"?function(R){return i&&!rd(R)?void 0:_(this,R===0?0:R)}:S=="has"?function(R){return i&&!rd(R)?!1:_(this,R===0?0:R)}:function(R,T){return _(this,R===0?0:R,T),this})},h=m1(e,!bM(a)||!(i||s.forEach&&!nd(function(){new a().entries().next()})));if(h)l=r.getConstructor(t,e,n,o),yM.enable();else if(m1(e,!0)){var d=new l,f=d[o](i?{}:-0,1)!=d,v=nd(function(){d.has(1)}),y=SM(function(S){new a(S)}),m=!i&&nd(function(){for(var S=new a,_=5;_--;)S[o](_,_);return!S.has(-0)});y||(l=t(function(S,_){gM(S,s);var O=CM(new a,S,l);return wM(_)||pM(_,O[o],{that:O,AS_ENTRIES:n}),O}),l.prototype=s,s.constructor=l),(v||m)&&(c("delete"),c("has"),n&&c("get")),(m||f)&&c(o),i&&s.clear&&delete s.clear}return u[e]=l,hM({global:!0,constructor:!0,forced:l!=a},u),_M(l,e),i||r.setStrong(l,e,n),l},y1=Rb,OM=At,Na=function(e,t,r){return r.get&&y1(r.get,t,{getter:!0}),r.set&&y1(r.set,t,{setter:!0}),OM.f(e,t,r)},TM=er,id=function(e,t,r){for(var n in t)TM(e,n,t[n],r);return e},RM=Br,EM=Na,kM=Ve,AM=nt,p1=kM("species"),g1=function(e){var t=RM(e);AM&&t&&!t[p1]&&EM(t,p1,{configurable:!0,get:function(){return this}})},xM=Di,IM=Na,b1=id,PM=Ma,$M=ed,MM=Ar,NM=Jh,DM=Wh,wu=Vh,HM=g1,Da=nt,w1=$a.fastKey,S1=Wr,_1=S1.set,od=S1.getterFor,C1={getConstructor:function(e,t,r,n){var i=e(function(u,c){$M(u,o),_1(u,{type:t,index:xM(null),first:void 0,last:void 0,size:0}),Da||(u.size=0),MM(c)||NM(c,u[n],{that:u,AS_ENTRIES:r})}),o=i.prototype,a=od(t),s=function(u,c,h){var d=a(u),f=l(u,c),v,y;return f?f.value=h:(d.last=f={index:y=w1(c,!0),key:c,value:h,previous:v=d.last,next:void 0,removed:!1},d.first||(d.first=f),v&&(v.next=f),Da?d.size++:u.size++,y!=="F"&&(d.index[y]=f)),u},l=function(u,c){var h=a(u),d=w1(c),f;if(d!=="F")return h.index[d];for(f=h.first;f;f=f.next)if(f.key==c)return f};return b1(o,{clear:function(){for(var c=this,h=a(c),d=h.index,f=h.first;f;)f.removed=!0,f.previous&&(f.previous=f.previous.next=void 0),delete d[f.index],f=f.next;h.first=h.last=void 0,Da?h.size=0:c.size=0},delete:function(u){var c=this,h=a(c),d=l(c,u);if(d){var f=d.next,v=d.previous;delete h.index[d.index],d.removed=!0,v&&(v.next=f),f&&(f.previous=v),h.first==d&&(h.first=f),h.last==d&&(h.last=v),Da?h.size--:c.size--}return!!d},forEach:function(c){for(var h=a(this),d=PM(c,arguments.length>1?arguments[1]:void 0),f;f=f?f.next:h.first;)for(d(f.value,f.key,this);f&&f.removed;)f=f.previous},has:function(c){return!!l(this,c)}}),b1(o,r?{get:function(c){var h=l(this,c);return h&&h.value},set:function(c,h){return s(this,c===0?0:c,h)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),Da&&IM(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=od(t),o=od(n);DM(e,t,function(a,s){_1(this,{type:n,target:a,state:i(a),kind:s,last:void 0})},function(){for(var a=o(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,wu(void 0,!0)):s=="keys"?wu(l.key,!1):s=="values"?wu(l.value,!1):wu([l.key,l.value],!1)},r?"entries":"values",!r,!0),HM(t)}},LM=bu,FM=C1;LM("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},FM);var jM=mu,BM=String,mt=function(e){if(jM(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return BM(e)},ad=Ee,WM=Vn,VM=mt,zM=cr,UM=ad("".charAt),O1=ad("".charCodeAt),YM=ad("".slice),T1=function(e){return function(t,r){var n=VM(zM(t)),i=WM(r),o=n.length,a,s;return i<0||i>=o?e?"":void 0:(a=O1(n,i),a<55296||a>56319||i+1===o||(s=O1(n,i+1))<56320||s>57343?e?UM(n,i):a:e?YM(n,i,i+2):(a-55296<<10)+(s-56320)+65536)}},sd={codeAt:T1(!1),charAt:T1(!0)},KM=sd.charAt,ZM=mt,R1=Wr,qM=Wh,E1=Vh,k1="String Iterator",XM=R1.set,QM=R1.getterFor(k1);qM(String,"String",function(e){XM(this,{type:k1,string:ZM(e),index:0})},function(){var t=QM(this),r=t.string,n=t.index,i;return n>=r.length?E1(void 0,!0):(i=KM(r,n),t.index+=i.length,E1(i,!1))});var A1={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},JM=Jl,ld=JM("span").classList,x1=ld&&ld.constructor&&ld.constructor.prototype,I1=x1===Object.prototype?void 0:x1,P1=Fe,$1=A1,e4=I1,Ha=M5,ud=zn,M1=Ve,cd=M1("iterator"),N1=M1("toStringTag"),fd=Ha.values,D1=function(e,t){if(e){if(e[cd]!==fd)try{ud(e,cd,fd)}catch{e[cd]=fd}if(e[N1]||ud(e,N1,t),$1[t]){for(var r in Ha)if(e[r]!==Ha[r])try{ud(e,r,Ha[r])}catch{e[r]=Ha[r]}}}};for(var hd in $1)D1(P1[hd]&&P1[hd].prototype,hd);D1(e4,"DOMTokenList");var t4=we,r4=bh.includes,n4=Te,i4=_a,o4=n4(function(){return!Array(1).includes()});t4({target:"Array",proto:!0,forced:o4},{includes:function(t){return r4(this,t,arguments.length>1?arguments[1]:void 0)}}),i4("includes");var H1=$i,a4=TypeError,L1=function(e,t){if(!delete e[t])throw a4("Cannot delete property "+H1(t)+" of "+H1(e))},F1=Yh,s4=Math.floor,dd=function(e,t){var r=e.length,n=s4(r/2);return r<8?l4(e,t):u4(e,dd(F1(e,0,n),t),dd(F1(e,n),t),t)},l4=function(e,t){for(var r=e.length,n=1,i,o;n<r;){for(o=n,i=e[n];o&&t(e[o-1],i)>0;)e[o]=e[--o];o!==n++&&(e[o]=i)}return e},u4=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e},c4=dd,f4=Te,Fi=function(e,t){var r=[][e];return!!r&&f4(function(){r.call(null,t||function(){return 1},1)})},h4=Bn,j1=h4.match(/firefox\/(\d+)/i),d4=!!j1&&+j1[1],v4=Bn,m4=/MSIE|Trident/.test(v4),y4=Bn,B1=y4.match(/AppleWebKit\/(\d+)\./),p4=!!B1&&+B1[1],g4=we,W1=Ee,b4=Wn,w4=Ht,V1=Jt,S4=L1,z1=mt,vd=Te,_4=c4,C4=Fi,U1=d4,O4=m4,G1=pa,Y1=p4,mn=[],K1=W1(mn.sort),T4=W1(mn.push),R4=vd(function(){mn.sort(void 0)}),E4=vd(function(){mn.sort(null)}),k4=C4("sort"),Z1=!vd(function(){if(G1)return G1<70;if(!(U1&&U1>3)){if(O4)return!0;if(Y1)return Y1<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)mn.push({k:r+i,v:n})}for(mn.sort(function(o,a){return a.v-o.v}),i=0;i<mn.length;i++)r=mn[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),A4=R4||!E4||!k4||!Z1,x4=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:z1(t)>z1(r)?1:-1}};g4({target:"Array",proto:!0,forced:A4},{sort:function(t){t!==void 0&&b4(t);var r=w4(this);if(Z1)return t===void 0?K1(r):K1(r,t);var n=[],i=V1(r),o,a;for(a=0;a<i;a++)a in r&&T4(n,r[a]);for(_4(n,x4(t)),o=V1(n),a=0;a<o;)r[a]=n[a++];for(;a<i;)S4(r,a++);return r}});var I4=kr,ji=Array.isArray||function(t){return I4(t)=="Array"},P4=nt,$4=ji,M4=TypeError,N4=Object.getOwnPropertyDescriptor,D4=P4&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),H4=D4?function(e,t){if($4(e)&&!N4(e,"length").writable)throw M4("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},L4=TypeError,F4=9007199254740991,q1=function(e){if(e>F4)throw L4("Maximum allowed index exceeded");return e},j4=Ee,B4=Te,X1=ze,W4=mu,V4=Br,z4=Cb,Q1=function(){},U4=[],J1=V4("Reflect","construct"),md=/^\s*(?:class|function)\b/,G4=j4(md.exec),Y4=!md.exec(Q1),La=function(t){if(!X1(t))return!1;try{return J1(Q1,U4,t),!0}catch{return!1}},ew=function(t){if(!X1(t))return!1;switch(W4(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Y4||!!G4(md,z4(t))}catch{return!0}};ew.sham=!0;var Su=!J1||B4(function(){var e;return La(La.call)||!La(Object)||!La(function(){e=!0})||e})?ew:La,tw=ji,K4=Su,Z4=tt,q4=Ve,X4=q4("species"),rw=Array,Q4=function(e){var t;return tw(e)&&(t=e.constructor,K4(t)&&(t===rw||tw(t.prototype))?t=void 0:Z4(t)&&(t=t[X4],t===null&&(t=void 0))),t===void 0?rw:t},J4=Q4,yd=function(e,t){return new(J4(e))(t===0?0:t)},e6=Te,t6=Ve,r6=pa,n6=t6("species"),Fa=function(e){return r6>=51||!e6(function(){var t=[],r=t.constructor={};return r[n6]=function(){return{foo:1}},t[e](Boolean).foo!==1})},i6=we,o6=Ht,a6=ba,s6=Vn,l6=Jt,u6=H4,c6=q1,f6=yd,h6=Li,pd=L1,d6=Fa,v6=d6("splice"),m6=Math.max,y6=Math.min;i6({target:"Array",proto:!0,forced:!v6},{splice:function(t,r){var n=o6(this),i=l6(n),o=a6(t,i),a=arguments.length,s,l,u,c,h,d;for(a===0?s=l=0:a===1?(s=0,l=i-o):(s=a-2,l=y6(m6(s6(r),0),i-o)),c6(i+s-l),u=f6(n,l),c=0;c<l;c++)h=o+c,h in n&&h6(u,c,n[h]);if(u.length=l,s<l){for(c=o;c<i-l;c++)h=c+l,d=c+s,h in n?n[d]=n[h]:pd(n,d);for(c=i;c>i-l+s;c--)pd(n,c-1)}else if(s>l)for(c=i-l;c>o;c--)h=c+l-1,d=c+s-1,h in n?n[d]=n[h]:pd(n,d);for(c=0;c<s;c++)n[c+o]=arguments[c+2];return u6(n,i-l+s),u}});var p6=tt,g6=Math.floor,b6=Number.isInteger||function(t){return!p6(t)&&isFinite(t)&&g6(t)===t},w6=we,S6=b6;w6({target:"Number",stat:!0},{isInteger:S6});var _6=Fe,nw=_6,C6=Ee,O6=C6(1 .valueOf),iw=`	
\v\f\r                　\u2028\u2029\uFEFF`,T6=Ee,R6=cr,E6=mt,gd=iw,ow=T6("".replace),k6=RegExp("^["+gd+"]+"),A6=RegExp("(^|[^"+gd+"])["+gd+"]+$"),bd=function(e){return function(t){var r=E6(R6(t));return e&1&&(r=ow(r,k6,"")),e&2&&(r=ow(r,A6,"$1")),r}},aw={start:bd(1),end:bd(2),trim:bd(3)},x6=we,sw=Tx,I6=nt,lw=Fe,uw=nw,cw=Ee,P6=cu,fw=Qe,$6=td,M6=vn,N6=ga,hw=tb,D6=Te,H6=Un.f,L6=Vr.f,F6=At.f,j6=O6,B6=aw.trim,_u="Number",Bi=lw[_u];uw[_u];var wd=Bi.prototype,W6=lw.TypeError,V6=cw("".slice),Cu=cw("".charCodeAt),z6=function(e){var t=hw(e,"number");return typeof t=="bigint"?t:U6(t)},U6=function(e){var t=hw(e,"number"),r,n,i,o,a,s,l,u;if(N6(t))throw W6("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=B6(t),r=Cu(t,0),r===43||r===45){if(n=Cu(t,2),n===88||n===120)return NaN}else if(r===48){switch(Cu(t,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+t}for(a=V6(t,2),s=a.length,l=0;l<s;l++)if(u=Cu(a,l),u<48||u>o)return NaN;return parseInt(a,i)}}return+t},Sd=P6(_u,!Bi(" 0o1")||!Bi("0b1")||Bi("+0x1")),G6=function(e){return M6(wd,e)&&D6(function(){j6(e)})},Ou=function(t){var r=arguments.length<1?0:Bi(z6(t));return G6(this)?$6(Object(r),this,Ou):r};Ou.prototype=wd,Sd&&!sw&&(wd.constructor=Ou),x6({global:!0,constructor:!0,wrap:!0,forced:Sd},{Number:Ou});var Y6=function(e,t){for(var r=I6?H6(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)fw(t,i=r[n])&&!fw(e,i)&&F6(e,i,L6(t,i))};(Sd||sw)&&Y6(uw[_u],Bi);var K6=Ee,ja=K6([].slice),Z6=we,dw=ji,q6=Su,X6=tt,vw=ba,Q6=Jt,J6=Ut,eN=Li,tN=Ve,rN=Fa,nN=ja,iN=rN("slice"),oN=tN("species"),_d=Array,aN=Math.max;Z6({target:"Array",proto:!0,forced:!iN},{slice:function(t,r){var n=J6(this),i=Q6(n),o=vw(t,i),a=vw(r===void 0?i:r,i),s,l,u;if(dw(n)&&(s=n.constructor,q6(s)&&(s===_d||dw(s.prototype))?s=void 0:X6(s)&&(s=s[oN],s===null&&(s=void 0)),s===_d||s===void 0))return nN(n,o,a);for(l=new(s===void 0?_d:s)(aN(a-o,0)),u=0;o<a;o++,u++)o in n&&eN(l,u,n[o]);return l.length=u,l}});var sN=we,lN=Te,uN=ji,cN=tt,fN=Ht,hN=Jt,mw=q1,yw=Li,dN=yd,vN=Fa,mN=Ve,yN=pa,pw=mN("isConcatSpreadable"),pN=yN>=51||!lN(function(){var e=[];return e[pw]=!1,e.concat()[0]!==e}),gN=function(e){if(!cN(e))return!1;var t=e[pw];return t!==void 0?!!t:uN(e)},bN=!pN||!vN("concat");sN({target:"Array",proto:!0,arity:1,forced:bN},{concat:function(t){var r=fN(this),n=dN(r,0),i=0,o,a,s,l,u;for(o=-1,s=arguments.length;o<s;o++)if(u=o===-1?r:arguments[o],gN(u))for(l=hN(u),mw(i+l),a=0;a<l;a++,i++)a in u&&yw(n,i,u[a]);else mw(i+1),yw(n,i++,u);return n.length=i,n}});var wN=Ht,gw=ba,SN=Jt,_N=function(t){for(var r=wN(this),n=SN(r),i=arguments.length,o=gw(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,s=a===void 0?n:gw(a,n);s>o;)r[o++]=t;return r},CN=we,ON=_N,TN=_a;CN({target:"Array",proto:!0},{fill:ON}),TN("fill");var RN=Ma,EN=Ee,kN=ya,AN=Ht,xN=Jt,IN=yd,bw=EN([].push),yn=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,o=e==6,a=e==7,s=e==5||o;return function(l,u,c,h){for(var d=AN(l),f=kN(d),v=RN(u,c),y=xN(f),m=0,S=h||IN,_=t?S(l,y):r||a?S(l,0):void 0,O,R;y>m;m++)if((s||m in f)&&(O=f[m],R=v(O,m,d),e))if(t)_[m]=R;else if(R)switch(e){case 3:return!0;case 5:return O;case 6:return m;case 2:bw(_,O)}else switch(e){case 4:return!1;case 7:bw(_,O)}return o?-1:n||i?i:_}},Yn={forEach:yn(0),map:yn(1),filter:yn(2),some:yn(3),every:yn(4),find:yn(5),findIndex:yn(6),filterReject:yn(7)},PN=we,$N=Yn.map,MN=Fa,NN=MN("map");PN({target:"Array",proto:!0,forced:!NN},{map:function(t){return $N(this,t,arguments.length>1?arguments[1]:void 0)}});var DN=rt,ww=function(){var e=DN(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Cd=Te,HN=Fe,Od=HN.RegExp,Td=Cd(function(){var e=Od("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),LN=Td||Cd(function(){return!Od("a","y").sticky}),FN=Td||Cd(function(){var e=Od("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),Rd={BROKEN_CARET:FN,MISSED_STICKY:LN,UNSUPPORTED_Y:Td},jN=Te,BN=Fe,WN=BN.RegExp,Sw=jN(function(){var e=WN(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),VN=Te,zN=Fe,UN=zN.RegExp,_w=VN(function(){var e=UN("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Wi=ct,Tu=Ee,GN=mt,YN=ww,KN=Rd,ZN=xi,qN=Di,XN=Wr.get,QN=Sw,JN=_w,eD=ZN("native-string-replace",String.prototype.replace),Ru=RegExp.prototype.exec,Ed=Ru,tD=Tu("".charAt),rD=Tu("".indexOf),nD=Tu("".replace),kd=Tu("".slice),Ad=function(){var e=/a/,t=/b*/g;return Wi(Ru,e,"a"),Wi(Ru,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Cw=KN.BROKEN_CARET,xd=/()??/.exec("")[1]!==void 0,iD=Ad||xd||Cw||QN||JN;iD&&(Ed=function(t){var r=this,n=XN(r),i=GN(t),o=n.raw,a,s,l,u,c,h,d;if(o)return o.lastIndex=r.lastIndex,a=Wi(Ed,o,i),r.lastIndex=o.lastIndex,a;var f=n.groups,v=Cw&&r.sticky,y=Wi(YN,r),m=r.source,S=0,_=i;if(v&&(y=nD(y,"y",""),rD(y,"g")===-1&&(y+="g"),_=kd(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&tD(i,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",_=" "+_,S++),s=new RegExp("^(?:"+m+")",y)),xd&&(s=new RegExp("^"+m+"$(?!\\s)",y)),Ad&&(l=r.lastIndex),u=Wi(Ru,v?s:r,_),v?u?(u.input=kd(u.input,S),u[0]=kd(u[0],S),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:Ad&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),xd&&u&&u.length>1&&Wi(eD,u[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&f)for(u.groups=h=qN(null),c=0;c<f.length;c++)d=f[c],h[d[0]]=u[d[1]];return u});var Eu=Ed,oD=we,Ow=Eu;oD({target:"RegExp",proto:!0,forced:/./.exec!==Ow},{exec:Ow});var aD=ma,Tw=Function.prototype,Rw=Tw.apply,Ew=Tw.call,Kn=typeof Reflect=="object"&&Reflect.apply||(aD?Ew.bind(Rw):function(){return Ew.apply(Rw,arguments)}),kw=pu,Aw=er,sD=Eu,xw=Te,Iw=Ve,lD=zn,uD=Iw("species"),Id=RegExp.prototype,Pd=function(e,t,r,n){var i=Iw(e),o=!xw(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),a=o&&!xw(function(){var u=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[uD]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return u=!0,null},c[i](""),!u});if(!o||!a||r){var s=kw(/./[i]),l=t(i,""[e],function(u,c,h,d,f){var v=kw(u),y=c.exec;return y===sD||y===Id.exec?o&&!f?{done:!0,value:s(c,h,d)}:{done:!0,value:v(h,c,d)}:{done:!1}});Aw(String.prototype,e,l[0]),Aw(Id,i,l[1])}n&&lD(Id[i],"sham",!0)},cD=sd.charAt,$d=function(e,t,r){return t+(r?cD(e,t).length:1)},Md=Ee,fD=Ht,hD=Math.floor,Nd=Md("".charAt),dD=Md("".replace),Dd=Md("".slice),vD=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,mD=/\$([$&'`]|\d{1,2})/g,yD=function(e,t,r,n,i,o){var a=r+e.length,s=n.length,l=mD;return i!==void 0&&(i=fD(i),l=vD),dD(o,l,function(u,c){var h;switch(Nd(c,0)){case"$":return"$";case"&":return e;case"`":return Dd(t,0,r);case"'":return Dd(t,a);case"<":h=i[Dd(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>s){var f=hD(d/10);return f===0?u:f<=s?n[f-1]===void 0?Nd(c,1):n[f-1]+Nd(c,1):u}h=n[d-1]}return h===void 0?"":h})},Pw=ct,pD=rt,gD=ze,bD=kr,wD=Eu,SD=TypeError,Hd=function(e,t){var r=e.exec;if(gD(r)){var n=Pw(r,e,t);return n!==null&&pD(n),n}if(bD(e)==="RegExp")return Pw(wD,e,t);throw SD("RegExp#exec called on incompatible receiver")},_D=Kn,$w=ct,ku=Ee,CD=Pd,OD=Te,TD=rt,RD=ze,ED=Ar,kD=Vn,AD=Ni,Vi=mt,xD=cr,ID=$d,PD=Mi,$D=yD,MD=Hd,ND=Ve,Ld=ND("replace"),DD=Math.max,HD=Math.min,LD=ku([].concat),Fd=ku([].push),Mw=ku("".indexOf),Nw=ku("".slice),FD=function(e){return e===void 0?e:String(e)},jD=function(){return"a".replace(/./,"$0")==="$0"}(),Dw=function(){return/./[Ld]?/./[Ld]("a","$0")==="":!1}(),BD=!OD(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});CD("replace",function(e,t,r){var n=Dw?"$":"$0";return[function(o,a){var s=xD(this),l=ED(o)?void 0:PD(o,Ld);return l?$w(l,o,s,a):$w(t,Vi(s),o,a)},function(i,o){var a=TD(this),s=Vi(i);if(typeof o=="string"&&Mw(o,n)===-1&&Mw(o,"$<")===-1){var l=r(t,a,s,o);if(l.done)return l.value}var u=RD(o);u||(o=Vi(o));var c=a.global;if(c){var h=a.unicode;a.lastIndex=0}for(var d=[];;){var f=MD(a,s);if(f===null||(Fd(d,f),!c))break;var v=Vi(f[0]);v===""&&(a.lastIndex=ID(s,AD(a.lastIndex),h))}for(var y="",m=0,S=0;S<d.length;S++){f=d[S];for(var _=Vi(f[0]),O=DD(HD(kD(f.index),s.length),0),R=[],T=1;T<f.length;T++)Fd(R,FD(f[T]));var D=f.groups;if(u){var H=LD([_],R,O,s);D!==void 0&&Fd(H,D);var V=Vi(_D(o,void 0,H))}else V=$D(_,s,O,R,D,o);O>=m&&(y+=Nw(s,m,O)+V,m=O+_.length)}return y+Nw(s,m)}]},!BD||!jD||Dw);var WD=we,VD=Yn.filter,zD=Fa,UD=zD("filter");WD({target:"Array",proto:!0,forced:!UD},{filter:function(t){return VD(this,t,arguments.length>1?arguments[1]:void 0)}});var GD=rt,YD=a1,KD=function(e,t,r,n){try{return n?t(GD(r)[0],r[1]):t(r)}catch(i){YD(e,"throw",i)}},ZD=Ma,qD=ct,XD=Ht,QD=KD,JD=r1,e8=Su,t8=Jt,Hw=Li,r8=i1,n8=Qh,Lw=Array,i8=function(t){var r=XD(t),n=e8(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=ZD(o,i>2?arguments[2]:void 0));var s=n8(r),l=0,u,c,h,d,f,v;if(s&&!(this===Lw&&JD(s)))for(d=r8(r,s),f=d.next,c=n?new this:[];!(h=qD(f,d)).done;l++)v=a?QD(d,o,[h.value,l],!0):h.value,Hw(c,l,v);else for(u=t8(r),c=n?new this(u):Lw(u);u>l;l++)v=a?o(r[l],l):r[l],Hw(c,l,v);return c.length=l,c},o8=we,a8=i8,s8=d1,l8=!s8(function(e){Array.from(e)});o8({target:"Array",stat:!0,forced:l8},{from:a8});var u8=we,c8=pu,f8=bh.indexOf,h8=Fi,jd=c8([].indexOf),Fw=!!jd&&1/jd([1],1,-0)<0,d8=Fw||!h8("indexOf");u8({target:"Array",proto:!0,forced:d8},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return Fw?jd(this,t,r)||0:f8(this,t,r)}});var v8=we,m8=Ee,y8=ji,p8=m8([].reverse),jw=[1,2];v8({target:"Array",proto:!0,forced:String(jw)===String(jw.reverse())},{reverse:function(){return y8(this)&&(this.length=this.length),p8(this)}});var g8=Yn.forEach,b8=Fi,w8=b8("forEach"),S8=w8?[].forEach:function(t){return g8(this,t,arguments.length>1?arguments[1]:void 0)},Bw=Fe,Ww=A1,_8=I1,Bd=S8,C8=zn,Vw=function(e){if(e&&e.forEach!==Bd)try{C8(e,"forEach",Bd)}catch{e.forEach=Bd}};for(var Wd in Ww)Ww[Wd]&&Vw(Bw[Wd]&&Bw[Wd].prototype);Vw(_8);var O8=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",T8=TypeError,zw=function(e,t){if(e<t)throw T8("Not enough arguments");return e},Uw=Fe,R8=Kn,E8=ze,k8=O8,A8=Bn,x8=ja,I8=zw,P8=Uw.Function,$8=/MSIE .\./.test(A8)||k8&&function(){var e=Uw.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),Vd=function(e,t){var r=t?2:1;return $8?function(n,i){var o=I8(arguments.length,1)>r,a=E8(n)?n:P8(n),s=o?x8(arguments,r):[],l=o?function(){R8(a,this,s)}:a;return t?e(l,i):e(l)}:e},M8=we,Gw=Fe,N8=Vd,Yw=N8(Gw.setInterval,!0);M8({global:!0,bind:!0,forced:Gw.setInterval!==Yw},{setInterval:Yw});var D8=we,Kw=Fe,H8=Vd,Zw=H8(Kw.setTimeout,!0);D8({global:!0,bind:!0,forced:Kw.setTimeout!==Zw},{setTimeout:Zw});var L8=Bn,F8=/(?:ipad|iphone|ipod).*applewebkit/i.test(L8),j8=kr,qw=typeof process<"u"&&j8(process)=="process",Gt=Fe,B8=Kn,W8=Ma,Xw=ze,V8=Qe,Qw=Te,Jw=ab,z8=ja,e0=Jl,U8=zw,G8=F8,Y8=qw,zd=Gt.setImmediate,Ud=Gt.clearImmediate,K8=Gt.process,Gd=Gt.Dispatch,Z8=Gt.Function,t0=Gt.MessageChannel,q8=Gt.String,Yd=0,Ba={},r0="onreadystatechange",Wa,Zn,Kd,Zd;Qw(function(){Wa=Gt.location});var qd=function(e){if(V8(Ba,e)){var t=Ba[e];delete Ba[e],t()}},Xd=function(e){return function(){qd(e)}},n0=function(e){qd(e.data)},i0=function(e){Gt.postMessage(q8(e),Wa.protocol+"//"+Wa.host)};(!zd||!Ud)&&(zd=function(t){U8(arguments.length,1);var r=Xw(t)?t:Z8(t),n=z8(arguments,1);return Ba[++Yd]=function(){B8(r,void 0,n)},Zn(Yd),Yd},Ud=function(t){delete Ba[t]},Y8?Zn=function(e){K8.nextTick(Xd(e))}:Gd&&Gd.now?Zn=function(e){Gd.now(Xd(e))}:t0&&!G8?(Kd=new t0,Zd=Kd.port2,Kd.port1.onmessage=n0,Zn=W8(Zd.postMessage,Zd)):Gt.addEventListener&&Xw(Gt.postMessage)&&!Gt.importScripts&&Wa&&Wa.protocol!=="file:"&&!Qw(i0)?(Zn=i0,Gt.addEventListener("message",n0,!1)):r0 in e0("script")?Zn=function(e){Jw.appendChild(e0("script"))[r0]=function(){Jw.removeChild(this),qd(e)}}:Zn=function(e){setTimeout(Xd(e),0)});var o0={set:zd,clear:Ud},X8=we,Q8=Fe,a0=o0.clear;X8({global:!0,bind:!0,enumerable:!0,forced:Q8.clearImmediate!==a0},{clearImmediate:a0});var J8=we,s0=Fe,l0=o0.set,eH=Vd,u0=s0.setImmediate?eH(l0,!1):l0;J8({global:!0,bind:!0,enumerable:!0,forced:s0.setImmediate!==u0},{setImmediate:u0});var tH=bu,rH=C1;tH("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},rH);var Qd={},nH=Ve;Qd.f=nH;var c0=nw,iH=Qe,oH=Qd,aH=At.f,Jd=function(e){var t=c0.Symbol||(c0.Symbol={});iH(t,e)||aH(t,e,{value:oH.f(e)})},sH=ct,lH=Br,uH=Ve,cH=er,f0=function(){var e=lH("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=uH("toPrimitive");t&&!t[n]&&cH(t,n,function(i){return sH(r,this)},{arity:1})},Au=we,ev=Fe,tv=ct,fH=Ee,zi=nt,Ui=Ii,hH=Te,yt=Qe,dH=vn,rv=rt,xu=Ut,nv=tu,vH=mt,iv=Oa,Va=Di,h0=Sa,mH=Un,d0=Gh,yH=ka,v0=Vr,m0=At,pH=uh,y0=Ra,ov=er,gH=Na,av=xi,bH=nu,p0=wa,g0=Xl,wH=Ve,SH=Qd,_H=Jd,CH=f0,OH=fu,b0=Wr,Iu=Yn.forEach,Lt=bH("hidden"),Pu="Symbol",za="prototype",TH=b0.set,w0=b0.getterFor(Pu),tr=Object[za],qn=ev.Symbol,Ua=qn&&qn[za],RH=ev.TypeError,sv=ev.QObject,S0=v0.f,Xn=m0.f,_0=d0.f,EH=y0.f,C0=fH([].push),Ur=av("symbols"),Ga=av("op-symbols"),kH=av("wks"),lv=!sv||!sv[za]||!sv[za].findChild,uv=zi&&hH(function(){return Va(Xn({},"a",{get:function(){return Xn(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=S0(tr,t);n&&delete tr[t],Xn(e,t,r),n&&e!==tr&&Xn(tr,t,n)}:Xn,cv=function(e,t){var r=Ur[e]=Va(Ua);return TH(r,{type:Pu,tag:e,description:t}),zi||(r.description=t),r},$u=function(t,r,n){t===tr&&$u(Ga,r,n),rv(t);var i=nv(r);return rv(n),yt(Ur,i)?(n.enumerable?(yt(t,Lt)&&t[Lt][i]&&(t[Lt][i]=!1),n=Va(n,{enumerable:iv(0,!1)})):(yt(t,Lt)||Xn(t,Lt,iv(1,{})),t[Lt][i]=!0),uv(t,i,n)):Xn(t,i,n)},fv=function(t,r){rv(t);var n=xu(r),i=h0(n).concat(R0(n));return Iu(i,function(o){(!zi||tv(hv,n,o))&&$u(t,o,n[o])}),t},AH=function(t,r){return r===void 0?Va(t):fv(Va(t),r)},hv=function(t){var r=nv(t),n=tv(EH,this,r);return this===tr&&yt(Ur,r)&&!yt(Ga,r)?!1:n||!yt(this,r)||!yt(Ur,r)||yt(this,Lt)&&this[Lt][r]?n:!0},O0=function(t,r){var n=xu(t),i=nv(r);if(!(n===tr&&yt(Ur,i)&&!yt(Ga,i))){var o=S0(n,i);return o&&yt(Ur,i)&&!(yt(n,Lt)&&n[Lt][i])&&(o.enumerable=!0),o}},T0=function(t){var r=_0(xu(t)),n=[];return Iu(r,function(i){!yt(Ur,i)&&!yt(p0,i)&&C0(n,i)}),n},R0=function(e){var t=e===tr,r=_0(t?Ga:xu(e)),n=[];return Iu(r,function(i){yt(Ur,i)&&(!t||yt(tr,i))&&C0(n,Ur[i])}),n};Ui||(qn=function(){if(dH(Ua,this))throw RH("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:vH(arguments[0]),r=g0(t),n=function(i){this===tr&&tv(n,Ga,i),yt(this,Lt)&&yt(this[Lt],r)&&(this[Lt][r]=!1),uv(this,r,iv(1,i))};return zi&&lv&&uv(tr,r,{configurable:!0,set:n}),cv(r,t)},Ua=qn[za],ov(Ua,"toString",function(){return w0(this).tag}),ov(qn,"withoutSetter",function(e){return cv(g0(e),e)}),y0.f=hv,m0.f=$u,pH.f=fv,v0.f=O0,mH.f=d0.f=T0,yH.f=R0,SH.f=function(e){return cv(wH(e),e)},zi&&(gH(Ua,"description",{configurable:!0,get:function(){return w0(this).description}}),ov(tr,"propertyIsEnumerable",hv,{unsafe:!0}))),Au({global:!0,constructor:!0,wrap:!0,forced:!Ui,sham:!Ui},{Symbol:qn}),Iu(h0(kH),function(e){_H(e)}),Au({target:Pu,stat:!0,forced:!Ui},{useSetter:function(){lv=!0},useSimple:function(){lv=!1}}),Au({target:"Object",stat:!0,forced:!Ui,sham:!zi},{create:AH,defineProperty:$u,defineProperties:fv,getOwnPropertyDescriptor:O0}),Au({target:"Object",stat:!0,forced:!Ui},{getOwnPropertyNames:T0}),CH(),OH(qn,Pu),p0[Lt]=!0;var xH=Ii,E0=xH&&!!Symbol.for&&!!Symbol.keyFor,IH=we,PH=Br,$H=Qe,MH=mt,k0=xi,NH=E0,dv=k0("string-to-symbol-registry"),DH=k0("symbol-to-string-registry");IH({target:"Symbol",stat:!0,forced:!NH},{for:function(e){var t=MH(e);if($H(dv,t))return dv[t];var r=PH("Symbol")(t);return dv[t]=r,DH[r]=t,r}});var HH=we,LH=Qe,FH=ga,jH=$i,BH=xi,WH=E0,A0=BH("symbol-to-string-registry");HH({target:"Symbol",stat:!0,forced:!WH},{keyFor:function(t){if(!FH(t))throw TypeError(jH(t)+" is not a symbol");if(LH(A0,t))return A0[t]}});var VH=Ee,x0=ji,zH=ze,I0=kr,UH=mt,P0=VH([].push),GH=function(e){if(zH(e))return e;if(x0(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?P0(r,i):(typeof i=="number"||I0(i)=="Number"||I0(i)=="String")&&P0(r,UH(i))}var o=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(x0(this))return l;for(var u=0;u<o;u++)if(r[u]===s)return l}}},YH=we,$0=Br,M0=Kn,KH=ct,Ya=Ee,N0=Te,D0=ze,H0=ga,L0=ja,ZH=GH,qH=Ii,XH=String,pn=$0("JSON","stringify"),Mu=Ya(/./.exec),F0=Ya("".charAt),QH=Ya("".charCodeAt),JH=Ya("".replace),e7=Ya(1 .toString),t7=/[\uD800-\uDFFF]/g,j0=/^[\uD800-\uDBFF]$/,B0=/^[\uDC00-\uDFFF]$/,W0=!qH||N0(function(){var e=$0("Symbol")();return pn([e])!="[null]"||pn({a:e})!="{}"||pn(Object(e))!="{}"}),V0=N0(function(){return pn("\uDF06\uD834")!=='"\\udf06\\ud834"'||pn("\uDEAD")!=='"\\udead"'}),r7=function(e,t){var r=L0(arguments),n=ZH(t);if(!(!D0(n)&&(e===void 0||H0(e))))return r[1]=function(i,o){if(D0(n)&&(o=KH(n,this,XH(i),o)),!H0(o))return o},M0(pn,null,r)},n7=function(e,t,r){var n=F0(r,t-1),i=F0(r,t+1);return Mu(j0,e)&&!Mu(B0,i)||Mu(B0,e)&&!Mu(j0,n)?"\\u"+e7(QH(e,0),16):e};pn&&YH({target:"JSON",stat:!0,arity:3,forced:W0||V0},{stringify:function(t,r,n){var i=L0(arguments),o=M0(W0?r7:pn,null,i);return V0&&typeof o=="string"?JH(o,t7,n7):o}});var i7=we,o7=Ii,a7=Te,z0=ka,s7=Ht,l7=!o7||a7(function(){z0.f(1)});i7({target:"Object",stat:!0,forced:l7},{getOwnPropertySymbols:function(t){var r=z0.f;return r?r(s7(t)):[]}});var u7=we,c7=nt,f7=Fe,Nu=Ee,h7=Qe,d7=ze,v7=vn,m7=mt,y7=Na,p7=Ab,Gr=f7.Symbol,Qn=Gr&&Gr.prototype;if(c7&&d7(Gr)&&(!("description"in Qn)||Gr().description!==void 0)){var U0={},Du=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:m7(arguments[0]),r=v7(Qn,this)?new Gr(t):t===void 0?Gr():Gr(t);return t===""&&(U0[r]=!0),r};p7(Du,Gr),Du.prototype=Qn,Qn.constructor=Du;var g7=String(Gr("test"))=="Symbol(test)",b7=Nu(Qn.valueOf),w7=Nu(Qn.toString),S7=/^Symbol\((.*)\)[^)]+$/,_7=Nu("".replace),C7=Nu("".slice);y7(Qn,"description",{configurable:!0,get:function(){var t=b7(this);if(h7(U0,t))return"";var r=w7(t),n=g7?C7(r,7,-1):_7(r,S7,"$1");return n===""?void 0:n}}),u7({global:!0,constructor:!0,forced:!0},{Symbol:Du})}var O7=Jd;O7("iterator");var T7=ct,R7=Qe,E7=vn,k7=ww,G0=RegExp.prototype,Y0=function(e){var t=e.flags;return t===void 0&&!("flags"in G0)&&!R7(e,"flags")&&E7(G0,e)?T7(k7,e):t},A7=Ea.PROPER,x7=er,I7=rt,K0=mt,P7=Te,$7=Y0,vv="toString",M7=RegExp.prototype,Z0=M7[vv],N7=P7(function(){return Z0.call({source:"a",flags:"b"})!="/a/b"}),D7=A7&&Z0.name!=vv;(N7||D7)&&x7(RegExp.prototype,vv,function(){var t=I7(this),r=K0(t.source),n=K0($7(t));return"/"+r+"/"+n},{unsafe:!0});var H7=nt,L7=Ea.EXISTS,q0=Ee,F7=Na,X0=Function.prototype,j7=q0(X0.toString),Q0=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,B7=q0(Q0.exec),W7="name";H7&&!L7&&F7(X0,W7,{configurable:!0,get:function(){try{return B7(Q0,j7(this))[1]}catch{return""}}});var V7=we,z7=Te,U7=Ht,J0=xa,G7=xb,Y7=z7(function(){J0(1)});V7({target:"Object",stat:!0,forced:Y7,sham:!G7},{getPrototypeOf:function(t){return J0(U7(t))}});var K7=tt,Z7=kr,q7=Ve,X7=q7("match"),mv=function(e){var t;return K7(e)&&((t=e[X7])!==void 0?!!t:Z7(e)=="RegExp")},Q7=mv,J7=TypeError,eS=function(e){if(Q7(e))throw J7("The method doesn't accept regular expressions");return e},e9=Ve,t9=e9("match"),tS=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[t9]=!1,"/./"[e](t)}catch{}}return!1},r9=we,n9=Ee,i9=eS,o9=cr,rS=mt,a9=tS,s9=n9("".indexOf);r9({target:"String",proto:!0,forced:!a9("includes")},{includes:function(t){return!!~s9(rS(o9(this)),rS(i9(t)),arguments.length>1?arguments[1]:void 0)}});var l9=At.f,u9=function(e,t,r){r in e||l9(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},c9=nt,yv=Fe,Ka=Ee,f9=cu,h9=td,d9=zn,v9=Un.f,nS=vn,m9=mv,iS=mt,y9=Y0,oS=Rd,p9=u9,g9=er,b9=Te,w9=Qe,S9=Wr.enforce,_9=g1,C9=Ve,aS=Sw,sS=_w,O9=C9("match"),gn=yv.RegExp,Gi=gn.prototype,T9=yv.SyntaxError,R9=Ka(Gi.exec),Hu=Ka("".charAt),lS=Ka("".replace),uS=Ka("".indexOf),E9=Ka("".slice),k9=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Jn=/a/g,pv=/a/g,A9=new gn(Jn)!==Jn,cS=oS.MISSED_STICKY,x9=oS.UNSUPPORTED_Y,I9=c9&&(!A9||cS||aS||sS||b9(function(){return pv[O9]=!1,gn(Jn)!=Jn||gn(pv)==pv||gn(Jn,"i")!="/a/i"})),P9=function(e){for(var t=e.length,r=0,n="",i=!1,o;r<=t;r++){if(o=Hu(e,r),o==="\\"){n+=o+Hu(e,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},$9=function(e){for(var t=e.length,r=0,n="",i=[],o={},a=!1,s=!1,l=0,u="",c;r<=t;r++){if(c=Hu(e,r),c==="\\")c=c+Hu(e,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":R9(k9,E9(e,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||w9(o,u))throw new T9("Invalid capture group name");o[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,i]};if(f9("RegExp",I9)){for(var ei=function(t,r){var n=nS(Gi,this),i=m9(t),o=r===void 0,a=[],s=t,l,u,c,h,d,f;if(!n&&i&&o&&t.constructor===ei)return t;if((i||nS(Gi,t))&&(t=t.source,o&&(r=y9(s))),t=t===void 0?"":iS(t),r=r===void 0?"":iS(r),s=t,aS&&"dotAll"in Jn&&(u=!!r&&uS(r,"s")>-1,u&&(r=lS(r,/s/g,""))),l=r,cS&&"sticky"in Jn&&(c=!!r&&uS(r,"y")>-1,c&&x9&&(r=lS(r,/y/g,""))),sS&&(h=$9(t),t=h[0],a=h[1]),d=h9(gn(t,r),n?this:Gi,ei),(u||c||a.length)&&(f=S9(d),u&&(f.dotAll=!0,f.raw=ei(P9(t),l)),c&&(f.sticky=!0),a.length&&(f.groups=a)),t!==s)try{d9(d,"source",s===""?"(?:)":s)}catch{}return d},fS=v9(gn),hS=0;fS.length>hS;)p9(ei,gn,fS[hS++]);Gi.constructor=ei,ei.prototype=Gi,g9(yv,"RegExp",ei,{constructor:!0})}_9("RegExp");var M9=we,N9=Ee,D9=ya,H9=Ut,L9=Fi,F9=N9([].join),j9=D9!=Object,B9=j9||!L9("join",",");M9({target:"Array",proto:!0,forced:B9},{join:function(t){return F9(H9(this),t===void 0?",":t)}});var W9=Ea.PROPER,V9=Te,dS=iw,vS="​᠎",z9=function(e){return V9(function(){return!!dS[e]()||vS[e]()!==vS||W9&&dS[e].name!==e})},U9=we,G9=aw.trim,Y9=z9;U9({target:"String",proto:!0,forced:Y9("trim")},{trim:function(){return G9(this)}});function mS(e){return window.requestAnimationFrame(e)}function K9(){return!!document.documentElement.classList}function Z9(){return!!document.createTextNode("test").textContent}function q9(){return!!window.getComputedStyle}function yS(e){window.cancelAnimationFrame(e)}function X9(){return"ontouchstart"in window}var gv;function Q9(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),gv=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function pS(){return gv===void 0&&Q9(),gv}var Za;function J9(){if(Za!==void 0)return Za;try{var e={get passive(){Za=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Za=!1}return Za}var eL=we,tL=Ht,gS=Sa,rL=Te,nL=rL(function(){gS(1)});eL({target:"Object",stat:!0,forced:nL},{keys:function(t){return gS(tL(t))}});var iL=Jd,oL=f0;iL("toPrimitive"),oL();var aL=rt,sL=Qg,lL=TypeError,uL=function(e){if(aL(this),e==="string"||e==="default")e="string";else if(e!=="number")throw lL("Incorrect hint");return sL(this,e)},cL=Qe,fL=er,hL=uL,dL=Ve,bS=dL("toPrimitive"),wS=Date.prototype;cL(wS,bS)||fL(wS,bS,hL);var vL=Su,mL=$i,yL=TypeError,SS=function(e){if(vL(e))return e;throw yL(mL(e)+" is not a constructor")},_S=rt,pL=SS,gL=Ar,bL=Ve,wL=bL("species"),SL=function(e,t){var r=_S(e).constructor,n;return r===void 0||gL(n=_S(r)[wL])?t:pL(n)},_L=Kn,qa=ct,bv=Ee,CL=Pd,OL=rt,TL=Ar,RL=mv,CS=cr,EL=SL,kL=$d,AL=Ni,wv=mt,xL=Mi,OS=Yh,TS=Hd,IL=Eu,PL=Rd,$L=Te,Yi=PL.UNSUPPORTED_Y,RS=4294967295,ML=Math.min,ES=[].push,NL=bv(/./.exec),Ki=bv(ES),Xa=bv("".slice),DL=!$L(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});CL("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=wv(CS(this)),s=o===void 0?RS:o>>>0;if(s===0)return[];if(i===void 0)return[a];if(!RL(i))return qa(t,a,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,h=new RegExp(i.source,u+"g"),d,f,v;(d=qa(IL,h,a))&&(f=h.lastIndex,!(f>c&&(Ki(l,Xa(a,c,d.index)),d.length>1&&d.index<a.length&&_L(ES,l,OS(d,1)),v=d[0].length,c=f,l.length>=s)));)h.lastIndex===d.index&&h.lastIndex++;return c===a.length?(v||!NL(h,""))&&Ki(l,""):Ki(l,Xa(a,c)),l.length>s?OS(l,0,s):l}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:qa(t,this,i,o)}:n=t,[function(o,a){var s=CS(this),l=TL(o)?void 0:xL(o,e);return l?qa(l,o,s,a):qa(n,wv(s),o,a)},function(i,o){var a=OL(this),s=wv(i),l=r(n,a,s,o,n!==t);if(l.done)return l.value;var u=EL(a,RegExp),c=a.unicode,h=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Yi?"g":"y"),d=new u(Yi?"^(?:"+a.source+")":a,h),f=o===void 0?RS:o>>>0;if(f===0)return[];if(s.length===0)return TS(d,s)===null?[s]:[];for(var v=0,y=0,m=[];y<s.length;){d.lastIndex=Yi?0:y;var S=TS(d,Yi?Xa(s,y):s),_;if(S===null||(_=ML(AL(d.lastIndex+(Yi?y:0)),s.length))===v)y=kL(s,y,c);else{if(Ki(m,Xa(s,v,y)),m.length===f)return m;for(var O=1;O<=S.length-1;O++)if(Ki(m,S[O]),m.length===f)return m;y=v=_}}return Ki(m,Xa(s,v)),m}]},!DL,Yi);function HL(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function kS(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Sv(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function Zi(e,t,r,n){var i=-1,o=e,a=r;Array.isArray(e)||(o=Array.from(e));var s=o.length;for(n&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=t(a,o[i],i,o),i+=1;return a}function Qa(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];t(s,r,n)&&(a+=1,o[a]=s),r+=1}return o}function Yr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];a+=1,o[a]=t(s,r,n),r+=1}return o}function Ce(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function AS(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],o=n.slice(1),a=i;return Ce(o,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function xS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function IS(e,t,r){return t=LL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LL(e){var t=FL(e,"string");return Kr(t)==="symbol"?t:String(t)}function FL(e,t){if(Kr(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kr(e){"@babel/helpers - typeof";return Kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(e)}function Ja(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},We(e,function(r,n){n!=="__children"&&(r&&Kr(r)==="object"&&!Array.isArray(r)?t[n]=Ja(r):Array.isArray(r)?r.length&&Kr(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[Ja(r[0])]:t[n]=[]:t[n]=null)})),t}function jL(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function qi(e,t,r){var n=Array.isArray(r);return We(t,function(i,o){(n===!1||r.includes(o))&&(e[o]=i)}),e}function PS(e,t){We(t,function(r,n){t[n]&&Kr(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),PS(e[n],t[n])):e[n]=t[n]})}function bn(e){return Kr(e)==="object"?JSON.parse(JSON.stringify(e)):e}function it(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Ce(r,function(i){e.MIXINS.push(i.MIXIN_NAME),We(i,function(o,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")e.prototype[a]=o;else{var s=function(c,h){var d="_".concat(c),f=function(y){var m=y;return(Array.isArray(m)||hr(m))&&(m=bn(m)),m};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){var h="_".concat(c);return function(d){this[h]=d}};Object.defineProperty(e.prototype,a,{get:s(a,o),set:l(a),configurable:!0})}})}),e}function $S(e,t){return JSON.stringify(e)===JSON.stringify(t)}function hr(e){return Object.prototype.toString.call(e)==="[object Object]"}function Zr(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function We(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function BL(e,t){var r=t.split("."),n=e;return We(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function _v(e,t,r){var n=t.split("."),i=e;n.forEach(function(o,a){a!==n.length-1?(wn(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function Cv(e){if(!hr(e))return 0;var t=function r(n){var i=0;return hr(n)?We(n,function(o,a){a!=="__children"&&(i+=r(o))}):i+=1,i};return t(e)}function Xi(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},IS(t,n,e),IS(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function wn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ft=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},Ir={chrome:Ft(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Ft(function(e){return/CriOS/.test(e)}),edge:Ft(function(e){return/Edge/.test(e)}),edgeWebKit:Ft(function(e){return/EdgiOS/.test(e)}),firefox:Ft(function(e){return/Firefox/.test(e)}),firefoxWebKit:Ft(function(e){return/FxiOS/.test(e)}),ie:Ft(function(e){return/Trident/.test(e)}),ie9:Ft(function(){return!!document.documentMode}),mobile:Ft(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Ft(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Lu={mac:Ft(function(e){return/^Mac/.test(e)}),win:Ft(function(e){return/^Win/.test(e)}),linux:Ft(function(e){return/^Linux/.test(e)}),ios:Ft(function(e){return/iPhone|iPad|iPod/i.test(e)})};function WL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;We(Ir,function(o){var a=o.test;return void a(r,i)})}function VL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;We(Lu,function(n){var i=n.test;return void i(r)})}WL(),VL();function zL(){return Ir.chrome.value}function UL(){return Ir.chromeWebKit.value}function Ov(){return Ir.firefox.value}function GL(){return Ir.firefoxWebKit.value}function YL(){return Ir.safari.value}function KL(){return Ir.edge.value}function ZL(){return Ir.ie.value}function qL(){return Ir.ie9.value}function Sn(){return Ir.mobile.value}function MS(){return Lu.ios.value}function XL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Lu.mac.value}function NS(){return Lu.mac.value}/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function _n(e){"@babel/helpers - typeof";return _n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(e)}function Tv(e,t){return Tv=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Tv(e,t)}function QL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e,t,r){return QL()?Fu=Reflect.construct:Fu=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Tv(u,a.prototype),u},Fu.apply(null,arguments)}function dr(e){return JL(e)||eF(e)||tF(e)||rF()}function JL(e){if(Array.isArray(e))return Rv(e)}function eF(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tF(e,t){if(e){if(typeof e=="string")return Rv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rv(e,t)}}function Rv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var nF=Object.hasOwnProperty,DS=Object.setPrototypeOf,iF=Object.isFrozen,oF=Object.getPrototypeOf,aF=Object.getOwnPropertyDescriptor,xt=Object.freeze,vr=Object.seal,sF=Object.create,HS=typeof Reflect<"u"&&Reflect,ju=HS.apply,Ev=HS.construct;ju||(ju=function(t,r,n){return t.apply(r,n)}),xt||(xt=function(t){return t}),vr||(vr=function(t){return t}),Ev||(Ev=function(t,r){return Fu(t,dr(r))});var lF=rr(Array.prototype.forEach),LS=rr(Array.prototype.pop),es=rr(Array.prototype.push),Bu=rr(String.prototype.toLowerCase),kv=rr(String.prototype.toString),uF=rr(String.prototype.match),mr=rr(String.prototype.replace),cF=rr(String.prototype.indexOf),fF=rr(String.prototype.trim),It=rr(RegExp.prototype.test),Av=hF(TypeError);function rr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return ju(e,t,n)}}function hF(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ev(e,r)}}function ke(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:Bu,DS&&DS(e,null);for(var i=t.length;i--;){var o=t[i];if(typeof o=="string"){var a=r(o);a!==o&&(iF(t)||(t[i]=a),o=a)}e[o]=!0}return e}function ti(e){var t=sF(null),r;for(r in e)ju(nF,e,[r])===!0&&(t[r]=e[r]);return t}function Wu(e,t){for(;e!==null;){var r=aF(e,t);if(r){if(r.get)return rr(r.get);if(typeof r.value=="function")return rr(r.value)}e=oF(e)}function n(i){return console.warn("fallback value for",i),null}return n}var FS=xt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),xv=xt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Iv=xt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),dF=xt(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Pv=xt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),vF=xt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jS=xt(["#text"]),BS=xt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),$v=xt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),WS=xt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vu=xt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mF=vr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yF=vr(/<%[\w\W]*|[\w\W]*%>/gm),pF=vr(/\${[\w\W]*}/gm),gF=vr(/^data-[\-\w.\u00B7-\uFFFF]/),bF=vr(/^aria-[\-\w]+$/),wF=vr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),SF=vr(/^(?:\w+script|data):/i),_F=vr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),CF=vr(/^html$/i),OF=function(){return typeof window>"u"?null:window},TF=function(t,r){if(_n(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function VS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OF(),t=function(M){return VS(M)};if(t.version="2.4.7",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,o=e.HTMLTemplateElement,a=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,c=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,h=e.HTMLFormElement,d=e.DOMParser,f=e.trustedTypes,v=s.prototype,y=Wu(v,"cloneNode"),m=Wu(v,"nextSibling"),S=Wu(v,"childNodes"),_=Wu(v,"parentNode");if(typeof o=="function"){var O=n.createElement("template");O.content&&O.content.ownerDocument&&(n=O.content.ownerDocument)}var R=TF(f,r),T=R?R.createHTML(""):"",D=n,H=D.implementation,V=D.createNodeIterator,F=D.createDocumentFragment,q=D.getElementsByTagName,le=r.importNode,I={};try{I=ti(n).documentMode?n.documentMode:{}}catch{}var j={};t.isSupported=typeof _=="function"&&H&&H.createHTMLDocument!==void 0&&I!==9;var C=mF,z=yF,fe=pF,G=gF,ve=bF,Q=SF,g=_F,p=wF,w=null,x=ke({},[].concat(dr(FS),dr(xv),dr(Iv),dr(Pv),dr(jS))),k=null,P=ke({},[].concat(dr(BS),dr($v),dr(WS),dr(Vu))),N=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,U=null,X=!0,ne=!0,ie=!1,ge=!0,be=!1,b=!1,W=!1,B=!1,A=!1,E=!1,$=!1,Y=!0,K=!1,L="user-content-",J=!0,oe=!1,ee={},de=null,Pe=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Se=null,Ke=ke({},["audio","video","img","source","image","track"]),wt=null,dt=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Dt="http://www.w3.org/1998/Math/MathML",De="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",Et=st,lt=!1,Or=null,at=ke({},[Dt,De,st],kv),He,ur=["application/xhtml+xml","text/html"],ut="text/html",_e,Be=null,vt=n.createElement("form"),St=function(M){return M instanceof RegExp||M instanceof Function},Xt=function(M){Be&&Be===M||((!M||_n(M)!=="object")&&(M={}),M=ti(M),He=ur.indexOf(M.PARSER_MEDIA_TYPE)===-1?He=ut:He=M.PARSER_MEDIA_TYPE,_e=He==="application/xhtml+xml"?kv:Bu,w="ALLOWED_TAGS"in M?ke({},M.ALLOWED_TAGS,_e):x,k="ALLOWED_ATTR"in M?ke({},M.ALLOWED_ATTR,_e):P,Or="ALLOWED_NAMESPACES"in M?ke({},M.ALLOWED_NAMESPACES,kv):at,wt="ADD_URI_SAFE_ATTR"in M?ke(ti(dt),M.ADD_URI_SAFE_ATTR,_e):dt,Se="ADD_DATA_URI_TAGS"in M?ke(ti(Ke),M.ADD_DATA_URI_TAGS,_e):Ke,de="FORBID_CONTENTS"in M?ke({},M.FORBID_CONTENTS,_e):Pe,Z="FORBID_TAGS"in M?ke({},M.FORBID_TAGS,_e):{},U="FORBID_ATTR"in M?ke({},M.FORBID_ATTR,_e):{},ee="USE_PROFILES"in M?M.USE_PROFILES:!1,X=M.ALLOW_ARIA_ATTR!==!1,ne=M.ALLOW_DATA_ATTR!==!1,ie=M.ALLOW_UNKNOWN_PROTOCOLS||!1,ge=M.ALLOW_SELF_CLOSE_IN_ATTR!==!1,be=M.SAFE_FOR_TEMPLATES||!1,b=M.WHOLE_DOCUMENT||!1,A=M.RETURN_DOM||!1,E=M.RETURN_DOM_FRAGMENT||!1,$=M.RETURN_TRUSTED_TYPE||!1,B=M.FORCE_BODY||!1,Y=M.SANITIZE_DOM!==!1,K=M.SANITIZE_NAMED_PROPS||!1,J=M.KEEP_CONTENT!==!1,oe=M.IN_PLACE||!1,p=M.ALLOWED_URI_REGEXP||p,Et=M.NAMESPACE||st,N=M.CUSTOM_ELEMENT_HANDLING||{},M.CUSTOM_ELEMENT_HANDLING&&St(M.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(N.tagNameCheck=M.CUSTOM_ELEMENT_HANDLING.tagNameCheck),M.CUSTOM_ELEMENT_HANDLING&&St(M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(N.attributeNameCheck=M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),M.CUSTOM_ELEMENT_HANDLING&&typeof M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(N.allowCustomizedBuiltInElements=M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),be&&(ne=!1),E&&(A=!0),ee&&(w=ke({},dr(jS)),k=[],ee.html===!0&&(ke(w,FS),ke(k,BS)),ee.svg===!0&&(ke(w,xv),ke(k,$v),ke(k,Vu)),ee.svgFilters===!0&&(ke(w,Iv),ke(k,$v),ke(k,Vu)),ee.mathMl===!0&&(ke(w,Pv),ke(k,WS),ke(k,Vu))),M.ADD_TAGS&&(w===x&&(w=ti(w)),ke(w,M.ADD_TAGS,_e)),M.ADD_ATTR&&(k===P&&(k=ti(k)),ke(k,M.ADD_ATTR,_e)),M.ADD_URI_SAFE_ATTR&&ke(wt,M.ADD_URI_SAFE_ATTR,_e),M.FORBID_CONTENTS&&(de===Pe&&(de=ti(de)),ke(de,M.FORBID_CONTENTS,_e)),J&&(w["#text"]=!0),b&&ke(w,["html","head","body"]),w.table&&(ke(w,["tbody"]),delete Z.tbody),xt&&xt(M),Be=M)},Tr=ke({},["mi","mo","mn","ms","mtext"]),Hn=ke({},["foreignobject","desc","title","annotation-xml"]),hg=ke({},["title","style","font","a","script"]),Ri=ke({},xv);ke(Ri,Iv),ke(Ri,dF);var zl=ke({},Pv);ke(zl,vF);var vce=function(M){var re=_(M);(!re||!re.tagName)&&(re={namespaceURI:Et,tagName:"template"});var ce=Bu(M.tagName),Le=Bu(re.tagName);return Or[M.namespaceURI]?M.namespaceURI===De?re.namespaceURI===st?ce==="svg":re.namespaceURI===Dt?ce==="svg"&&(Le==="annotation-xml"||Tr[Le]):!!Ri[ce]:M.namespaceURI===Dt?re.namespaceURI===st?ce==="math":re.namespaceURI===De?ce==="math"&&Hn[Le]:!!zl[ce]:M.namespaceURI===st?re.namespaceURI===De&&!Hn[Le]||re.namespaceURI===Dt&&!Tr[Le]?!1:!zl[ce]&&(hg[ce]||!Ri[ce]):!!(He==="application/xhtml+xml"&&Or[M.namespaceURI]):!1},hn=function(M){es(t.removed,{element:M});try{M.parentNode.removeChild(M)}catch{try{M.outerHTML=T}catch{M.remove()}}},dg=function(M,re){try{es(t.removed,{attribute:re.getAttributeNode(M),from:re})}catch{es(t.removed,{attribute:null,from:re})}if(re.removeAttribute(M),M==="is"&&!k[M])if(A||E)try{hn(re)}catch{}else try{re.setAttribute(M,"")}catch{}},HA=function(M){var re,ce;if(B)M="<remove></remove>"+M;else{var Le=uF(M,/^[\r\n\t ]+/);ce=Le&&Le[0]}He==="application/xhtml+xml"&&Et===st&&(M='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+M+"</body></html>");var zt=R?R.createHTML(M):M;if(Et===st)try{re=new d().parseFromString(zt,He)}catch{}if(!re||!re.documentElement){re=H.createDocument(Et,"template",null);try{re.documentElement.innerHTML=lt?T:zt}catch{}}var kt=re.body||re.documentElement;return M&&ce&&kt.insertBefore(n.createTextNode(ce),kt.childNodes[0]||null),Et===st?q.call(re,b?"html":"body")[0]:b?re.documentElement:kt},LA=function(M){return V.call(M.ownerDocument||M,M,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},mce=function(M){return M instanceof h&&(typeof M.nodeName!="string"||typeof M.textContent!="string"||typeof M.removeChild!="function"||!(M.attributes instanceof c)||typeof M.removeAttribute!="function"||typeof M.setAttribute!="function"||typeof M.namespaceURI!="string"||typeof M.insertBefore!="function"||typeof M.hasChildNodes!="function")},Ul=function(M){return _n(a)==="object"?M instanceof a:M&&_n(M)==="object"&&typeof M.nodeType=="number"&&typeof M.nodeName=="string"},dn=function(M,re,ce){j[M]&&lF(j[M],function(Le){Le.call(t,re,ce,Be)})},FA=function(M){var re;if(dn("beforeSanitizeElements",M,null),mce(M)||It(/[\u0080-\uFFFF]/,M.nodeName))return hn(M),!0;var ce=_e(M.nodeName);if(dn("uponSanitizeElement",M,{tagName:ce,allowedTags:w}),M.hasChildNodes()&&!Ul(M.firstElementChild)&&(!Ul(M.content)||!Ul(M.content.firstElementChild))&&It(/<[/\w]/g,M.innerHTML)&&It(/<[/\w]/g,M.textContent)||ce==="select"&&It(/<template/i,M.innerHTML))return hn(M),!0;if(!w[ce]||Z[ce]){if(!Z[ce]&&BA(ce)&&(N.tagNameCheck instanceof RegExp&&It(N.tagNameCheck,ce)||N.tagNameCheck instanceof Function&&N.tagNameCheck(ce)))return!1;if(J&&!de[ce]){var Le=_(M)||M.parentNode,zt=S(M)||M.childNodes;if(zt&&Le)for(var kt=zt.length,_t=kt-1;_t>=0;--_t)Le.insertBefore(y(zt[_t],!0),m(M))}return hn(M),!0}return M instanceof s&&!vce(M)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&It(/<\/no(script|embed|frames)/i,M.innerHTML)?(hn(M),!0):(be&&M.nodeType===3&&(re=M.textContent,re=mr(re,C," "),re=mr(re,z," "),re=mr(re,fe," "),M.textContent!==re&&(es(t.removed,{element:M.cloneNode()}),M.textContent=re)),dn("afterSanitizeElements",M,null),!1)},jA=function(M,re,ce){if(Y&&(re==="id"||re==="name")&&(ce in n||ce in vt))return!1;if(!(ne&&!U[re]&&It(G,re))){if(!(X&&It(ve,re))){if(!k[re]||U[re]){if(!(BA(M)&&(N.tagNameCheck instanceof RegExp&&It(N.tagNameCheck,M)||N.tagNameCheck instanceof Function&&N.tagNameCheck(M))&&(N.attributeNameCheck instanceof RegExp&&It(N.attributeNameCheck,re)||N.attributeNameCheck instanceof Function&&N.attributeNameCheck(re))||re==="is"&&N.allowCustomizedBuiltInElements&&(N.tagNameCheck instanceof RegExp&&It(N.tagNameCheck,ce)||N.tagNameCheck instanceof Function&&N.tagNameCheck(ce))))return!1}else if(!wt[re]){if(!It(p,mr(ce,g,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&M!=="script"&&cF(ce,"data:")===0&&Se[M])){if(!(ie&&!It(Q,mr(ce,g,"")))){if(ce)return!1}}}}}}return!0},BA=function(M){return M.indexOf("-")>0},WA=function(M){var re,ce,Le,zt;dn("beforeSanitizeAttributes",M,null);var kt=M.attributes;if(kt){var _t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k};for(zt=kt.length;zt--;){re=kt[zt];var Zf=re,gt=Zf.name,vg=Zf.namespaceURI;if(ce=gt==="value"?re.value:fF(re.value),Le=_e(gt),_t.attrName=Le,_t.attrValue=ce,_t.keepAttr=!0,_t.forceKeepAttr=void 0,dn("uponSanitizeAttribute",M,_t),ce=_t.attrValue,!_t.forceKeepAttr&&(dg(gt,M),!!_t.keepAttr)){if(!ge&&It(/\/>/i,ce)){dg(gt,M);continue}be&&(ce=mr(ce,C," "),ce=mr(ce,z," "),ce=mr(ce,fe," "));var VA=_e(M.nodeName);if(jA(VA,Le,ce)){if(K&&(Le==="id"||Le==="name")&&(dg(gt,M),ce=L+ce),R&&_n(f)==="object"&&typeof f.getAttributeType=="function"&&!vg)switch(f.getAttributeType(VA,Le)){case"TrustedHTML":{ce=R.createHTML(ce);break}case"TrustedScriptURL":{ce=R.createScriptURL(ce);break}}try{vg?M.setAttributeNS(vg,gt,ce):M.setAttribute(gt,ce),LS(t.removed)}catch{}}}}dn("afterSanitizeAttributes",M,null)}},yce=function ye(M){var re,ce=LA(M);for(dn("beforeSanitizeShadowDOM",M,null);re=ce.nextNode();)dn("uponSanitizeShadowNode",re,null),!FA(re)&&(re.content instanceof i&&ye(re.content),WA(re));dn("afterSanitizeShadowDOM",M,null)};return t.sanitize=function(ye){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re,ce,Le,zt,kt;if(lt=!ye,lt&&(ye="<!-->"),typeof ye!="string"&&!Ul(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Av("dirty is not a string, aborting")}else throw Av("toString is not a function");if(!t.isSupported){if(_n(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof ye=="string")return e.toStaticHTML(ye);if(Ul(ye))return e.toStaticHTML(ye.outerHTML)}return ye}if(W||Xt(M),t.removed=[],typeof ye=="string"&&(oe=!1),oe){if(ye.nodeName){var _t=_e(ye.nodeName);if(!w[_t]||Z[_t])throw Av("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=HA("<!---->"),ce=re.ownerDocument.importNode(ye,!0),ce.nodeType===1&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?re=ce:re.appendChild(ce);else{if(!A&&!be&&!b&&ye.indexOf("<")===-1)return R&&$?R.createHTML(ye):ye;if(re=HA(ye),!re)return A?null:$?T:""}re&&B&&hn(re.firstChild);for(var Zf=LA(oe?ye:re);Le=Zf.nextNode();)Le.nodeType===3&&Le===zt||FA(Le)||(Le.content instanceof i&&yce(Le.content),WA(Le),zt=Le);if(zt=null,oe)return ye;if(A){if(E)for(kt=F.call(re.ownerDocument);re.firstChild;)kt.appendChild(re.firstChild);else kt=re;return(k.shadowroot||k.shadowrootmod)&&(kt=le.call(r,kt,!0)),kt}var gt=b?re.outerHTML:re.innerHTML;return b&&w["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&It(CF,re.ownerDocument.doctype.name)&&(gt="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+gt),be&&(gt=mr(gt,C," "),gt=mr(gt,z," "),gt=mr(gt,fe," ")),R&&$?R.createHTML(gt):gt},t.setConfig=function(ye){Xt(ye),W=!0},t.clearConfig=function(){Be=null,W=!1},t.isValidAttribute=function(ye,M,re){Be||Xt({});var ce=_e(ye),Le=_e(M);return jA(ce,Le,re)},t.addHook=function(ye,M){typeof M=="function"&&(j[ye]=j[ye]||[],es(j[ye],M))},t.removeHook=function(ye){if(j[ye])return LS(j[ye])},t.removeHooks=function(ye){j[ye]&&(j[ye]=[])},t.removeAllHooks=function(){j={}},t}var RF=VS(),EF=we,kF=Kh,AF=Te,xF=tt,IF=$a.onFreeze,Mv=Object.freeze,PF=AF(function(){Mv(1)});EF({target:"Object",stat:!0,forced:PF,sham:!kF},{freeze:function(t){return Mv&&xF(t)?Mv(IF(t)):t}});var $F=we,MF=sd.codeAt;$F({target:"String",proto:!0},{codePointAt:function(t){return MF(this,t)}});var NF=Vn,DF=mt,HF=cr,LF=RangeError,zS=function(t){var r=DF(HF(this)),n="",i=NF(t);if(i<0||i==1/0)throw LF("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},US=Ee,FF=Ni,GS=mt,jF=zS,BF=cr,WF=US(jF),VF=US("".slice),zF=Math.ceil,YS=function(e){return function(t,r,n){var i=GS(BF(t)),o=FF(r),a=i.length,s=n===void 0?" ":GS(n),l,u;return o<=a||s==""?i:(l=o-a,u=WF(s,zF(l/s.length)),u.length>l&&(u=VF(u,0,l)),e?i+u:u+i)}},UF={start:YS(!1),end:YS(!0)},GF=Bn,YF=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(GF),KF=we,ZF=UF.start,qF=YF;KF({target:"String",proto:!0,forced:qF},{padStart:function(t){return ZF(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var KS;function ue(){return KS.apply(null,arguments)}function XF(e){KS=e}function yr(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function ri(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Me(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Nv(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Me(e,t))return!1;return!0}function jt(e){return e===void 0}function qr(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function ts(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function ZS(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function Cn(e,t){for(var r in t)Me(t,r)&&(e[r]=t[r]);return Me(t,"toString")&&(e.toString=t.toString),Me(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Pr(e,t,r,n){return __(e,t,r,n,!0).utc()}function QF(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Re(e){return e._pf==null&&(e._pf=QF()),e._pf}var Dv;Array.prototype.some?Dv=Array.prototype.some:Dv=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Hv(e){if(e._isValid==null){var t=Re(e),r=Dv.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function zu(e){var t=Pr(NaN);return e!=null?Cn(Re(t),e):Re(t).userInvalidated=!0,t}var qS=ue.momentProperties=[],Lv=!1;function Fv(e,t){var r,n,i,o=qS.length;if(jt(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),jt(t._i)||(e._i=t._i),jt(t._f)||(e._f=t._f),jt(t._l)||(e._l=t._l),jt(t._strict)||(e._strict=t._strict),jt(t._tzm)||(e._tzm=t._tzm),jt(t._isUTC)||(e._isUTC=t._isUTC),jt(t._offset)||(e._offset=t._offset),jt(t._pf)||(e._pf=Re(t)),jt(t._locale)||(e._locale=t._locale),o>0)for(r=0;r<o;r++)n=qS[r],i=t[n],jt(i)||(e[n]=i);return e}function rs(e){Fv(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Lv===!1&&(Lv=!0,ue.updateOffset(this),Lv=!1)}function pr(e){return e instanceof rs||e!=null&&e._isAMomentObject!=null}function XS(e){ue.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function nr(e,t){var r=!0;return Cn(function(){if(ue.deprecationHandler!=null&&ue.deprecationHandler(null,e),r){var n=[],i,o,a,s=arguments.length;for(o=0;o<s;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(a in arguments[0])Me(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}XS(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var QS={};function JS(e,t){ue.deprecationHandler!=null&&ue.deprecationHandler(e,t),QS[e]||(XS(t),QS[e]=!0)}ue.suppressDeprecationWarnings=!1,ue.deprecationHandler=null;function $r(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function JF(e){var t,r;for(r in e)Me(e,r)&&(t=e[r],$r(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function jv(e,t){var r=Cn({},e),n;for(n in t)Me(t,n)&&(ri(e[n])&&ri(t[n])?(r[n]={},Cn(r[n],e[n]),Cn(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Me(e,n)&&!Me(t,n)&&ri(e[n])&&(r[n]=Cn({},r[n]));return r}function Bv(e){e!=null&&this.set(e)}var Wv;Object.keys?Wv=Object.keys:Wv=function(e){var t,r=[];for(t in e)Me(e,t)&&r.push(t);return r};var ej={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function tj(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return $r(n)?n.call(t,r):n}function Mr(e,t,r){var n=""+Math.abs(e),i=t-n.length,o=e>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var Vv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Uu=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,zv={},Qi={};function pe(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Qi[e]=i),t&&(Qi[t[0]]=function(){return Mr(i.apply(this,arguments),t[1],t[2])}),r&&(Qi[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function rj(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function nj(e){var t=e.match(Vv),r,n;for(r=0,n=t.length;r<n;r++)Qi[t[r]]?t[r]=Qi[t[r]]:t[r]=rj(t[r]);return function(i){var o="",a;for(a=0;a<n;a++)o+=$r(t[a])?t[a].call(i,e):t[a];return o}}function Gu(e,t){return e.isValid()?(t=e_(t,e.localeData()),zv[t]=zv[t]||nj(t),zv[t](e)):e.localeData().invalidDate()}function e_(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(Uu.lastIndex=0;r>=0&&Uu.test(e);)e=e.replace(Uu,n),Uu.lastIndex=0,r-=1;return e}var ij={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function oj(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Vv).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var aj="Invalid date";function sj(){return this._invalidDate}var lj="%d",uj=/\d{1,2}/;function cj(e){return this._ordinal.replace("%d",e)}var fj={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function hj(e,t,r,n){var i=this._relativeTime[r];return $r(i)?i(e,t,r,n):i.replace(/%d/i,e)}function dj(e,t){var r=this._relativeTime[e>0?"future":"past"];return $r(r)?r(t):r.replace(/%s/i,t)}var ns={};function Ct(e,t){var r=e.toLowerCase();ns[r]=ns[r+"s"]=ns[t]=e}function ir(e){return typeof e=="string"?ns[e]||ns[e.toLowerCase()]:void 0}function Uv(e){var t={},r,n;for(n in e)Me(e,n)&&(r=ir(n),r&&(t[r]=e[n]));return t}var t_={};function Ot(e,t){t_[e]=t}function vj(e){var t=[],r;for(r in e)Me(e,r)&&t.push({unit:r,priority:t_[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function Yu(e){return e%4===0&&e%100!==0||e%400===0}function or(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function xe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=or(t)),r}function Ji(e,t){return function(r){return r!=null?(r_(this,e,r),ue.updateOffset(this,t),this):Ku(this,e)}}function Ku(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function r_(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Yu(e.year())&&e.month()===1&&e.date()===29?(r=xe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),tc(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function mj(e){return e=ir(e),$r(this[e])?this[e]():this}function yj(e,t){if(typeof e=="object"){e=Uv(e);var r=vj(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=ir(e),$r(this[e]))return this[e](t);return this}var n_=/\d/,Yt=/\d\d/,i_=/\d{3}/,Gv=/\d{4}/,Zu=/[+-]?\d{6}/,Ue=/\d\d?/,o_=/\d\d\d\d?/,a_=/\d\d\d\d\d\d?/,qu=/\d{1,3}/,Yv=/\d{1,4}/,Xu=/[+-]?\d{1,6}/,eo=/\d+/,Qu=/[+-]?\d+/,pj=/Z|[+-]\d\d:?\d\d/gi,Ju=/Z|[+-]\d\d(?::?\d\d)?/gi,gj=/[+-]?\d+(\.\d{1,3})?/,is=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ec;ec={};function he(e,t,r){ec[e]=$r(t)?t:function(n,i){return n&&r?r:t}}function bj(e,t){return Me(ec,e)?ec[e](t._strict,t._locale):new RegExp(wj(e))}function wj(e){return Kt(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,o){return r||n||i||o}))}function Kt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Kv={};function je(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),qr(t)&&(n=function(o,a){a[t]=xe(o)}),i=e.length,r=0;r<i;r++)Kv[e[r]]=n}function os(e,t){je(e,function(r,n,i,o){i._w=i._w||{},t(r,i._w,i,o)})}function Sj(e,t,r){t!=null&&Me(Kv,e)&&Kv[e](t,r._a,r,e)}var Tt=0,Xr=1,Nr=2,ft=3,gr=4,Qr=5,ni=6,_j=7,Cj=8;function Oj(e,t){return(e%t+t)%t}var ot;Array.prototype.indexOf?ot=Array.prototype.indexOf:ot=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function tc(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=Oj(t,12);return e+=(t-r)/12,r===1?Yu(e)?29:28:31-r%7%2}pe("M",["MM",2],"Mo",function(){return this.month()+1}),pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),pe("MMMM",0,0,function(e){return this.localeData().months(this,e)}),Ct("month","M"),Ot("month",8),he("M",Ue),he("MM",Ue,Yt),he("MMM",function(e,t){return t.monthsShortRegex(e)}),he("MMMM",function(e,t){return t.monthsRegex(e)}),je(["M","MM"],function(e,t){t[Xr]=xe(e)-1}),je(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[Xr]=i:Re(r).invalidMonth=e});var Tj="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),s_="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),l_=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Rj=is,Ej=is;function kj(e,t){return e?yr(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||l_).test(t)?"format":"standalone"][e.month()]:yr(this._months)?this._months:this._months.standalone}function Aj(e,t){return e?yr(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[l_.test(t)?"format":"standalone"][e.month()]:yr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function xj(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Pr([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?t==="MMM"?(i=ot.call(this._shortMonthsParse,a),i!==-1?i:null):(i=ot.call(this._longMonthsParse,a),i!==-1?i:null):t==="MMM"?(i=ot.call(this._shortMonthsParse,a),i!==-1?i:(i=ot.call(this._longMonthsParse,a),i!==-1?i:null)):(i=ot.call(this._longMonthsParse,a),i!==-1?i:(i=ot.call(this._shortMonthsParse,a),i!==-1?i:null))}function Ij(e,t,r){var n,i,o;if(this._monthsParseExact)return xj.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Pr([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function u_(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=xe(t);else if(t=e.localeData().monthsParse(t),!qr(t))return e}return r=Math.min(e.date(),tc(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function c_(e){return e!=null?(u_(this,e),ue.updateOffset(this,!0),this):Ku(this,"Month")}function Pj(){return tc(this.year(),this.month())}function $j(e){return this._monthsParseExact?(Me(this,"_monthsRegex")||f_.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Me(this,"_monthsShortRegex")||(this._monthsShortRegex=Rj),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Mj(e){return this._monthsParseExact?(Me(this,"_monthsRegex")||f_.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Me(this,"_monthsRegex")||(this._monthsRegex=Ej),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function f_(){function e(a,s){return s.length-a.length}var t=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=Pr([2e3,i]),t.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Kt(t[i]),r[i]=Kt(r[i]);for(i=0;i<24;i++)n[i]=Kt(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}pe("Y",0,0,function(){var e=this.year();return e<=9999?Mr(e,4):"+"+e}),pe(0,["YY",2],0,function(){return this.year()%100}),pe(0,["YYYY",4],0,"year"),pe(0,["YYYYY",5],0,"year"),pe(0,["YYYYYY",6,!0],0,"year"),Ct("year","y"),Ot("year",1),he("Y",Qu),he("YY",Ue,Yt),he("YYYY",Yv,Gv),he("YYYYY",Xu,Zu),he("YYYYYY",Xu,Zu),je(["YYYYY","YYYYYY"],Tt),je("YYYY",function(e,t){t[Tt]=e.length===2?ue.parseTwoDigitYear(e):xe(e)}),je("YY",function(e,t){t[Tt]=ue.parseTwoDigitYear(e)}),je("Y",function(e,t){t[Tt]=parseInt(e,10)});function as(e){return Yu(e)?366:365}ue.parseTwoDigitYear=function(e){return xe(e)+(xe(e)>68?1900:2e3)};var h_=Ji("FullYear",!0);function Nj(){return Yu(this.year())}function Dj(e,t,r,n,i,o,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,o,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,o,a),s}function ss(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function rc(e,t,r){var n=7+t-r,i=(7+ss(e,0,n).getUTCDay()-t)%7;return-i+n-1}function d_(e,t,r,n,i){var o=(7+r-n)%7,a=rc(e,n,i),s=1+7*(t-1)+o+a,l,u;return s<=0?(l=e-1,u=as(l)+s):s>as(e)?(l=e+1,u=s-as(e)):(l=e,u=s),{year:l,dayOfYear:u}}function ls(e,t,r){var n=rc(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,o,a;return i<1?(a=e.year()-1,o=i+Jr(a,t,r)):i>Jr(e.year(),t,r)?(o=i-Jr(e.year(),t,r),a=e.year()+1):(a=e.year(),o=i),{week:o,year:a}}function Jr(e,t,r){var n=rc(e,t,r),i=rc(e+1,t,r);return(as(e)-n+i)/7}pe("w",["ww",2],"wo","week"),pe("W",["WW",2],"Wo","isoWeek"),Ct("week","w"),Ct("isoWeek","W"),Ot("week",5),Ot("isoWeek",5),he("w",Ue),he("ww",Ue,Yt),he("W",Ue),he("WW",Ue,Yt),os(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=xe(e)});function Hj(e){return ls(e,this._week.dow,this._week.doy).week}var Lj={dow:0,doy:6};function Fj(){return this._week.dow}function jj(){return this._week.doy}function Bj(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Wj(e){var t=ls(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}pe("d",0,"do","day"),pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),pe("e",0,0,"weekday"),pe("E",0,0,"isoWeekday"),Ct("day","d"),Ct("weekday","e"),Ct("isoWeekday","E"),Ot("day",11),Ot("weekday",11),Ot("isoWeekday",11),he("d",Ue),he("e",Ue),he("E",Ue),he("dd",function(e,t){return t.weekdaysMinRegex(e)}),he("ddd",function(e,t){return t.weekdaysShortRegex(e)}),he("dddd",function(e,t){return t.weekdaysRegex(e)}),os(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:Re(r).invalidWeekday=e}),os(["d","e","E"],function(e,t,r,n){t[n]=xe(e)});function Vj(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function zj(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Zv(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Uj="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),v_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Gj="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Yj=is,Kj=is,Zj=is;function qj(e,t){var r=yr(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Zv(r,this._week.dow):e?r[e.day()]:r}function Xj(e){return e===!0?Zv(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Qj(e){return e===!0?Zv(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Jj(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Pr([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?t==="dddd"?(i=ot.call(this._weekdaysParse,a),i!==-1?i:null):t==="ddd"?(i=ot.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=ot.call(this._minWeekdaysParse,a),i!==-1?i:null):t==="dddd"?(i=ot.call(this._weekdaysParse,a),i!==-1||(i=ot.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=ot.call(this._minWeekdaysParse,a),i!==-1?i:null)):t==="ddd"?(i=ot.call(this._shortWeekdaysParse,a),i!==-1||(i=ot.call(this._weekdaysParse,a),i!==-1)?i:(i=ot.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=ot.call(this._minWeekdaysParse,a),i!==-1||(i=ot.call(this._weekdaysParse,a),i!==-1)?i:(i=ot.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function eB(e,t,r){var n,i,o;if(this._weekdaysParseExact)return Jj.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Pr([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function tB(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Vj(e,this.localeData()),this.add(e-t,"d")):t}function rB(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function nB(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=zj(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function iB(e){return this._weekdaysParseExact?(Me(this,"_weekdaysRegex")||qv.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Me(this,"_weekdaysRegex")||(this._weekdaysRegex=Yj),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function oB(e){return this._weekdaysParseExact?(Me(this,"_weekdaysRegex")||qv.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Me(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Kj),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function aB(e){return this._weekdaysParseExact?(Me(this,"_weekdaysRegex")||qv.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Me(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Zj),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qv(){function e(c,h){return h.length-c.length}var t=[],r=[],n=[],i=[],o,a,s,l,u;for(o=0;o<7;o++)a=Pr([2e3,1]).day(o),s=Kt(this.weekdaysMin(a,"")),l=Kt(this.weekdaysShort(a,"")),u=Kt(this.weekdays(a,"")),t.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Xv(){return this.hours()%12||12}function sB(){return this.hours()||24}pe("H",["HH",2],0,"hour"),pe("h",["hh",2],0,Xv),pe("k",["kk",2],0,sB),pe("hmm",0,0,function(){return""+Xv.apply(this)+Mr(this.minutes(),2)}),pe("hmmss",0,0,function(){return""+Xv.apply(this)+Mr(this.minutes(),2)+Mr(this.seconds(),2)}),pe("Hmm",0,0,function(){return""+this.hours()+Mr(this.minutes(),2)}),pe("Hmmss",0,0,function(){return""+this.hours()+Mr(this.minutes(),2)+Mr(this.seconds(),2)});function m_(e,t){pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}m_("a",!0),m_("A",!1),Ct("hour","h"),Ot("hour",13);function y_(e,t){return t._meridiemParse}he("a",y_),he("A",y_),he("H",Ue),he("h",Ue),he("k",Ue),he("HH",Ue,Yt),he("hh",Ue,Yt),he("kk",Ue,Yt),he("hmm",o_),he("hmmss",a_),he("Hmm",o_),he("Hmmss",a_),je(["H","HH"],ft),je(["k","kk"],function(e,t,r){var n=xe(e);t[ft]=n===24?0:n}),je(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e}),je(["h","hh"],function(e,t,r){t[ft]=xe(e),Re(r).bigHour=!0}),je("hmm",function(e,t,r){var n=e.length-2;t[ft]=xe(e.substr(0,n)),t[gr]=xe(e.substr(n)),Re(r).bigHour=!0}),je("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[ft]=xe(e.substr(0,n)),t[gr]=xe(e.substr(n,2)),t[Qr]=xe(e.substr(i)),Re(r).bigHour=!0}),je("Hmm",function(e,t,r){var n=e.length-2;t[ft]=xe(e.substr(0,n)),t[gr]=xe(e.substr(n))}),je("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[ft]=xe(e.substr(0,n)),t[gr]=xe(e.substr(n,2)),t[Qr]=xe(e.substr(i))});function lB(e){return(e+"").toLowerCase().charAt(0)==="p"}var uB=/[ap]\.?m?\.?/i,cB=Ji("Hours",!0);function fB(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var p_={calendar:ej,longDateFormat:ij,invalidDate:aj,ordinal:lj,dayOfMonthOrdinalParse:uj,relativeTime:fj,months:Tj,monthsShort:s_,week:Lj,weekdays:Uj,weekdaysMin:Gj,weekdaysShort:v_,meridiemParse:uB},Ze={},us={},cs;function hB(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function g_(e){return e&&e.toLowerCase().replace("_","-")}function dB(e){for(var t=0,r,n,i,o;t<e.length;){for(o=g_(e[t]).split("-"),r=o.length,n=g_(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=nc(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&hB(o,n)>=r-1)break;r--}t++}return cs}function vB(e){return e.match("^[^/\\\\]*$")!=null}function nc(e){var t=null,r;if(Ze[e]===void 0&&typeof module<"u"&&module&&module.exports&&vB(e))try{t=cs._abbr,r=require,r("./locale/"+e),On(t)}catch{Ze[e]=null}return Ze[e]}function On(e,t){var r;return e&&(jt(t)?r=en(e):r=Qv(e,t),r?cs=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),cs._abbr}function Qv(e,t){if(t!==null){var r,n=p_;if(t.abbr=e,Ze[e]!=null)JS("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ze[e]._config;else if(t.parentLocale!=null)if(Ze[t.parentLocale]!=null)n=Ze[t.parentLocale]._config;else if(r=nc(t.parentLocale),r!=null)n=r._config;else return us[t.parentLocale]||(us[t.parentLocale]=[]),us[t.parentLocale].push({name:e,config:t}),null;return Ze[e]=new Bv(jv(n,t)),us[e]&&us[e].forEach(function(i){Qv(i.name,i.config)}),On(e),Ze[e]}else return delete Ze[e],null}function mB(e,t){if(t!=null){var r,n,i=p_;Ze[e]!=null&&Ze[e].parentLocale!=null?Ze[e].set(jv(Ze[e]._config,t)):(n=nc(e),n!=null&&(i=n._config),t=jv(i,t),n==null&&(t.abbr=e),r=new Bv(t),r.parentLocale=Ze[e],Ze[e]=r),On(e)}else Ze[e]!=null&&(Ze[e].parentLocale!=null?(Ze[e]=Ze[e].parentLocale,e===On()&&On(e)):Ze[e]!=null&&delete Ze[e]);return Ze[e]}function en(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return cs;if(!yr(e)){if(t=nc(e),t)return t;e=[e]}return dB(e)}function yB(){return Wv(Ze)}function Jv(e){var t,r=e._a;return r&&Re(e).overflow===-2&&(t=r[Xr]<0||r[Xr]>11?Xr:r[Nr]<1||r[Nr]>tc(r[Tt],r[Xr])?Nr:r[ft]<0||r[ft]>24||r[ft]===24&&(r[gr]!==0||r[Qr]!==0||r[ni]!==0)?ft:r[gr]<0||r[gr]>59?gr:r[Qr]<0||r[Qr]>59?Qr:r[ni]<0||r[ni]>999?ni:-1,Re(e)._overflowDayOfYear&&(t<Tt||t>Nr)&&(t=Nr),Re(e)._overflowWeeks&&t===-1&&(t=_j),Re(e)._overflowWeekday&&t===-1&&(t=Cj),Re(e).overflow=t),e}var pB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bB=/Z|[+-]\d\d(?::?\d\d)?/,ic=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],em=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wB=/^\/?Date\((-?\d+)/i,SB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_B={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function b_(e){var t,r,n=e._i,i=pB.exec(n)||gB.exec(n),o,a,s,l,u=ic.length,c=em.length;if(i){for(Re(e).iso=!0,t=0,r=u;t<r;t++)if(ic[t][1].exec(i[1])){a=ic[t][0],o=ic[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(i[3]){for(t=0,r=c;t<r;t++)if(em[t][1].exec(i[3])){s=(i[2]||" ")+em[t][0];break}if(s==null){e._isValid=!1;return}}if(!o&&s!=null){e._isValid=!1;return}if(i[4])if(bB.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=a+(s||"")+(l||""),rm(e)}else e._isValid=!1}function CB(e,t,r,n,i,o){var a=[OB(e),s_.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function OB(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function TB(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function RB(e,t,r){if(e){var n=v_.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return Re(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function EB(e,t,r){if(e)return _B[e];if(t)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function w_(e){var t=SB.exec(TB(e._i)),r;if(t){if(r=CB(t[4],t[3],t[2],t[5],t[6],t[7]),!RB(t[1],r,e))return;e._a=r,e._tzm=EB(t[8],t[9],t[10]),e._d=ss.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Re(e).rfc2822=!0}else e._isValid=!1}function kB(e){var t=wB.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(b_(e),e._isValid===!1)delete e._isValid;else return;if(w_(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ue.createFromInputFallback(e)}ue.createFromInputFallback=nr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function to(e,t,r){return e??t??r}function AB(e){var t=new Date(ue.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function tm(e){var t,r,n=[],i,o,a;if(!e._d){for(i=AB(e),e._w&&e._a[Nr]==null&&e._a[Xr]==null&&xB(e),e._dayOfYear!=null&&(a=to(e._a[Tt],i[Tt]),(e._dayOfYear>as(a)||e._dayOfYear===0)&&(Re(e)._overflowDayOfYear=!0),r=ss(a,0,e._dayOfYear),e._a[Xr]=r.getUTCMonth(),e._a[Nr]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[ft]===24&&e._a[gr]===0&&e._a[Qr]===0&&e._a[ni]===0&&(e._nextDay=!0,e._a[ft]=0),e._d=(e._useUTC?ss:Dj).apply(null,n),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ft]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==o&&(Re(e).weekdayMismatch=!0)}}function xB(e){var t,r,n,i,o,a,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(o=1,a=4,r=to(t.GG,e._a[Tt],ls(Ge(),1,4).year),n=to(t.W,1),i=to(t.E,1),(i<1||i>7)&&(l=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,u=ls(Ge(),o,a),r=to(t.gg,e._a[Tt],u.year),n=to(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(l=!0)):t.e!=null?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),n<1||n>Jr(r,o,a)?Re(e)._overflowWeeks=!0:l!=null?Re(e)._overflowWeekday=!0:(s=d_(r,n,i,o,a),e._a[Tt]=s.year,e._dayOfYear=s.dayOfYear)}ue.ISO_8601=function(){},ue.RFC_2822=function(){};function rm(e){if(e._f===ue.ISO_8601){b_(e);return}if(e._f===ue.RFC_2822){w_(e);return}e._a=[],Re(e).empty=!0;var t=""+e._i,r,n,i,o,a,s=t.length,l=0,u,c;for(i=e_(e._f,e._locale).match(Vv)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(t.match(bj(o,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Re(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),l+=n.length),Qi[o]?(n?Re(e).empty=!1:Re(e).unusedTokens.push(o),Sj(o,n,e)):e._strict&&!n&&Re(e).unusedTokens.push(o);Re(e).charsLeftOver=s-l,t.length>0&&Re(e).unusedInput.push(t),e._a[ft]<=12&&Re(e).bigHour===!0&&e._a[ft]>0&&(Re(e).bigHour=void 0),Re(e).parsedDateParts=e._a.slice(0),Re(e).meridiem=e._meridiem,e._a[ft]=IB(e._locale,e._a[ft],e._meridiem),u=Re(e).era,u!==null&&(e._a[Tt]=e._locale.erasConvertYear(u,e._a[Tt])),tm(e),Jv(e)}function IB(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function PB(e){var t,r,n,i,o,a,s=!1,l=e._f.length;if(l===0){Re(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,a=!1,t=Fv({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],rm(t),Hv(t)&&(a=!0),o+=Re(t).charsLeftOver,o+=Re(t).unusedTokens.length*10,Re(t).score=o,s?o<n&&(n=o,r=t):(n==null||o<n||a)&&(n=o,r=t,a&&(s=!0));Cn(e,r||t)}function $B(e){if(!e._d){var t=Uv(e._i),r=t.day===void 0?t.date:t.day;e._a=ZS([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),tm(e)}}function MB(e){var t=new rs(Jv(S_(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function S_(e){var t=e._i,r=e._f;return e._locale=e._locale||en(e._l),t===null||r===void 0&&t===""?zu({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),pr(t)?new rs(Jv(t)):(ts(t)?e._d=t:yr(r)?PB(e):r?rm(e):NB(e),Hv(e)||(e._d=null),e))}function NB(e){var t=e._i;jt(t)?e._d=new Date(ue.now()):ts(t)?e._d=new Date(t.valueOf()):typeof t=="string"?kB(e):yr(t)?(e._a=ZS(t.slice(0),function(r){return parseInt(r,10)}),tm(e)):ri(t)?$B(e):qr(t)?e._d=new Date(t):ue.createFromInputFallback(e)}function __(e,t,r,n,i){var o={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(ri(e)&&Nv(e)||yr(e)&&e.length===0)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,MB(o)}function Ge(e,t,r,n){return __(e,t,r,n,!1)}var DB=nr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ge.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:zu()}),HB=nr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ge.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:zu()});function C_(e,t){var r,n;if(t.length===1&&yr(t[0])&&(t=t[0]),!t.length)return Ge();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function LB(){var e=[].slice.call(arguments,0);return C_("isBefore",e)}function FB(){var e=[].slice.call(arguments,0);return C_("isAfter",e)}var jB=function(){return Date.now?Date.now():+new Date},fs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function BB(e){var t,r=!1,n,i=fs.length;for(t in e)if(Me(e,t)&&!(ot.call(fs,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[fs[n]]){if(r)return!1;parseFloat(e[fs[n]])!==xe(e[fs[n]])&&(r=!0)}return!0}function WB(){return this._isValid}function VB(){return br(NaN)}function oc(e){var t=Uv(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=BB(t),this._milliseconds=+c+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=en(),this._bubble()}function ac(e){return e instanceof oc}function nm(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function zB(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&xe(e[a])!==xe(t[a]))&&o++;return o+i}function O_(e,t){pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Mr(~~(r/60),2)+t+Mr(~~r%60,2)})}O_("Z",":"),O_("ZZ",""),he("Z",Ju),he("ZZ",Ju),je(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=im(Ju,e)});var UB=/([\+\-]|\d\d)/gi;function im(e,t){var r=(t||"").match(e),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(UB)||["-",0,0],o=+(i[1]*60)+xe(i[2]),o===0?0:i[0]==="+"?o:-o)}function om(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(pr(e)||ts(e)?e.valueOf():Ge(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ue.updateOffset(r,!1),r):Ge(e).local()}function am(e){return-Math.round(e._d.getTimezoneOffset())}ue.updateOffset=function(){};function GB(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=im(Ju,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=am(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?k_(this,br(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ue.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:am(this)}function YB(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function KB(e){return this.utcOffset(0,e)}function ZB(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(am(this),"m")),this}function qB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=im(pj,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function XB(e){return this.isValid()?(e=e?Ge(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function QB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function JB(){if(!jt(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Fv(e,this),e=S_(e),e._a?(t=e._isUTC?Pr(e._a):Ge(e._a),this._isDSTShifted=this.isValid()&&zB(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function eW(){return this.isValid()?!this._isUTC:!1}function tW(){return this.isValid()?this._isUTC:!1}function T_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var rW=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,nW=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function br(e,t){var r=e,n=null,i,o,a;return ac(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:qr(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=rW.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:xe(n[Nr])*i,h:xe(n[ft])*i,m:xe(n[gr])*i,s:xe(n[Qr])*i,ms:xe(nm(n[ni]*1e3))*i}):(n=nW.exec(e))?(i=n[1]==="-"?-1:1,r={y:ii(n[2],i),M:ii(n[3],i),w:ii(n[4],i),d:ii(n[5],i),h:ii(n[6],i),m:ii(n[7],i),s:ii(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=iW(Ge(r.from),Ge(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),o=new oc(r),ac(e)&&Me(e,"_locale")&&(o._locale=e._locale),ac(e)&&Me(e,"_isValid")&&(o._isValid=e._isValid),o}br.fn=oc.prototype,br.invalid=VB;function ii(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function R_(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function iW(e,t){var r;return e.isValid()&&t.isValid()?(t=om(t,e),e.isBefore(t)?r=R_(e,t):(r=R_(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function E_(e,t){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(JS(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=br(r,n),k_(this,i,e),this}}function k_(e,t,r,n){var i=t._milliseconds,o=nm(t._days),a=nm(t._months);e.isValid()&&(n=n??!0,a&&u_(e,Ku(e,"Month")+a*r),o&&r_(e,"Date",Ku(e,"Date")+o*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&ue.updateOffset(e,o||a))}var oW=E_(1,"add"),aW=E_(-1,"subtract");function A_(e){return typeof e=="string"||e instanceof String}function sW(e){return pr(e)||ts(e)||A_(e)||qr(e)||uW(e)||lW(e)||e===null||e===void 0}function lW(e){var t=ri(e)&&!Nv(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,a=n.length;for(i=0;i<a;i+=1)o=n[i],r=r||Me(e,o);return t&&r}function uW(e){var t=yr(e),r=!1;return t&&(r=e.filter(function(n){return!qr(n)&&A_(e)}).length===0),t&&r}function cW(e){var t=ri(e)&&!Nv(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Me(e,o);return t&&r}function fW(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function hW(e,t){arguments.length===1&&(arguments[0]?sW(arguments[0])?(e=arguments[0],t=void 0):cW(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ge(),n=om(r,this).startOf("day"),i=ue.calendarFormat(this,n)||"sameElse",o=t&&($r(t[i])?t[i].call(this,r):t[i]);return this.format(o||this.localeData().calendar(i,this,Ge(r)))}function dW(){return new rs(this)}function vW(e,t){var r=pr(e)?e:Ge(e);return this.isValid()&&r.isValid()?(t=ir(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function mW(e,t){var r=pr(e)?e:Ge(e);return this.isValid()&&r.isValid()?(t=ir(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function yW(e,t,r,n){var i=pr(e)?e:Ge(e),o=pr(t)?t:Ge(t);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function pW(e,t){var r=pr(e)?e:Ge(e),n;return this.isValid()&&r.isValid()?(t=ir(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function gW(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function bW(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function wW(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(n=om(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=ir(t),t){case"year":o=sc(this,n)/12;break;case"month":o=sc(this,n);break;case"quarter":o=sc(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:or(o)}function sc(e,t){if(e.date()<t.date())return-sc(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,o;return t-n<0?(i=e.clone().add(r-1,"months"),o=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),o=(t-n)/(i-n)),-(r+o)||0}ue.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",ue.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function SW(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _W(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Gu(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):$r(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Gu(r,"Z")):Gu(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function CW(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,o;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]',this.format(r+n+i+o)}function OW(e){e||(e=this.isUtc()?ue.defaultFormatUtc:ue.defaultFormat);var t=Gu(this,e);return this.localeData().postformat(t)}function TW(e,t){return this.isValid()&&(pr(e)&&e.isValid()||Ge(e).isValid())?br({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function RW(e){return this.from(Ge(),e)}function EW(e,t){return this.isValid()&&(pr(e)&&e.isValid()||Ge(e).isValid())?br({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function kW(e){return this.to(Ge(),e)}function x_(e){var t;return e===void 0?this._locale._abbr:(t=en(e),t!=null&&(this._locale=t),this)}var I_=nr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function P_(){return this._locale}var lc=1e3,ro=60*lc,uc=60*ro,$_=(365*400+97)*24*uc;function no(e,t){return(e%t+t)%t}function M_(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-$_:new Date(e,t,r).valueOf()}function N_(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-$_:Date.UTC(e,t,r)}function AW(e){var t,r;if(e=ir(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?N_:M_,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=no(t+(this._isUTC?0:this.utcOffset()*ro),uc);break;case"minute":t=this._d.valueOf(),t-=no(t,ro);break;case"second":t=this._d.valueOf(),t-=no(t,lc);break}return this._d.setTime(t),ue.updateOffset(this,!0),this}function xW(e){var t,r;if(e=ir(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?N_:M_,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=uc-no(t+(this._isUTC?0:this.utcOffset()*ro),uc)-1;break;case"minute":t=this._d.valueOf(),t+=ro-no(t,ro)-1;break;case"second":t=this._d.valueOf(),t+=lc-no(t,lc)-1;break}return this._d.setTime(t),ue.updateOffset(this,!0),this}function IW(){return this._d.valueOf()-(this._offset||0)*6e4}function PW(){return Math.floor(this.valueOf()/1e3)}function $W(){return new Date(this.valueOf())}function MW(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function NW(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function DW(){return this.isValid()?this.toISOString():null}function HW(){return Hv(this)}function LW(){return Cn({},Re(this))}function FW(){return Re(this).overflow}function jW(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}pe("N",0,0,"eraAbbr"),pe("NN",0,0,"eraAbbr"),pe("NNN",0,0,"eraAbbr"),pe("NNNN",0,0,"eraName"),pe("NNNNN",0,0,"eraNarrow"),pe("y",["y",1],"yo","eraYear"),pe("y",["yy",2],0,"eraYear"),pe("y",["yyy",3],0,"eraYear"),pe("y",["yyyy",4],0,"eraYear"),he("N",sm),he("NN",sm),he("NNN",sm),he("NNNN",XW),he("NNNNN",QW),je(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?Re(r).era=i:Re(r).invalidEra=e}),he("y",eo),he("yy",eo),he("yyy",eo),he("yyyy",eo),he("yo",JW),je(["y","yy","yyy","yyyy"],Tt),je(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Tt]=r._locale.eraYearOrdinalParse(e,i):t[Tt]=parseInt(e,10)});function BW(e,t){var r,n,i,o=this._eras||en("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=ue(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=ue(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function WW(e,t,r){var n,i,o=this.eras(),a,s,l;for(e=e.toUpperCase(),n=0,i=o.length;n<i;++n)if(a=o[n].name.toUpperCase(),s=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return o[n];break;case"NNNN":if(a===e)return o[n];break;case"NNNNN":if(l===e)return o[n];break}else if([a,s,l].indexOf(e)>=0)return o[n]}function VW(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ue(e.since).year():ue(e.since).year()+(t-e.offset)*r}function zW(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function UW(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function GW(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function YW(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-ue(i[e].since).year())*r+i[e].offset;return this.year()}function KW(e){return Me(this,"_erasNameRegex")||lm.call(this),e?this._erasNameRegex:this._erasRegex}function ZW(e){return Me(this,"_erasAbbrRegex")||lm.call(this),e?this._erasAbbrRegex:this._erasRegex}function qW(e){return Me(this,"_erasNarrowRegex")||lm.call(this),e?this._erasNarrowRegex:this._erasRegex}function sm(e,t){return t.erasAbbrRegex(e)}function XW(e,t){return t.erasNameRegex(e)}function QW(e,t){return t.erasNarrowRegex(e)}function JW(e,t){return t._eraYearOrdinalRegex||eo}function lm(){var e=[],t=[],r=[],n=[],i,o,a=this.eras();for(i=0,o=a.length;i<o;++i)t.push(Kt(a[i].name)),e.push(Kt(a[i].abbr)),r.push(Kt(a[i].narrow)),n.push(Kt(a[i].name)),n.push(Kt(a[i].abbr)),n.push(Kt(a[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}pe(0,["gg",2],0,function(){return this.weekYear()%100}),pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function cc(e,t){pe(0,[e,e.length],0,t)}cc("gggg","weekYear"),cc("ggggg","weekYear"),cc("GGGG","isoWeekYear"),cc("GGGGG","isoWeekYear"),Ct("weekYear","gg"),Ct("isoWeekYear","GG"),Ot("weekYear",1),Ot("isoWeekYear",1),he("G",Qu),he("g",Qu),he("GG",Ue,Yt),he("gg",Ue,Yt),he("GGGG",Yv,Gv),he("gggg",Yv,Gv),he("GGGGG",Xu,Zu),he("ggggg",Xu,Zu),os(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=xe(e)}),os(["gg","GG"],function(e,t,r,n){t[n]=ue.parseTwoDigitYear(e)});function eV(e){return D_.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function tV(e){return D_.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function rV(){return Jr(this.year(),1,4)}function nV(){return Jr(this.isoWeekYear(),1,4)}function iV(){var e=this.localeData()._week;return Jr(this.year(),e.dow,e.doy)}function oV(){var e=this.localeData()._week;return Jr(this.weekYear(),e.dow,e.doy)}function D_(e,t,r,n,i){var o;return e==null?ls(this,n,i).year:(o=Jr(e,n,i),t>o&&(t=o),aV.call(this,e,t,r,n,i))}function aV(e,t,r,n,i){var o=d_(e,t,r,n,i),a=ss(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}pe("Q",0,"Qo","quarter"),Ct("quarter","Q"),Ot("quarter",7),he("Q",n_),je("Q",function(e,t){t[Xr]=(xe(e)-1)*3});function sV(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}pe("D",["DD",2],"Do","date"),Ct("date","D"),Ot("date",9),he("D",Ue),he("DD",Ue,Yt),he("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),je(["D","DD"],Nr),je("Do",function(e,t){t[Nr]=xe(e.match(Ue)[0])});var H_=Ji("Date",!0);pe("DDD",["DDDD",3],"DDDo","dayOfYear"),Ct("dayOfYear","DDD"),Ot("dayOfYear",4),he("DDD",qu),he("DDDD",i_),je(["DDD","DDDD"],function(e,t,r){r._dayOfYear=xe(e)});function lV(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}pe("m",["mm",2],0,"minute"),Ct("minute","m"),Ot("minute",14),he("m",Ue),he("mm",Ue,Yt),je(["m","mm"],gr);var uV=Ji("Minutes",!1);pe("s",["ss",2],0,"second"),Ct("second","s"),Ot("second",15),he("s",Ue),he("ss",Ue,Yt),je(["s","ss"],Qr);var cV=Ji("Seconds",!1);pe("S",0,0,function(){return~~(this.millisecond()/100)}),pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),pe(0,["SSS",3],0,"millisecond"),pe(0,["SSSS",4],0,function(){return this.millisecond()*10}),pe(0,["SSSSS",5],0,function(){return this.millisecond()*100}),pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Ct("millisecond","ms"),Ot("millisecond",16),he("S",qu,n_),he("SS",qu,Yt),he("SSS",qu,i_);var Tn,L_;for(Tn="SSSS";Tn.length<=9;Tn+="S")he(Tn,eo);function fV(e,t){t[ni]=xe(("0."+e)*1e3)}for(Tn="S";Tn.length<=9;Tn+="S")je(Tn,fV);L_=Ji("Milliseconds",!1),pe("z",0,0,"zoneAbbr"),pe("zz",0,0,"zoneName");function hV(){return this._isUTC?"UTC":""}function dV(){return this._isUTC?"Coordinated Universal Time":""}var te=rs.prototype;te.add=oW,te.calendar=hW,te.clone=dW,te.diff=wW,te.endOf=xW,te.format=OW,te.from=TW,te.fromNow=RW,te.to=EW,te.toNow=kW,te.get=mj,te.invalidAt=FW,te.isAfter=vW,te.isBefore=mW,te.isBetween=yW,te.isSame=pW,te.isSameOrAfter=gW,te.isSameOrBefore=bW,te.isValid=HW,te.lang=I_,te.locale=x_,te.localeData=P_,te.max=HB,te.min=DB,te.parsingFlags=LW,te.set=yj,te.startOf=AW,te.subtract=aW,te.toArray=MW,te.toObject=NW,te.toDate=$W,te.toISOString=_W,te.inspect=CW,typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),te.toJSON=DW,te.toString=SW,te.unix=PW,te.valueOf=IW,te.creationData=jW,te.eraName=zW,te.eraNarrow=UW,te.eraAbbr=GW,te.eraYear=YW,te.year=h_,te.isLeapYear=Nj,te.weekYear=eV,te.isoWeekYear=tV,te.quarter=te.quarters=sV,te.month=c_,te.daysInMonth=Pj,te.week=te.weeks=Bj,te.isoWeek=te.isoWeeks=Wj,te.weeksInYear=iV,te.weeksInWeekYear=oV,te.isoWeeksInYear=rV,te.isoWeeksInISOWeekYear=nV,te.date=H_,te.day=te.days=tB,te.weekday=rB,te.isoWeekday=nB,te.dayOfYear=lV,te.hour=te.hours=cB,te.minute=te.minutes=uV,te.second=te.seconds=cV,te.millisecond=te.milliseconds=L_,te.utcOffset=GB,te.utc=KB,te.local=ZB,te.parseZone=qB,te.hasAlignedHourOffset=XB,te.isDST=QB,te.isLocal=eW,te.isUtcOffset=tW,te.isUtc=T_,te.isUTC=T_,te.zoneAbbr=hV,te.zoneName=dV,te.dates=nr("dates accessor is deprecated. Use date instead.",H_),te.months=nr("months accessor is deprecated. Use month instead",c_),te.years=nr("years accessor is deprecated. Use year instead",h_),te.zone=nr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",YB),te.isDSTShifted=nr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",JB);function vV(e){return Ge(e*1e3)}function mV(){return Ge.apply(null,arguments).parseZone()}function F_(e){return e}var Ne=Bv.prototype;Ne.calendar=tj,Ne.longDateFormat=oj,Ne.invalidDate=sj,Ne.ordinal=cj,Ne.preparse=F_,Ne.postformat=F_,Ne.relativeTime=hj,Ne.pastFuture=dj,Ne.set=JF,Ne.eras=BW,Ne.erasParse=WW,Ne.erasConvertYear=VW,Ne.erasAbbrRegex=ZW,Ne.erasNameRegex=KW,Ne.erasNarrowRegex=qW,Ne.months=kj,Ne.monthsShort=Aj,Ne.monthsParse=Ij,Ne.monthsRegex=Mj,Ne.monthsShortRegex=$j,Ne.week=Hj,Ne.firstDayOfYear=jj,Ne.firstDayOfWeek=Fj,Ne.weekdays=qj,Ne.weekdaysMin=Qj,Ne.weekdaysShort=Xj,Ne.weekdaysParse=eB,Ne.weekdaysRegex=iB,Ne.weekdaysShortRegex=oB,Ne.weekdaysMinRegex=aB,Ne.isPM=lB,Ne.meridiem=fB;function fc(e,t,r,n){var i=en(),o=Pr().set(n,t);return i[r](o,e)}function j_(e,t,r){if(qr(e)&&(t=e,e=void 0),e=e||"",t!=null)return fc(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=fc(e,n,r,"month");return i}function um(e,t,r,n){typeof e=="boolean"?(qr(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,qr(t)&&(r=t,t=void 0),t=t||"");var i=en(),o=e?i._week.dow:0,a,s=[];if(r!=null)return fc(t,(r+o)%7,n,"day");for(a=0;a<7;a++)s[a]=fc(t,(a+o)%7,n,"day");return s}function yV(e,t){return j_(e,t,"months")}function pV(e,t){return j_(e,t,"monthsShort")}function gV(e,t,r){return um(e,t,r,"weekdays")}function bV(e,t,r){return um(e,t,r,"weekdaysShort")}function wV(e,t,r){return um(e,t,r,"weekdaysMin")}On("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=xe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}}),ue.lang=nr("moment.lang is deprecated. Use moment.locale instead.",On),ue.langData=nr("moment.langData is deprecated. Use moment.localeData instead.",en);var tn=Math.abs;function SV(){var e=this._data;return this._milliseconds=tn(this._milliseconds),this._days=tn(this._days),this._months=tn(this._months),e.milliseconds=tn(e.milliseconds),e.seconds=tn(e.seconds),e.minutes=tn(e.minutes),e.hours=tn(e.hours),e.months=tn(e.months),e.years=tn(e.years),this}function B_(e,t,r,n){var i=br(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function _V(e,t){return B_(this,e,t,1)}function CV(e,t){return B_(this,e,t,-1)}function W_(e){return e<0?Math.floor(e):Math.ceil(e)}function OV(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,o,a,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=W_(cm(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=or(e/1e3),n.seconds=i%60,o=or(i/60),n.minutes=o%60,a=or(o/60),n.hours=a%24,t+=or(a/24),l=or(V_(t)),r+=l,t-=W_(cm(l)),s=or(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function V_(e){return e*4800/146097}function cm(e){return e*146097/4800}function TV(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=ir(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+V_(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(cm(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function RV(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+xe(this._months/12)*31536e6:NaN}function rn(e){return function(){return this.as(e)}}var EV=rn("ms"),kV=rn("s"),AV=rn("m"),xV=rn("h"),IV=rn("d"),PV=rn("w"),$V=rn("M"),MV=rn("Q"),NV=rn("y");function DV(){return br(this)}function HV(e){return e=ir(e),this.isValid()?this[e+"s"]():NaN}function oi(e){return function(){return this.isValid()?this._data[e]:NaN}}var LV=oi("milliseconds"),FV=oi("seconds"),jV=oi("minutes"),BV=oi("hours"),WV=oi("days"),VV=oi("months"),zV=oi("years");function UV(){return or(this.days()/7)}var nn=Math.round,io={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function GV(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function YV(e,t,r,n){var i=br(e).abs(),o=nn(i.as("s")),a=nn(i.as("m")),s=nn(i.as("h")),l=nn(i.as("d")),u=nn(i.as("M")),c=nn(i.as("w")),h=nn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=t,d[3]=+e>0,d[4]=n,GV.apply(null,d)}function KV(e){return e===void 0?nn:typeof e=="function"?(nn=e,!0):!1}function ZV(e,t){return io[e]===void 0?!1:t===void 0?io[e]:(io[e]=t,e==="s"&&(io.ss=t-1),!0)}function qV(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=io,i,o;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},io,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),o=YV(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var fm=Math.abs;function oo(e){return(e>0)-(e<0)||+e}function hc(){if(!this.isValid())return this.localeData().invalidDate();var e=fm(this._milliseconds)/1e3,t=fm(this._days),r=fm(this._months),n,i,o,a,s=this.asSeconds(),l,u,c,h;return s?(n=or(e/60),i=or(n/60),e%=60,n%=60,o=or(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=oo(this._months)!==oo(s)?"-":"",c=oo(this._days)!==oo(s)?"-":"",h=oo(this._milliseconds)!==oo(s)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(t?c+t+"D":"")+(i||n||e?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(e?h+a+"S":"")):"P0D"}var $e=oc.prototype;$e.isValid=WB,$e.abs=SV,$e.add=_V,$e.subtract=CV,$e.as=TV,$e.asMilliseconds=EV,$e.asSeconds=kV,$e.asMinutes=AV,$e.asHours=xV,$e.asDays=IV,$e.asWeeks=PV,$e.asMonths=$V,$e.asQuarters=MV,$e.asYears=NV,$e.valueOf=RV,$e._bubble=OV,$e.clone=DV,$e.get=HV,$e.milliseconds=LV,$e.seconds=FV,$e.minutes=jV,$e.hours=BV,$e.days=WV,$e.weeks=UV,$e.months=VV,$e.years=zV,$e.humanize=qV,$e.toISOString=hc,$e.toString=hc,$e.toJSON=hc,$e.locale=x_,$e.localeData=P_,$e.toIsoString=nr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",hc),$e.lang=I_,pe("X",0,0,"unix"),pe("x",0,0,"valueOf"),he("x",Qu),he("X",gj),je("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)}),je("x",function(e,t,r){r._d=new Date(xe(e))});//! moment.js
ue.version="2.29.4",XF(Ge),ue.fn=te,ue.min=LB,ue.max=FB,ue.now=jB,ue.utc=Pr,ue.unix=vV,ue.months=yV,ue.isDate=ts,ue.locale=On,ue.invalid=zu,ue.duration=br,ue.isMoment=pr,ue.weekdays=gV,ue.parseZone=mV,ue.localeData=en,ue.isDuration=ac,ue.monthsShort=pV,ue.weekdaysMin=wV,ue.defineLocale=Qv,ue.updateLocale=mB,ue.locales=yB,ue.weekdaysShort=bV,ue.normalizeUnits=ir,ue.relativeTimeRounding=KV,ue.relativeTimeThreshold=ZV,ue.calendarFormat=fW,ue.prototype=te,ue.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function wr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=Zi(e,function(o,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return o+l+u},"");return i.trim()}var z_,U_,G_,Y_,K_,Z_;function ao(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hm(e){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function dm(e){var t;switch(hm(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function Ie(e){return typeof e<"u"}function Bt(e){return typeof e>"u"}function ai(e){return e===null||e===""||Bt(e)}function XV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var hs="length",ds=function(t){return parseInt(t,16)},q_=function(t){return parseInt(t,10)},dc=function(t,r,n){return t.substr(r,n)},vs=function(t){return t.codePointAt(0)-65},vm=function(t){return"".concat(t).replace(/\-/g,"")},QV=function(t){return ds(dc(vm(t),ds("12"),vs("F")))/(ds(dc(vm(t),vs("B"),~~![][hs]))||9)},JV=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},X_=!1,Q_={invalid:function(){return wr(z_||(z_=ao([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return wr(U_||(U_=ao([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return wr(G_||(G_=ao([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},J_={invalid:function(){return wr(Y_||(Y_=ao([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return wr(K_||(K_=ao([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return wr(Z_||(Z_=ao([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function ez(e,t){var r=!ai(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="13.0.0",o,a="invalid",s="invalid";e=vm(e||"");var l=tz(e);if(r||n||l)if(l){var u=ue("22/06/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=QV(e);o=ue((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(JV()&&(a="valid",s="valid"),!X_&&a!=="valid"){var d=Q_[a]({keyValidityDate:o,hotVersion:i});d&&console[a==="non_commercial"?"info":"warn"](Q_[a]({keyValidityDate:o,hotVersion:i})),X_=!0}if(s!=="valid"&&t.parentNode){var f=J_[s]({keyValidityDate:o,hotVersion:i});if(f){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=J_[s]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(v,t.nextSibling)}}}function tz(e){var t=[][hs],r=t;if(e[hs]!==vs("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=vs(i.shift());o;o=vs(i.shift()||"A"))--o<""[hs]?r=r|(q_("".concat(q_(ds(n)+(ds(dc(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=dc(e,o,o?i[hs]===1?9:8:6);return r===t}function so(e){return e[0].toUpperCase()+e.substr(1)}function eC(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function rz(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function nz(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function tC(e,t){return RF.sanitize(e,t)}function rC(e){return sz(e)||az(e)||oz(e)||iz()}function iz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oz(e,t){if(e){if(typeof e=="string")return mm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mm(e,t)}}function az(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sz(e){if(Array.isArray(e))return mm(e)}function mm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lz(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function uz(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function ym(e){return uz(e)&&e.parent}function nC(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(a)))return a;var c=a,h=c.host;h&&l===o?a=h:a=a.parentNode}return null}function vc(e,t,r){for(var n=[],i=e;i&&(i=nC(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function pm(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function cz(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function si(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var gm,bm,wm;function mc(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(K9()){var iC=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};gm=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},bm=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=mc(i),i.length>0)if(iC(n)){var o;(o=t.classList).add.apply(o,rC(i))}else for(var a=0;i[a];)t.classList.add(i[a]),a+=1},wm=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=mc(i),i.length>0)if(iC(n)){var o;(o=t.classList).remove.apply(o,rC(i))}else for(var a=0;i[a];)t.classList.remove(i[a]),a+=1}}else{var Sm=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};gm=function(t,r){return t.className!==void 0&&Sm(r).test(t.className)},bm=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=mc(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!Sm(i[o]).test(n)&&(n+=" ".concat(i[o]));t.className=n},wm=function(t,r){var n=0,i=t.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=mc(o);o[n];)i=i.replace(Sm(o[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Je(e,t){return gm(e,t)}function Ae(e,t){bm(e,t)}function qe(e,t){wm(e,t)}function oC(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)oC(t[r])}function lo(e){for(var t;t=e.lastChild;)e.removeChild(t)}var fz=/(<(.*)>|&(.*);)/;function hz(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fz.test(t)?e.innerHTML=r?tC(t):t:ms(e,t)}function ms(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?Z9?r.textContent=t:r.data=t:(lo(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function yc(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return yc(r.host.impl);if(r.host)return yc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Pt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,o,a,s,l;if(pS()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,s=i;(i=i.offsetParent)&&i!==t.body;)o+=i.offsetLeft,a+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:o,top:a}}function aC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function _m(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function pc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?aC(t):e.scrollTop}function Cm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?_m(t):e.scrollLeft}function gc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=q9(),o=e.parentNode;o&&o.style&&t.body!==o;){var a=o.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return o;if(i){var c=r.getComputedStyle(o);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(u)||n.includes(s))||o.clientWidth<=o.scrollWidth+1&&(n.includes(l)||n.includes(s)))return o;o=o.parentNode}return r}function bc(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=li(n,r),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(s)||o.includes(l))return n;n=n.parentNode}return r}function Om(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=li(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function li(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ht(e){return e.offsetWidth}function Zt(e){return pS()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function Rn(e){return e.clientHeight||e.innerHeight}function wc(e){return e.clientWidth||e.innerWidth}function dz(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function vz(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function sC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function lC(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var Tm;function mz(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function $t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Tm===void 0&&(Tm=mz(e)),Tm}function yz(e){return e.offsetWidth!==e.clientWidth}function pz(e){return e.offsetHeight!==e.clientHeight}function Rm(e,t,r){qL()?(e.style.top=r,e.style.left=t):YL()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Sc(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Em(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function km(e){return Em(e)&&e.hasAttribute("data-hot-input")===!1}function gz(e){var t=e.ownerDocument.activeElement;km(t)||e.select()}function bz(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}function Xe(e){return typeof e=="function"}function wz(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return e.apply(this,r.concat(a))}}function Am(e,t,r,n,i,o,a,s){return Ie(s)?e.call(t,r,n,i,o,a,s):Ie(a)?e.call(t,r,n,i,o,a):Ie(o)?e.call(t,r,n,i,o):Ie(i)?e.call(t,r,n,i):Ie(n)?e.call(t,r,n):Ie(r)?e.call(t,r):e.call(t)}var Sz=Ee,uC=id,_c=$a.getWeakData,_z=ed,Cz=rt,Oz=Ar,xm=tt,Tz=Jh,cC=Yn,fC=Qe,hC=Wr,Rz=hC.set,Ez=hC.getterFor,kz=cC.find,Az=cC.findIndex,xz=Sz([].splice),Iz=0,Cc=function(e){return e.frozen||(e.frozen=new dC)},dC=function(){this.entries=[]},Im=function(e,t){return kz(e.entries,function(r){return r[0]===t})};dC.prototype={get:function(e){var t=Im(this,e);if(t)return t[1]},has:function(e){return!!Im(this,e)},set:function(e,t){var r=Im(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Az(this.entries,function(r){return r[0]===e});return~t&&xz(this.entries,t,1),!!~t}};var vC={getConstructor:function(e,t,r,n){var i=e(function(l,u){_z(l,o),Rz(l,{type:t,id:Iz++,frozen:void 0}),Oz(u)||Tz(u,l[n],{that:l,AS_ENTRIES:r})}),o=i.prototype,a=Ez(t),s=function(l,u,c){var h=a(l),d=_c(Cz(u),!0);return d===!0?Cc(h).set(u,c):d[h.id]=c,l};return uC(o,{delete:function(l){var u=a(this);if(!xm(l))return!1;var c=_c(l);return c===!0?Cc(u).delete(l):c&&fC(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!xm(u))return!1;var h=_c(u);return h===!0?Cc(c).has(u):h&&fC(h,c.id)}}),uC(o,r?{get:function(u){var c=a(this);if(xm(u)){var h=_c(u);return h===!0?Cc(c).get(u):h?h[c.id]:void 0}},set:function(u,c){return s(this,u,c)}}:{add:function(u){return s(this,u,!0)}}),i}},Pz=Kh,mC=Fe,Oc=Ee,yC=id,$z=$a,Mz=bu,pC=vC,Tc=tt,Rc=Wr.enforce,Nz=Te,Dz=mb,ys=Object,Hz=Array.isArray,Ec=ys.isExtensible,gC=ys.isFrozen,Lz=ys.isSealed,bC=ys.freeze,Fz=ys.seal,wC={},SC={},jz=!mC.ActiveXObject&&"ActiveXObject"in mC,ps,_C=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},CC=Mz("WeakMap",_C,pC),uo=CC.prototype,kc=Oc(uo.set),Bz=function(){return Pz&&Nz(function(){var e=bC([]);return kc(new CC,e,1),!gC(e)})};if(Dz)if(jz){ps=pC.getConstructor(_C,"WeakMap",!0),$z.enable();var OC=Oc(uo.delete),Ac=Oc(uo.has),TC=Oc(uo.get);yC(uo,{delete:function(e){if(Tc(e)&&!Ec(e)){var t=Rc(this);return t.frozen||(t.frozen=new ps),OC(this,e)||t.frozen.delete(e)}return OC(this,e)},has:function(t){if(Tc(t)&&!Ec(t)){var r=Rc(this);return r.frozen||(r.frozen=new ps),Ac(this,t)||r.frozen.has(t)}return Ac(this,t)},get:function(t){if(Tc(t)&&!Ec(t)){var r=Rc(this);return r.frozen||(r.frozen=new ps),Ac(this,t)?TC(this,t):r.frozen.get(t)}return TC(this,t)},set:function(t,r){if(Tc(t)&&!Ec(t)){var n=Rc(this);n.frozen||(n.frozen=new ps),Ac(this,t)?kc(this,t,r):n.frozen.set(t,r)}else kc(this,t,r);return this}})}else Bz()&&yC(uo,{set:function(t,r){var n;return Hz(t)&&(gC(t)?n=wC:Lz(t)&&(n=SC)),kc(this,t,r),n==wC&&bC(t),n==SC&&Fz(t),this}});var me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ov()?182:174,AUDIO_MUTE:Ov()?181:173,AUDIO_UP:Ov()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Wz=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function Vz(e){return Wz.includes(e)}function zz(e){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(e)}function Uz(e,t){var r=t.split("|"),n=!1;return Ce(r,function(i){if(e===me[i])return n=!0,!1}),n}function Pm(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function co(e){return e.isImmediatePropagationEnabled===!1}function xc(e){return e.button===2}function RC(e){return e.button===0}function Ic(){if(Ie(console)){var e;(e=console).warn.apply(e,arguments)}}function Gz(){if(Ie(console)){var e;(e=console).error.apply(e,arguments)}}function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}var EC;function Yz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zz(n.key),n)}}function Kz(e,t,r){return t&&kC(e.prototype,t),r&&kC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zz(e){var t=qz(e,"string");return gs(t)==="symbol"?t:String(t)}function qz(e,t){if(gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xz(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var fo=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Qz=wr(EC||(EC=Xz([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),$m=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Mm=new Map([]),Ye=function(){function e(){Yz(this,e),this.globalBucket=this.createEmptyBucket()}return Kz(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return Ce(fo,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))Ce(n,function(l){return i.add(r,l,o)});else{$m.has(r)&&Ic(nz(Qz,{hookName:r,removedInVersion:$m.get(r)})),Mm.has(r)&&Ic(Mm.get(r));var a=this.getBucket(o);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&Ce(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?Ce(n,function(a){return i.once(r,a,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,a,s,l,u){{var c=this.globalBucket[n],h=c?c.length:0,d=0;if(h)for(;d<h;){if(!c[d]||c[d].skip){d+=1;continue}var f=Am(c[d],r,i,o,a,s,l,u);f!==void 0&&(i=f),c[d]&&c[d].runOnce&&this.remove(n,c[d]),d+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,m=0;if(y)for(;m<y;){if(!v[m]||v[m].skip){m+=1;continue}var S=Am(v[m],r,i,o,a,s,l,u);S!==void 0&&(i=S),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;We(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||fo.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&fo.splice(fo.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Mm.has(r)||$m.has(r)}},{key:"isRegistered",value:function(r){return fo.indexOf(r)>=0}},{key:"getRegistered",value:function(){return fo}}],[{key:"getSingleton",value:function(){return eU()}}]),e}(),Jz=new Ye;function eU(){return Jz}function AC(e){return iU(e)||nU(e)||rU(e)||tU()}function tU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rU(e,t){if(e){if(typeof e=="string")return Nm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nm(e,t)}}function nU(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iU(e){if(Array.isArray(e))return Nm(e)}function Nm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Dm=new Map;function ui(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Dm.has(e)||Dm.set(e,new Map);var t=Dm.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function i(s){return t.has(s)}function o(){return AC(t.keys())}function a(){return AC(t.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:a}}var Hm=new WeakMap,Lm=ui("editors"),oU=Lm.register,xC=Lm.getItem,IC=Lm.hasItem;function aU(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Ye.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function sU(e,t){var r;if(typeof e=="function")Hm.get(e)||$C(null,e),r=Hm.get(e);else if(typeof e=="string")r=xC(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function PC(e){if(typeof e=="function")return e;if(!IC(e))throw Error('No registered editor found under "'.concat(e,'" name'));return xC(e).getConstructor()}function $C(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new aU(t);typeof e=="string"&&oU(e,r),Hm.set(t,r)}function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function lU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cU(n.key),n)}}function uU(e,t,r){return t&&MC(e.prototype,t),r&&MC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cU(e){var t=fU(e,"string");return bs(t)==="symbol"?t:String(t)}function fU(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var En=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;lU(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return uU(e,[{key:"addEventListener",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,hU(l))}return typeof a!="boolean"&&!J9()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function hU(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Pm(this)},e}function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function dU(e,t){return pU(e)||yU(e,t)||mU(e,t)||vU()}function vU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mU(e,t){if(e){if(typeof e=="string")return NC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(e,t)}}function NC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yU(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function pU(e){if(Array.isArray(e))return e}function gU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wU(n.key),n)}}function bU(e,t,r){return t&&DC(e.prototype,t),r&&DC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wU(e){var t=SU(e,"string");return ws(t)==="symbol"?t:String(t)}function SU(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fm="editorManager.navigation",Pc="editorManager.handlingEditor",jm=function(){function e(t,r,n){var i=this;gU(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new En(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return i.onCellDblClick(a,s,l)})}return bU(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),a={group:Pc};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),Pm(l)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),s=i,l=o;if(Array.isArray(a)){var u=dU(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var c=this.instance.rootDocument.activeElement;if(c&&km(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var h=this.instance.getCell(i,o,!0);if(h){var d=this.instance.getCellEditor(this.cellProperties),f=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=sU(d,this.instance),this.activeEditor.prepare(i,o,f,h,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,a=o.row,s=o.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance,s=a.rowIndexMapper,l=a.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Vz(i)&&!zz(i)&&!o&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),s=a.getContext("editor"),l={runOnlyIf:function(){return Ie(n.instance.getSelected())},group:Fm};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),HC=new WeakMap;jm.getInstance=function(e,t,r){var n=HC.get(e);return n||(n=new jm(e,t,r),HC.set(e,n)),n};var _U=we,CU=zS;_U({target:"String",proto:!0},{repeat:CU});var OU=ct,TU=Pd,RU=rt,EU=Ar,kU=Ni,Bm=mt,AU=cr,xU=Mi,IU=$d,LC=Hd;TU("match",function(e,t,r){return[function(i){var o=AU(this),a=EU(i)?void 0:xU(i,e);return a?OU(a,i,o):new RegExp(i)[e](Bm(o))},function(n){var i=RU(this),o=Bm(n),a=r(t,i,o);if(a.done)return a.value;if(!i.global)return LC(i,o);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,c;(c=LC(i,o))!==null;){var h=Bm(c[0]);l[u]=h,h===""&&(i.lastIndex=IU(o,kU(i.lastIndex),s)),u++}return u===0?null:l}]});var PU=Kn,$U=Ut,MU=Vn,NU=Jt,DU=Fi,HU=Math.min,Wm=[].lastIndexOf,FC=!!Wm&&1/[1].lastIndexOf(1,-0)<0,LU=DU("lastIndexOf"),FU=FC||!LU,jU=FU?function(t){if(FC)return PU(Wm,this,arguments)||0;var r=$U(this),n=NU(r),i=n-1;for(arguments.length>1&&(i=HU(i,MU(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:Wm,BU=we,jC=jU;BU({target:"Array",proto:!0,forced:jC!==[].lastIndexOf},{lastIndexOf:jC});var WU=Wn,VU=Ht,zU=ya,UU=Jt,GU=TypeError,BC=function(e){return function(t,r,n,i){WU(r);var o=VU(t),a=zU(o),s=UU(o),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in a){i=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw GU("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(i=r(i,a[l],l,o));return i}},YU={left:BC(!1),right:BC(!0)},KU=we,ZU=YU.left,qU=Fi,WC=pa,XU=qw,QU=!XU&&WC>79&&WC<83,JU=QU||!qU("reduce");KU({target:"Array",proto:!0,forced:JU},{reduce:function(t){var r=arguments.length;return ZU(this,t,r,r>1?arguments[1]:void 0)}});var eG=we,tG=Yn.findIndex,rG=_a,Vm="findIndex",VC=!0;Vm in[]&&Array(1)[Vm](function(){VC=!1}),eG({target:"Array",proto:!0,forced:VC},{findIndex:function(t){return tG(this,t,arguments.length>1?arguments[1]:void 0)}}),rG(Vm);function zm(e){return aG(e)||oG(e)||iG(e)||nG()}function nG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iG(e,t){if(e){if(typeof e=="string")return Um(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Um(e,t)}}function oG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aG(e){if(Array.isArray(e))return Um(e)}function Um(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var zC={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},sG=new RegExp(Object.keys(zC).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function lG(e){return(e&&e.nodeName||"")==="TABLE"}function UC(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=t?1:0,d=0;d<o;d+=1){for(var f=t&&d===0,v=[],y=0;y<a;y+=1){var m=!f&&r&&y===0,S="";if(f)S="<th>".concat(e.getColHeader(y-c),"</th>");else if(m)S="<th>".concat(e.getRowHeader(d-h),"</th>");else{var _=i[d][y],O=e.getCellMeta(d-h,y-c),R=O.hidden,T=O.rowspan,D=O.colspan;if(!R){var H=[];if(T&&H.push('rowspan="'.concat(T,'"')),D&&H.push('colspan="'.concat(D,'"')),ai(_))S="<td ".concat(H.join(" "),"></td>");else{var V=_.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S="<td ".concat(H.join(" "),">").concat(V,"</td>")}}}v.push(S)}var F=["<tr>"].concat(v,["</tr>"]).join("");f?l.splice(1,0,F):u.splice(-1,0,F)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function GC(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],o=i.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<o;s+=1){var l=i[s],u=ai(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(c){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(c.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function uG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var o=e;if(typeof o=="string"){var a=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(w){var x=w.match(/<td\b[^>]*?>/g)[0],k=w.substring(x.length,w.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),P="</td>";return"".concat(x).concat(k).concat(P)});i.insertAdjacentHTML("afterbegin","".concat(a)),o=i.querySelector("table")}if(!(!o||!lG(o))){var s=i.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(w,x){return w+x.colSpan},0)-(l?1:0):0,h=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[],f=!1,v=0,y=0;if(o.tHead){var m=Array.from(o.tHead.rows).filter(function(w){var x=w.querySelector("td")!==null;return x&&d.push(w),!x});v=m.length,f=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(w,x){var k=Array.from(x.cells).reduce(function(P,N,Z){if(l&&Z===0)return P;var U=N.colSpan,X=N.innerHTML,ne=U>1?{label:X,colspan:U}:X;return P.push(ne),P},[]);return w.push(k),w},[]):f&&(r.colHeaders=Array.from(m[0].children).reduce(function(w,x,k){return l&&k===0||w.push(x.innerHTML),w},[]))}d.length&&(r.fixedRowsTop=d.length),h.length&&(r.fixedRowsBottom=h.length);var S=[].concat(d,zm(Array.from(o.tBodies).reduce(function(w,x){return w.push.apply(w,zm(Array.from(x.rows))),w},[])),zm(h));y=S.length;for(var _=new Array(y),O=0;O<y;O++)_[O]=new Array(c);for(var R=[],T=[],D=0;D<y;D++)for(var H=S[D],V=Array.from(H.cells),F=V.length,q=0;q<F;q++){var le=V[q],I=le.nodeName,j=le.innerHTML,C=le.rowSpan,z=le.colSpan,fe=_[D].findIndex(function(w){return w===void 0});if(I==="TD"){if(C>1||z>1){for(var G=D;G<D+C;G++)if(G<y)for(var ve=fe;ve<fe+z;ve++)_[G][ve]=null;var Q=le.getAttribute("style"),g=Q&&Q.includes("mso-ignore:colspan");g||R.push({col:fe,row:D,rowspan:C,colspan:z})}var p="";s&&/excel/gi.test(s.content)?p=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),_[D][fe]=p.replace(sG,function(w){return zC[w]})}else T.push(j)}return R.length&&(r.mergeCells=R),T.length&&(r.rowHeaders=T),_.length&&(r.data=_),r}}function cG(e){return vG(e)||dG(e)||hG(e)||fG()}function fG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hG(e,t){if(e){if(typeof e=="string")return Gm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gm(e,t)}}function dG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vG(e){if(Array.isArray(e))return Gm(e)}function Gm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function kn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=Ym(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(cG(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function mG(e){return kn(e,[","])}function pt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function YC(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function yG(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function pG(e){return wG(e)||bG(e)||KC(e)||gG()}function gG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wG(e){if(Array.isArray(e))return Km(e)}function SG(e,t){return OG(e)||CG(e,t)||KC(e,t)||_G()}function _G(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KC(e,t){if(e){if(typeof e=="string")return Km(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Km(e,t)}}function Km(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function OG(e){if(Array.isArray(e))return e}var Zm="asc",TG="desc",ZC=new Map([[Zm,[-1,1]],[TG,[1,-1]]]),RG=function(t){return"The priority '".concat(t,"' is already declared in a map.")},EG=function(t){return"The priority '".concat(t,"' is not a number.")};function kG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=Xe(t)?t:RG,r=Xe(r)?r:EG;function i(a,s){if(!kn(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,s)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zm,s=ZC.get(a)||ZC.get(Zm),l=SG(s,2),u=l[0],c=l[1];return pG(n).sort(function(h,d){return h[0]<d[0]?u:c}).map(function(h){return h[1]})}return{addItem:i,getItems:o}}var AG=we,xG=Yn.find,IG=_a,qm="find",qC=!0;qm in[]&&Array(1)[qm](function(){qC=!1}),AG({target:"Array",proto:!0,forced:qC},{find:function(t){return xG(this,t,arguments.length>1?arguments[1]:void 0)}}),IG(qm);function PG(e){return NG(e)||MG(e)||QC(e)||$G()}function $G(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NG(e){if(Array.isArray(e))return Xm(e)}function XC(e,t){return LG(e)||HG(e,t)||QC(e,t)||DG()}function DG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QC(e,t){if(e){if(typeof e=="string")return Xm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xm(e,t)}}function Xm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function LG(e){if(Array.isArray(e))return e}var FG=function(t){return"The id '".concat(t,"' is already declared in a map.")};function $c(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=Xe(t)?t:FG;function n(c,h){if(u(c))throw new Error(t(c));r.set(c,h)}function i(c){return r.delete(c)}function o(){r.clear()}function a(c){var h=l().find(function(v){var y=XC(v,2),m=y[0],S=y[1];return c===S?m:!1})||[null],d=XC(h,1),f=d[0];return f}function s(c){return r.get(c)}function l(){return PG(r)}function u(c){return r.has(c)}return{addItem:n,clear:o,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:i}}function jG(e){return zG(e)||VG(e)||WG(e)||BG()}function BG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WG(e,t){if(e){if(typeof e=="string")return Qm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qm(e,t)}}function VG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zG(e){if(Array.isArray(e))return Qm(e)}function Qm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var UG=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function GG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=Xe(t)?t:UG;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function i(){return jG(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function YG(e,t){return qG(e)||ZG(e,t)||e2(e,t)||KG()}function KG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function qG(e){if(Array.isArray(e))return e}function JC(e){return JG(e)||QG(e)||e2(e)||XG()}function XG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e2(e,t){if(e){if(typeof e=="string")return Jm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jm(e,t)}}function QG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JG(e){if(Array.isArray(e))return Jm(e)}function Jm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ey=function(t){return'There is already registered "'.concat(t,'" plugin.')},eY=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},tY=function(t){return'The priority "'.concat(t,'" is not a number.')},t2=kG({errorPriorityExists:eY,errorPriorityNaN:tY}),r2=GG({errorItemExists:ey}),ty=$c({errorIdExists:ey});function n2(){return[].concat(JC(t2.getItems()),JC(r2.getItems()))}function ry(e){var t=so(e);return ty.getItem(t)}function rY(e){return!!ry(e)}function Mc(e,t,r){var n=iY(e,t,r),i=YG(n,3);e=i[0],t=i[1],r=i[2],ry(e)===void 0&&nY(e,t,r)}function nY(e,t,r){var n=so(e);if(ty.hasItem(n))throw new Error(ey(n));r===void 0?r2.addItem(n):t2.addItem(r,n),ty.addItem(n,t)}function iY(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var ny=ui("renderers"),oY=ny.register,aY=ny.getItem,i2=ny.hasItem;function o2(e){if(typeof e=="function")return e;if(!i2(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return aY(e)}function sY(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),oY(e,t)}var iy=ui("validators"),lY=iy.register,uY=iy.getItem,a2=iy.hasItem;function cY(e){if(typeof e=="function")return e;if(!a2(e))throw Error('No registered validator found under "'.concat(e,'" name'));return uY(e)}function fY(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),lY(e,t)}var ci=1,Rt=2;function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function hY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vY(n.key),n)}}function dY(e,t,r){return t&&s2(e.prototype,t),r&&s2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vY(e){var t=mY(e,"string");return Ss(t)==="symbol"?t:String(t)}function mY(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ho=new WeakMap,oy=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,c=u===void 0?function(d){return d}:u,h=t.inlineStartOffset;hY(this,e),ho.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return dY(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,a=0,s=0,l=ho.get(this),u=l.calculationType,c=l.overrideFn,h=l.scrollOffset,d=Math.max(l.scrollOffset,0),f=l.totalColumns,v=l.viewportWidth,y=d>0?v+1:v,m=0;m<f;m++)if(o=this._getColumnWidth(m),r<=d&&u!==Rt&&(this.startColumn=m,a=o),r>=d&&r+(u===Rt?o:0)<=d+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=o),this.endColumn=m),i.push(r),r+=o,s=o,u!==Rt&&(this.endColumn=m),r>=d+v){n=!1;break}var S=h+v-y,_=u===Rt?0:s,O=u===Rt?a:0;if(S<-1*l.inlineStartOffset||h>i.at(-1)+_||-1*l.scrollOffset-l.viewportWidth>-1*O?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var R=i[this.endColumn]+o-i[this.startColumn-1];if((R<=v||u!==Rt)&&(this.startColumn-=1),R>v)break}u===ci&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=ho.get(this),o=i.totalColumns,a=0,s=0;s<o;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var h=this._getColumnWidth(o-1),d=c+h;this.stretchLastWidth=d>=0?d:h}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=ho.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=ho.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=ho.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function yY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gY(n.key),n)}}function pY(e,t,r){return t&&l2(e.prototype,t),r&&l2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gY(e){var t=bY(e,"string");return _s(t)==="symbol"?t:String(t)}function bY(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u2=new WeakMap,wY=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;yY(this,e),u2.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return pY(e,[{key:"calculate",value:function(){for(var r=u2.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,a=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,c=r.horizontalScrollbarHeight||0,h=0,d=!0,f=[],v,y=0,m=0,S=0;S<l;S++)if(v=o(S),isNaN(v)&&(v=e.DEFAULT_HEIGHT),h<=s&&n!==Rt&&(this.startRow=S,y=v),h>=s&&h+(n===Rt?v:0)<=s+u-c&&(this.startRow===null&&(this.startRow=S,y=v),this.endRow=S),f.push(h),h+=v,m=v,n!==Rt&&(this.endRow=S),h>=s+u-c){d=!1;break}var _=a+u-c,O=n===Rt?y:0,R=n===Rt?0:m;if(_<O||a>f.at(-1)+R?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&d)for(this.startRow=this.endRow;this.startRow>0;){var T=f[this.endRow]+v-f[this.startRow-1];if((T<=u-c||n!==Rt)&&(this.startRow-=1),T>=u-c)break}n===ci&&this.startRow!==null&&i&&i(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const SY=wY;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function _Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h2(n.key),n)}}function CY(e,t,r){return t&&c2(e.prototype,t),r&&c2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OY(e,t,r){TY(e,t),t.set(e,r)}function TY(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f2(e,t,r){return t=h2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h2(e){var t=RY(e,"string");return Cs(t)==="symbol"?t:String(t)}function RY(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Os(e,t){var r=d2(e,t,"get");return EY(e,r)}function EY(e,t){return t.get?t.get.call(e):t.value}function kY(e,t,r){var n=d2(e,t,"set");return AY(e,n,r),r}function d2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function AY(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var fi=new WeakMap,xY=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_Y(this,e),f2(this,"row",null),f2(this,"col",null),OY(this,fi,{writable:!0,value:!1}),kY(this,fi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return CY(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Os(this,fi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Os(this,fi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Os(this,fi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Os(this,fi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Os(this,fi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Nc=xY;function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function IY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m2(n.key),n)}}function PY(e,t,r){return t&&v2(e.prototype,t),r&&v2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Y(e,t,r){MY(e,t),t.set(e,r)}function MY(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ay(e,t,r){return t=m2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2(e){var t=NY(e,"string");return Ts(t)==="symbol"?t:String(t)}function NY(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dr(e,t){var r=y2(e,t,"get");return DY(e,r)}function DY(e,t){return t.get?t.get.call(e):t.value}function HY(e,t,r){var n=y2(e,t,"set");return LY(e,n,r),r}function y2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function LY(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ar=new WeakMap,FY=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;IY(this,e),ay(this,"highlight",null),ay(this,"from",null),ay(this,"to",null),$Y(this,ar,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),HY(this,ar,i)}return PY(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),a=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(i.row,s.row),h=Math.max(i.col,s.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Dr(this,ar)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Dr(this,ar)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Dr(this,ar)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Dr(this,ar)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Dr(this,ar)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Dr(this,ar)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Dr(this,ar)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Dr(this,ar)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Nc))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)r.row===o&&r.col===a?i.push(r):n.row===o&&n.col===a?i.push(n):i.push(this._createCellCoords(o,a));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var s=r(o,a);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Dr(this,ar))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Nc(r,n,Dr(this,ar))}}]),e}();const sy=FY;var jY=we,BY=jh;jY({target:"Object",stat:!0},{setPrototypeOf:BY});var p2=Ee,WY=Wn,VY=tt,zY=Qe,g2=ja,UY=ma,b2=Function,GY=p2([].concat),YY=p2([].join),ly={},KY=function(e,t,r){if(!zY(ly,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";ly[t]=b2("C,a","return new C("+YY(n,",")+")")}return ly[t](e,r)},ZY=UY?b2.bind:function(t){var r=WY(this),n=r.prototype,i=g2(arguments,1),o=function(){var s=GY(i,g2(arguments));return this instanceof o?KY(r,s.length,s):r.apply(t,s)};return VY(n)&&(o.prototype=n),o},qY=we,XY=Br,uy=Kn,QY=ZY,w2=SS,JY=rt,S2=tt,eK=Di,_2=Te,cy=XY("Reflect","construct"),tK=Object.prototype,rK=[].push,C2=_2(function(){function e(){}return!(cy(function(){},[],e)instanceof e)}),O2=!_2(function(){cy(function(){})}),T2=C2||O2;qY({target:"Reflect",stat:!0,forced:T2,sham:T2},{construct:function(t,r){w2(t),JY(r);var n=arguments.length<3?t:w2(arguments[2]);if(O2&&!C2)return cy(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return uy(rK,i,r),new(uy(QY,t,i))}var o=n.prototype,a=eK(S2(o)?o:tK),s=uy(t,a,r);return S2(s)?s:a}});function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function nK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oK(n.key),n)}}function iK(e,t,r){return t&&R2(e.prototype,t),r&&R2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oK(e){var t=aK(e,"string");return Rs(t)==="symbol"?t:String(t)}function aK(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vo=new WeakMap,sK=function(){function e(t,r,n,i,o,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;nK(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=a,this.parent=s,this.eventManager=i,this.facadeGetter=t,vo.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return iK(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};Sn()?n():(X9()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=vo.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[o.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],h=u[1];return s===l&&c===h}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=vc(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Je(r,"wtBorder")&&Je(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Je(r,"wtBorder")&&Je(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=vo.get(this),i=this.domBindings.rootDocument.activeElement,o=wz(lz,r.target),a=r.target;if(!(a===i||o(0)===i||o(1)===i)){var s=this.parentCell(a);Je(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=vc(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&pm(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=vc(r.target,["TD","TH"],n),o=vc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;i&&i!==o&&pm(i,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i),o===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=vo.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Je(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=vo.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=Ie(o)&&o.row>=0&&o.col>=0,s=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];MS()&&(UL()||GL())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var a=this.wtSettings.getSettingPure(r);a&&a(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=vo.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const E2=sK;function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function lK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cK(n.key),n)}}function uK(e,t,r){return t&&k2(e.prototype,t),r&&k2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cK(e){var t=fK(e,"string");return Es(t)==="symbol"?t:String(t)}function fK(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hK=function(){function e(t,r,n){lK(this,e),this.offset=t,this.total=r,this.countTH=n}return uK(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function dK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mK(n.key),n)}}function vK(e,t,r){return t&&A2(e.prototype,t),r&&A2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mK(e){var t=yK(e,"string");return ks(t)==="symbol"?t:String(t)}function yK(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pK=function(){function e(t,r,n){dK(this,e),this.offset=t,this.total=r,this.countTH=n}return vK(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}(),gK=0,Dc=1,Hc=2;function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function bK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SK(n.key),n)}}function wK(e,t,r){return t&&x2(e.prototype,t),r&&x2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SK(e){var t=_K(e,"string");return As(t)==="symbol"?t:String(t)}function _K(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I2=function(){function e(){bK(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return wK(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function CK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TK(n.key),n)}}function OK(e,t,r){return t&&P2(e.prototype,t),r&&P2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TK(e){var t=RK(e,"string");return xs(t)==="symbol"?t:String(t)}function RK(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EK=function(){function e(){CK(this,e),this.size=new I2,this.workingSpace=gK,this.sharedSize=null}return OK(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof I2}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Dc,r.workingSpace=Hc,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Hc,r.workingSpace=Dc,this.sharedSize=r.getViewSize()}}]),e}();function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function kK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xK(n.key),n)}}function AK(e,t,r){return t&&$2(e.prototype,t),r&&$2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xK(e){var t=IK(e,"string");return Is(t)==="symbol"?t:String(t)}function IK(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M2=function(){function e(t,r,n){kK(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new EK,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return AK(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(Dc))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!i||i&&n.isPlaceOn(Hc)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(Dc);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Hc)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function mo(e){"@babel/helpers - typeof";return mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mo(e)}function PK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MK(n.key),n)}}function $K(e,t,r){return t&&N2(e.prototype,t),r&&N2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MK(e){var t=NK(e,"string");return mo(t)==="symbol"?t:String(t)}function NK(e,t){if(mo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fy(e,t)}function fy(e,t){return fy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fy(e,t)}function HK(e){var t=jK();return function(){var n=Lc(e),i;if(t){var o=Lc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LK(this,i)}}function LK(e,t){if(t&&(mo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FK(e)}function FK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lc(e){return Lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lc(e)}var D2=function(e){DK(r,e);var t=HK(r);function r(){return PK(this,r),t.apply(this,arguments)}return $K(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(M2);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function BK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VK(n.key),n)}}function WK(e,t,r){return t&&H2(e.prototype,t),r&&H2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VK(e){var t=zK(e,"string");return Ps(t)==="symbol"?t:String(t)}function zK(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UK=function(){function e(t){BK(this,e),this.nodeType=t.toUpperCase()}return WK(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function GK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KK(n.key),n)}}function YK(e,t,r){return t&&L2(e.prototype,t),r&&L2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KK(e){var t=ZK(e,"string");return $s(t)==="symbol"?t:String(t)}function ZK(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ms=function(){function e(t,r){GK(this,e),this.nodesPool=typeof t=="string"?new UK(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return YK(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function yo(e){"@babel/helpers - typeof";return yo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yo(e)}function qK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QK(n.key),n)}}function XK(e,t,r){return t&&F2(e.prototype,t),r&&F2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QK(e){var t=JK(e,"string");return yo(t)==="symbol"?t:String(t)}function JK(e,t){if(yo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hy(e,t)}function hy(e,t){return hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hy(e,t)}function tZ(e){var t=iZ();return function(){var n=Fc(e),i;if(t){var o=Fc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rZ(this,i)}}function rZ(e,t){if(t&&(yo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nZ(e)}function nZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fc(e){return Fc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fc(e)}var oZ=function(e){eZ(r,e);var t=tZ(r);function r(){var n;return qK(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return XK(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new D2(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,c=0;c<o;c++){var h=this.table.renderedRowToSource(c),d=l.getRenderedNode(c);this.sourceRowIndex=h;var f=this.obtainOrderView(d),v=u.obtainOrderView(d);f.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<s;y++){f.render();var m=f.getCurrentNode();m.className="",m.removeAttribute("style"),a[y](h,m,y)}f.end()}}}]),r}(Ms);function po(e){"@babel/helpers - typeof";return po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},po(e)}function aZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lZ(n.key),n)}}function sZ(e,t,r){return t&&j2(e.prototype,t),r&&j2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lZ(e){var t=uZ(e,"string");return po(t)==="symbol"?t:String(t)}function uZ(e,t){if(po(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(po(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dy(e,t)}function dy(e,t){return dy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dy(e,t)}function fZ(e){var t=vZ();return function(){var n=jc(e),i;if(t){var o=jc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hZ(this,i)}}function hZ(e,t){if(t&&(po(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dZ(e)}function dZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jc(e){return jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jc(e)}var mZ=function(e){cZ(r,e);var t=fZ(r);function r(n){return aZ(this,r),t.call(this,null,n)}return sZ(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,s=this.rootNode.firstChild;if(o){for(var l=this.table.columnsToRender,u=l+a,c=0,h=o;c<h;c++){for(s=this.rootNode.childNodes[c],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var d=this.rootNode.childNodes.length;if(d>o)for(var f=o;f<d;f++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&lo(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[o],h=-1*u;h<l;h+=1){var d=this.table.renderedColumnToSource(h),f=c.childNodes[h+u];f.className="",f.removeAttribute("style"),s[o](d,f,o)}}}]),r}(Ms);function go(e){"@babel/helpers - typeof";return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(e)}function yZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gZ(n.key),n)}}function pZ(e,t,r){return t&&B2(e.prototype,t),r&&B2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gZ(e){var t=bZ(e,"string");return go(t)==="symbol"?t:String(t)}function bZ(e,t){if(go(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(go(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vy(e,t)}function vy(e,t){return vy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vy(e,t)}function SZ(e){var t=OZ();return function(){var n=Bc(e),i;if(t){var o=Bc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _Z(this,i)}}function _Z(e,t){if(t&&(go(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CZ(e)}function CZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bc(e){return Bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bc(e)}var TZ=function(e){wZ(r,e);var t=SZ(r);function r(n){return yZ(this,r),t.call(this,null,n)}return pZ(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=o+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var c=0;c<o;c++){var h=this.table.renderedColumnToSource(c),d=this.table.columnUtils.getStretchedColumnWidth(h);this.rootNode.childNodes[c+a].style.width="".concat(d,"px")}var f=this.rootNode.firstChild;f&&Ae(f,"rowHeader")}}]),r}(Ms);function bo(e){"@babel/helpers - typeof";return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(e)}var W2;function RZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function EZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AZ(n.key),n)}}function kZ(e,t,r){return t&&V2(e.prototype,t),r&&V2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AZ(e){var t=xZ(e,"string");return bo(t)==="symbol"?t:String(t)}function xZ(e,t){if(bo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&my(e,t)}function my(e,t){return my=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},my(e,t)}function PZ(e){var t=NZ();return function(){var n=Wc(e),i;if(t){var o=Wc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $Z(this,i)}}function $Z(e,t){if(t&&(bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MZ(e)}function MZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wc(e){return Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wc(e)}var z2=!1,DZ=function(e){IZ(r,e);var t=PZ(r);function r(n){var i;return EZ(this,r),i=t.call(this,"TR",n),i.orderView=new M2(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return kZ(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!z2&&i>1e3&&(z2=!0,Ic(wr(W2||(W2=RZ([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(Ms);function wo(e){"@babel/helpers - typeof";return wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(e)}function HZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FZ(n.key),n)}}function LZ(e,t,r){return t&&U2(e.prototype,t),r&&U2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FZ(e){var t=jZ(e,"string");return wo(t)==="symbol"?t:String(t)}function jZ(e,t){if(wo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yy(e,t)}function yy(e,t){return yy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yy(e,t)}function WZ(e){var t=UZ();return function(){var n=Vc(e),i;if(t){var o=Vc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VZ(this,i)}}function VZ(e,t){if(t&&(wo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zZ(e)}function zZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vc(e){return Vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vc(e)}var GZ=function(e){BZ(r,e);var t=WZ(r);function r(){var n;return HZ(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return LZ(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new D2(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),h=s.getRenderedNode(u);this.sourceRowIndex=c;var d=this.obtainOrderView(h),f=l.obtainOrderView(h);d.prependView(f).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){d.render();var y=d.getCurrentNode(),m=this.table.renderedColumnToSource(v);Je(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(c,m,y)}d.end()}}}]),r}(Ms);function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function YZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZZ(n.key),n)}}function KZ(e,t,r){return t&&G2(e.prototype,t),r&&G2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZZ(e){var t=qZ(e,"string");return Ns(t)==="symbol"?t:String(t)}function qZ(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XZ=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;YZ(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return KZ(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),s=this.rowUtils.getHeight(a);s?o.firstChild.style.height="".concat(s-1,"px"):o.firstChild.style.height=""}}}}]),e}();function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function QZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eq(n.key),n)}}function JZ(e,t,r){return t&&Y2(e.prototype,t),r&&Y2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eq(e){var t=tq(e,"string");return Ds(t)==="symbol"?t:String(t)}function tq(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rq=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,o=t.TBODY,a=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;QZ(this,e),this.renderer=new XZ(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new oZ,columnHeaders:new mZ(n),colGroup:new TZ(i),rows:new DZ(o),cells:new GZ}),this.renderer.setAxisUtils(a,s)}return JZ(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function nq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oq(n.key),n)}}function iq(e,t,r){return t&&K2(e.prototype,t),r&&K2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oq(e){var t=aq(e,"string");return Hs(t)==="symbol"?t:String(t)}function aq(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sq=function(){function e(t,r){nq(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return iq(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,a=n.cloneSource,s=a?a.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?$t():0,u=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,h=r.getSetting("defaultColumnWidth"),d=0;d<c;d++){var f=Array.isArray(u)?u[d]:u;f=f??h,this.headerWidths.set(d,f)}}}]),e}();function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function lq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cq(n.key),n)}}function uq(e,t,r){return t&&Z2(e.prototype,t),r&&Z2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cq(e){var t=fq(e,"string");return Ls(t)==="symbol"?t:String(t)}function fq(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hq=function(){function e(t,r){lq(this,e),this.dataAccessObject=t,this.wtSettings=r}return uq(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function dq(e){return yq(e)||mq(e)||q2(e)||vq()}function vq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yq(e){if(Array.isArray(e))return py(e)}function pq(e,t){return wq(e)||bq(e,t)||q2(e,t)||gq()}function gq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q2(e,t){if(e){if(typeof e=="string")return py(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return py(e,t)}}function py(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function wq(e){if(Array.isArray(e))return e}function Sq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q2(n.key),n)}}function _q(e,t,r){return t&&X2(e.prototype,t),r&&X2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hr(e,t,r){return t=Q2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q2(e){var t=Cq(e,"string");return Fs(t)==="symbol"?t:String(t)}function Cq(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oq=function(){function e(t,r,n,i,o){var a=this;Sq(this,e),Hr(this,"wtSettings",null),Hr(this,"domBindings",void 0),Hr(this,"TBODY",null),Hr(this,"THEAD",null),Hr(this,"COLGROUP",null),Hr(this,"hasTableHeight",!0),Hr(this,"hasTableWidth",!0),Hr(this,"isTableVisible",!1),Hr(this,"tableOffset",0),Hr(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,oC(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new hq(this.dataAccessObject,this.wtSettings),this.columnUtils=new sq(this.dataAccessObject,this.wtSettings),this.tableRenderer=new rq({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return _q(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Je(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Je(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Je(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,a=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,h=n.getSetting("columnHeaders"),d=h.length,f=!1,v=r;if(this.isMaster&&(this.holderOffset=Pt(this.holder),v=a.createRenderCalculators(v),c&&!n.getSetting("fixedColumnsStart"))){var y=o.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(f=o.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Pt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var S=s>0?this.getFirstRenderedRow():0,_=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new pK(S,s,d),this.columnFilter=new hK(_,l,c);var O=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var R={};this.wtSettings.getSetting("beforeDraw",!0,R),O=R.skipRender!==!0}if(O){this.tableRenderer.setHeaderContentRenderers(u,h),(this.is(Lr)||this.is(An))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var T;if(this.isMaster&&(T=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Lr))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var D=ht(this.hider),H=ht(this.TABLE);D!==0&&H!==D&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),T!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Lr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var V=!1;return this.isMaster&&(V=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(V=o.bottomOverlay.resetFixedPosition()||V),V=o.inlineStartOverlay.resetFixedPosition()||V,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),V?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(v),f&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),a,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Rn(s),(!a&&o<l||a<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),a=0,s=o.length;a<s;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Lr))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var a=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)qe(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var o=Array.from(i),a=o.length;if(r){for(var s=[],l=0;l<a;l++){for(var u=o[l].settings,c=u.highlightHeaderClassName,h=u.highlightRowClassName,d=u.highlightColumnClassName,f=o[l].classNames,v=f.length,y=0;y<v;y++)s.includes(f[y])||s.push(f[y]);c&&!s.includes(c)&&s.push(c),h&&!s.includes(h)&&s.push(h),d&&!s.includes(d)&&s.push(d)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var S=0;S<m.length;S++)s.push(m[S]);for(var _=s.length,O=0;O<_;O++)this.removeClassFromCells(s[O])}for(var R=0;R<a;R++)o[R].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=pq(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[o];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=nC(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=cz(i),s=n.cellIndex;if(si(vi,n,this.wtRootElement)||si(hi,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(si(An,n,this.wtRootElement)||si(Lr,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");a=l-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return si(vi,n,this.wtRootElement)||si(di,n,this.wtRootElement)||si(An,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Rn(this.TBODY)-1,o,a,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),o=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=Rn(u):a=Rn(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<a||o<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ht(this.TABLE)}},{key:"getHeight",value:function(){return Zt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ht(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Zt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return yc(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=Xe(r)?r():null;return Array.isArray(n)?(n=dq(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const So=Oq;var Tq="stickyRowsBottom",J2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Zr(J2,"MIXIN_NAME",Tq,{writable:!1,enumerable:!1});const eO=J2;var Rq="stickyColumnsStart",tO={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Zr(tO,"MIXIN_NAME",Rq,{writable:!1,enumerable:!1});const gy=tO;function _o(e){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o(e)}function rO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kq(n.key),n)}}function Eq(e,t,r){return t&&rO(e.prototype,t),r&&rO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kq(e){var t=Aq(e,"string");return _o(t)==="symbol"?t:String(t)}function Aq(e,t){if(_o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&by(e,t)}function by(e,t){return by=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},by(e,t)}function Pq(e){var t=Nq();return function(){var n=zc(e),i;if(t){var o=zc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $q(this,i)}}function $q(e,t){if(t&&(_o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mq(e)}function Mq(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zc(e){return zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zc(e)}var wy=function(e){Iq(r,e);var t=Pq(r);function r(n,i,o,a){return xq(this,r),t.call(this,n,i,o,a,An)}return Eq(r)}(So);it(wy,eO),it(wy,gy);const Dq=wy;var hi="top",Lr="bottom",di="inline_start",vi="top_inline_start_corner",An="bottom_inline_start_corner",Hq=[hi,Lr,di,vi,An],Lq=new Map([[hi,"ht_clone_".concat(hi)],[Lr,"ht_clone_".concat(Lr)],[di,"ht_clone_".concat(di," ht_clone_left")],[vi,"ht_clone_".concat(vi," ht_clone_top_left_corner")],[An,"ht_clone_".concat(An," ht_clone_bottom_left_corner")]]);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function Fq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iO(n.key),n)}}function jq(e,t,r){return t&&nO(e.prototype,t),r&&nO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sy(e,t,r){return t=iO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iO(e){var t=Bq(e,"string");return js(t)==="symbol"?t:String(t)}function Bq(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wq=function(){function e(t){Fq(this,e),Sy(this,"dataAccessObject",void 0),Sy(this,"lastScrolledColumnPos",-1),Sy(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return jq(e,[{key:"scrollViewport",value:function(r,n,i,o,a){var s=this.scrollViewportHorizontally(r.col,i,a),l=this.scrollViewportVertically(r.row,n,o);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&i===void 0,h=this.dataAccessObject,d=h.fixedColumnsStart,f=h.inlineStartOverlay;if(c&&r<d)return!1;var v=!1;return l===-1?v=f.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<l||r>u)||!c)&&(v=f.scrollTo(r,c?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalRows;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&i===void 0,h=this.dataAccessObject,d=h.fixedRowsBottom,f=h.fixedRowsTop,v=h.topOverlay;if(c&&(r<f||r>s-d-1))return!1;var y=!1;return l===-1?y=v.scrollTo(r,c?r>this.lastScrolledRowPos:i):(c&&(r<l||r>u)||!c)&&(y=v.scrollTo(r,c?r>u:i)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var c=Pt(i.wtRootElement),h=Rn(i.hider),d=Rn(l),f=pc(l,l);if(c.top+h-d<=f){var v=o.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),c.top+h-v<=f){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=Pt(i.wtRootElement),c=pc(s,s);if(u.top>c){for(var h=Rn(s),d=o.getColumnHeaderHeight(),f=1;f<=a;f++)if(d+=n.sumCellSizes(f-1,f),u.top+d-c>=h){l=f-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=Pt(i.wtRootElement),c=wc(i.hider),h=wc(s),d=Math.abs(Cm(s,s));if(u.left+c-h<=d){for(var f=o.getRowHeaderWidth(),v=a;v>0;v--)if(f+=n.sumCellSizes(v-1,v),u.left+c-f<=d){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,a=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=o.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var c=n.getSetting("rtlMode"),h=null;if(c){var d=o.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document,v=f.documentElement.offsetWidth;h=Math.abs(d.right-v)}else{var y=Pt(o.wtRootElement);h=y.left}var m=Math.abs(Cm(l,l));if(h>m){for(var S=wc(l),_=a.getRowHeaderWidth(),O=1;O<=s;O++)if(_+=i.sumCellSizes(O-1,O),h+_-m>=S){u=O-2;break}}}return u}}]),e}();const Vq=Wq;function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function zq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aO(n.key),n)}}function Uq(e,t,r){return t&&oO(e.prototype,t),r&&oO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sr(e,t,r){return t=aO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aO(e){var t=Gq(e,"string");return Bs(t)==="symbol"?t:String(t)}function Gq(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _y=function(){function e(t,r){zq(this,e),Sr(this,"wtTable",void 0),Sr(this,"wtScroll",void 0),Sr(this,"wtViewport",void 0),Sr(this,"wtOverlays",void 0),Sr(this,"selections",void 0),Sr(this,"wtEvent",void 0),Sr(this,"guid","wt_".concat(eC())),Sr(this,"drawInterrupted",!1),Sr(this,"drawn",!1),Sr(this,"domBindings",void 0),Sr(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Vq(this.createScrollDao())}return Uq(e,[{key:"eventManager",get:function(){return new En(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,a){ms(a,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new Nc(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new sy(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Co(e){"@babel/helpers - typeof";return Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(e)}function sO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uO(n.key),n)}}function Yq(e,t,r){return t&&sO(e.prototype,t),r&&sO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cy(e,t)}function Cy(e,t){return Cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Cy(e,t)}function qq(e){var t=Qq();return function(){var n=Gc(e),i;if(t){var o=Gc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xq(this,i)}}function Xq(e,t){if(t&&(Co(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uc(e)}function Uc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gc(e){return Gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gc(e)}function lO(e,t,r){return t=uO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uO(e){var t=Jq(e,"string");return Co(t)==="symbol"?t:String(t)}function Jq(e,t){if(Co(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Co(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eX=function(e){Zq(r,e);var t=qq(r);function r(n,i,o){var a;Kq(this,r),a=t.call(this,n,i),lO(Uc(a),"cloneSource",void 0),lO(Uc(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",Uc(a));return a.cloneSource=o.source,a.cloneOverlay=o.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=o.viewport,a.selections=o.selections,a.wtEvent=new E2(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,o.event),a.findOriginalHeaders(),a}return Yq(r)}(_y);function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function tX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fO(n.key),n)}}function rX(e,t,r){return t&&cO(e.prototype,t),r&&cO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nX(e,t,r){return t=fO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fO(e){var t=iX(e,"string");return Ws(t)==="symbol"?t:String(t)}function iX(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vs=function(){function e(t,r,n,i,o){tX(this,e),nX(this,"wtSettings",null),Zr(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,h=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=h,this.trimmingContainer=bc(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return rX(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=bc(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=gc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Ic("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,a=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},h={start:this.getRelativeStartPosition(r),top:r.offsetTop},d=null;return o?d=this.getRelativeCellPositionWithinWindow(s,a,h,c):d=this.getRelativeCellPositionWithinHolder(s,l,a,h,c),d}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=o.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+$t())),s=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top-a.top}else l=o.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,a){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),h=this.clone.wtTable.TABLE.getBoundingClientRect();u=h.top*-1+c.top}else r||(u=s.vertical-a.top);return{start:o.start-l,top:o.top-u}}},{key:"makeClone",value:function(){if(Hq.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;a.className="".concat(Lq.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,s.className=r.TABLE.className,a.appendChild(s),l.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===hi||u==="vertical"&&this.type===di?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=gc(r.TABLE),new eX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,a=r.parentNode.style;Ce([i,o,a],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Oo(e){"@babel/helpers - typeof";return Oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oo(e)}function Yc(e,t,r){return dO()?Yc=Reflect.construct.bind():Yc=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Kc(u,a.prototype),u},Yc.apply(null,arguments)}function oX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sX(n.key),n)}}function aX(e,t,r){return t&&hO(e.prototype,t),r&&hO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sX(e){var t=lX(e,"string");return Oo(t)==="symbol"?t:String(t)}function lX(e,t){if(Oo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kc(e,t)}function Kc(e,t){return Kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Kc(e,t)}function cX(e){var t=dO();return function(){var n=Zc(e),i;if(t){var o=Zc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fX(this,i)}}function fX(e,t){if(t&&(Oo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hX(e)}function hX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zc(e){return Zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zc(e)}var dX=function(e){uX(r,e);var t=cX(r);function r(n,i,o,a,s,l){var u;return oX(this,r),u=t.call(this,n,i,An,o,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return aX(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Yc(Dq,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(a,"px"),o.style.bottom="".concat(s,"px")}else Sc(o),this.repositionOverlay();var l=Zt(this.clone.wtTable.TABLE),u=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=$t(s)),l.style.bottom="".concat(u,"px")}}]),r}(Vs),vX="calculatedColumns",vO={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Zr(vO,"MIXIN_NAME",vX,{writable:!1,enumerable:!1});const Oy=vO;function To(e){"@babel/helpers - typeof";return To=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},To(e)}function mO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yX(n.key),n)}}function mX(e,t,r){return t&&mO(e.prototype,t),r&&mO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yX(e){var t=pX(e,"string");return To(t)==="symbol"?t:String(t)}function pX(e,t){if(To(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(To(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ty(e,t)}function Ty(e,t){return Ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ty(e,t)}function wX(e){var t=CX();return function(){var n=qc(e),i;if(t){var o=qc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SX(this,i)}}function SX(e,t){if(t&&(To(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _X(e)}function _X(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qc(e){return qc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qc(e)}var Ry=function(e){bX(r,e);var t=wX(r);function r(n,i,o,a){return gX(this,r),t.call(this,n,i,o,a,Lr)}return mX(r)}(So);it(Ry,eO),it(Ry,Oy);const OX=Ry;function Ro(e){"@babel/helpers - typeof";return Ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(e)}function Xc(e,t,r){return gO()?Xc=Reflect.construct.bind():Xc=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Qc(u,a.prototype),u},Xc.apply(null,arguments)}function TX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bO(n.key),n)}}function RX(e,t,r){return t&&yO(e.prototype,t),r&&yO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qc(e,t)}function Qc(e,t){return Qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qc(e,t)}function kX(e){var t=gO();return function(){var n=Jc(e),i;if(t){var o=Jc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return AX(this,i)}}function AX(e,t){if(t&&(Ro(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pO(e)}function pO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jc(e){return Jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jc(e)}function xX(e,t,r){return t=bO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bO(e){var t=IX(e,"string");return Ro(t)==="symbol"?t:String(t)}function IX(e,t){if(Ro(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ro(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PX=function(e){EX(r,e);var t=kX(r);function r(n,i,o,a){var s;return TX(this,r),s=t.call(this,n,i,Lr,o,a),xX(pO(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return RX(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Xc(OX,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var a=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(a=this.getOverlayOffset(),o.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=$t(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(_m(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.getSetting("defaultRowHeight"),c=i,h=0;c<o;){var d=s.getRowHeight(c);h+=d===void 0?u:d,c+=1}return h}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,c=$t(l),h=this.clone.wtTable.holder.parentNode,d=h.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||f==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=c),v=Math.min(v,o.wtRootElement.scrollWidth),d.width="".concat(v,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var y=Zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),d.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;o&&l.offsetHeight!==l.clientHeight&&(u=$t(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return pc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+s,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((a||o===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,c=Je(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Ae(u,"innerBorderBottom"),l=!c):(qe(u,"innerBorderBottom"),l=c)}return l}}]),r}(Vs),$X="calculatedRows",wO={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Zr(wO,"MIXIN_NAME",$X,{writable:!1,enumerable:!1});const SO=wO;function Eo(e){"@babel/helpers - typeof";return Eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eo(e)}function _O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NX(n.key),n)}}function MX(e,t,r){return t&&_O(e.prototype,t),r&&_O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NX(e){var t=DX(e,"string");return Eo(t)==="symbol"?t:String(t)}function DX(e,t){if(Eo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ey(e,t)}function Ey(e,t){return Ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ey(e,t)}function FX(e){var t=WX();return function(){var n=ef(e),i;if(t){var o=ef(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jX(this,i)}}function jX(e,t){if(t&&(Eo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BX(e)}function BX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ef(e){return ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ef(e)}var ky=function(e){LX(r,e);var t=FX(r);function r(n,i,o,a){return HX(this,r),t.call(this,n,i,o,a,di)}return MX(r)}(So);it(ky,SO),it(ky,gy);const VX=ky;function ko(e){"@babel/helpers - typeof";return ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(e)}function tf(e,t,r){return OO()?tf=Reflect.construct.bind():tf=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&rf(u,a.prototype),u},tf.apply(null,arguments)}function zX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GX(n.key),n)}}function UX(e,t,r){return t&&CO(e.prototype,t),r&&CO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GX(e){var t=YX(e,"string");return ko(t)==="symbol"?t:String(t)}function YX(e,t){if(ko(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ko(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rf(e,t)}function rf(e,t){return rf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rf(e,t)}function ZX(e){var t=OO();return function(){var n=nf(e),i;if(t){var o=nf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qX(this,i)}}function qX(e,t){if(t&&(ko(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XX(e)}function XX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nf(e){return nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nf(e)}var QX=function(e){KX(r,e);var t=ZX(r);function r(n,i,o,a){return zX(this,r),t.call(this,n,i,di,o,a)}return UX(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return tf(VX,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===o&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),Rm(a,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),Sc(a));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,aC(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<o;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=$t(a),u=this.clone.wtTable.holder.parentNode,c=u.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||h==="vertical"){var d=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(d-=l),d=Math.min(d,i.wtRootElement.scrollHeight),c.height="".concat(d,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var f=ht(this.clone.wtTable.TABLE);c.width="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(o){var c=this.wot.wtTable.getColumnWidth(i),h=this.wot.wtViewport.getViewportWidth();c>h&&(o=!1)}return o&&l.offsetWidth!==l.clientWidth&&(u=$t(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(Cm(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?qe(o,"emptyRows"):Ae(o,"emptyRows");var u=!1;if(s&&!a.length)Ae(o,"innerBorderLeft innerBorderInlineStart");else if(!s&&a.length){var c=Je(o,"innerBorderInlineStart");i?(Ae(o,"innerBorderLeft innerBorderInlineStart"),u=!c):(qe(o,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(Vs),JX="stickyRowsTop",TO={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Zr(TO,"MIXIN_NAME",JX,{writable:!1,enumerable:!1});const RO=TO;function Ao(e){"@babel/helpers - typeof";return Ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(e)}function EO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tQ(n.key),n)}}function eQ(e,t,r){return t&&EO(e.prototype,t),r&&EO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tQ(e){var t=rQ(e,"string");return Ao(t)==="symbol"?t:String(t)}function rQ(e,t){if(Ao(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ao(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ay(e,t)}function Ay(e,t){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ay(e,t)}function oQ(e){var t=lQ();return function(){var n=of(e),i;if(t){var o=of(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return aQ(this,i)}}function aQ(e,t){if(t&&(Ao(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sQ(e)}function sQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}var xy=function(e){iQ(r,e);var t=oQ(r);function r(n,i,o,a){return nQ(this,r),t.call(this,n,i,o,a,vi)}return eQ(r)}(So);it(xy,RO),it(xy,gy);const uQ=xy;function xo(e){"@babel/helpers - typeof";return xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xo(e)}function af(e,t,r){return AO()?af=Reflect.construct.bind():af=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&sf(u,a.prototype),u},af.apply(null,arguments)}function cQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IO(n.key),n)}}function fQ(e,t,r){return t&&kO(e.prototype,t),r&&kO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sf(e,t)}function sf(e,t){return sf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sf(e,t)}function dQ(e){var t=AO();return function(){var n=lf(e),i;if(t){var o=lf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return vQ(this,i)}}function vQ(e,t){if(t&&(xo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iy(e)}function Iy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lf(e){return lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lf(e)}function xO(e,t,r){return t=IO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IO(e){var t=mQ(e,"string");return xo(t)==="symbol"?t:String(t)}function mQ(e,t){if(xo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yQ=function(e){hQ(r,e);var t=dQ(r);function r(n,i,o,a,s,l){var u;return cQ(this,r),u=t.call(this,n,i,vi,o,a),xO(Iy(u),"topOverlay",void 0),xO(Iy(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return fQ(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return af(uQ,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Rm(i,"".concat(o,"px"),"".concat(a,"px"))}else Sc(i);var s=Zt(this.clone.wtTable.TABLE),l=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(Vs);function Io(e){"@babel/helpers - typeof";return Io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(e)}function PO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQ(n.key),n)}}function pQ(e,t,r){return t&&PO(e.prototype,t),r&&PO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gQ(e){var t=bQ(e,"string");return Io(t)==="symbol"?t:String(t)}function bQ(e,t){if(Io(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Io(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Py(e,t)}function Py(e,t){return Py=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Py(e,t)}function _Q(e){var t=TQ();return function(){var n=uf(e),i;if(t){var o=uf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return CQ(this,i)}}function CQ(e,t){if(t&&(Io(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OQ(e)}function OQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uf(e){return uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uf(e)}var $y=function(e){SQ(r,e);var t=_Q(r);function r(n,i,o,a){return wQ(this,r),t.call(this,n,i,o,a,hi)}return pQ(r)}(So);it($y,RO),it($y,Oy);const RQ=$y;function Po(e){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Po(e)}function cf(e,t,r){return NO()?cf=Reflect.construct.bind():cf=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&ff(u,a.prototype),u},cf.apply(null,arguments)}function EQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DO(n.key),n)}}function kQ(e,t,r){return t&&$O(e.prototype,t),r&&$O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ff(e,t)}function ff(e,t){return ff=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ff(e,t)}function xQ(e){var t=NO();return function(){var n=hf(e),i;if(t){var o=hf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IQ(this,i)}}function IQ(e,t){if(t&&(Po(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MO(e)}function MO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hf(e){return hf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hf(e)}function PQ(e,t,r){return t=DO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DO(e){var t=$Q(e,"string");return Po(t)==="symbol"?t:String(t)}function $Q(e,t){if(Po(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Po(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MQ=function(e){AQ(r,e);var t=xQ(r);function r(n,i,o,a){var s;return EQ(this,r),s=t.call(this,n,i,hi,o,a),PQ(MO(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return kQ(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return cf(RQ,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===o&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),h=Math.ceil(c.bottom),d=i.offsetHeight;l=h===d,s=this.getOverlayOffset(),Rm(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),Sc(i);var f=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),f}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(_m(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<o;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=$t(a),u=this.clone.wtTable.holder.parentNode,c=u.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||h==="horizontal"){var d=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=l),d=Math.min(d,i.wtRootElement.scrollWidth),c.width="".concat(d,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var f=Zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),c.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,s=this.wtSettings,l=a.cloneSource?a.cloneSource:a,u=l.wtTable.holder,c=this.getTableParentOffset(),h=0;if(o){var d=this.wot.wtTable.getRowHeight(i),f=this.wot.wtViewport.getViewportHeight();d>f&&(o=!1)}if(o&&u.offsetHeight!==u.clientHeight&&(h=$t(this.domBindings.rootDocument)),o){var v=s.getSetting("fixedRowsBottom"),y=s.getSetting("totalRows");c+=this.sumCellSizes(0,i+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),c+=1}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return c+=h,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return pc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?qe(a,"emptyColumns"):Ae(a,"emptyColumns");var l=!1;if(!o){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,h=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&h.length>0){var d=Je(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Ae(a,"innerBorderTop"),l=!d):(qe(a,"innerBorderTop"),l=d)}}return l}}]),r}(Vs);function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function xn(e,t,r){return NQ()?xn=Reflect.construct.bind():xn=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&My(u,a.prototype),u},xn.apply(null,arguments)}function NQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function My(e,t){return My=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},My(e,t)}function DQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LO(n.key),n)}}function HQ(e,t,r){return t&&HO(e.prototype,t),r&&HO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function on(e,t,r){return t=LO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LO(e){var t=LQ(e,"string");return zs(t)==="symbol"?t:String(t)}function LQ(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FQ=function(){function e(t,r,n,i,o,a){var s=this;DQ(this,e),on(this,"wot",null),on(this,"topOverlay",null),on(this,"bottomOverlay",null),on(this,"inlineStartOverlay",null),on(this,"topInlineStartCornerOverlay",null),on(this,"bottomInlineStartCornerOverlay",null),on(this,"browserLineHeight",void 0),on(this,"wtSettings",null),on(this,"resizeObserver",new ResizeObserver(function(d){mS(function(){!Array.isArray(d)||!d.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=$t(u);var h=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?a.holder:gc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return HQ(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),a=parseInt(o.lineHeight,10),s=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=a||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=xn(MQ,r),this.bottomOverlay=xn(PX,r),this.inlineStartOverlay=xn(QX,r),this.topInlineStartCornerOverlay=xn(yQ,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=xn(dX,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,u=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),h={passive:u};(c||l||!zL())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,c)},h);var d=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];d.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(m){return r.onCloneWheel(m,c)},h)}});var f;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(f),f=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(o!==n&&a!==n&&!r.target.contains(o)||i!==n&&a!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==i&&s!==i&&!s.contains(a),u=o!==i&&s!==i&&!s.contains(o);if(!(this.keyPressed&&(l||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Uz(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),a=this.scrollHorizontally(i);return o||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],s=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=gc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,o),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,h=c.scrollHeight,d=c.scrollWidth,f=i.holder,v=f.scrollHeight,y=f.scrollWidth;this.hasScrollbarRight=h<v,this.hasScrollbarBottom=d<y,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>d?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return Ce(n,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Ce(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const jQ=FQ;function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function BQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BO(n.key),n)}}function WQ(e,t,r){return t&&FO(e.prototype,t),r&&FO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jO(e,t,r){return t=BO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BO(e){var t=VQ(e,"string");return Us(t)==="symbol"?t:String(t)}function VQ(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zQ=function(){function e(t){var r=this;BQ(this,e),jO(this,"settings",{}),jO(this,"defaults",Object.freeze(this.getDefaults())),We(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return WQ(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,a){var s=r.getSetting("data",i,o);ms(a,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?We(r,function(o,a){i.settings[a]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,a){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function $o(e){"@babel/helpers - typeof";return $o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(e)}function UQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YQ(n.key),n)}}function GQ(e,t,r){return t&&WO(e.prototype,t),r&&WO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YQ(e){var t=KQ(e,"string");return $o(t)==="symbol"?t:String(t)}function KQ(e,t){if($o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ny(e,t)}function Ny(e,t){return Ny=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ny(e,t)}function qQ(e){var t=JQ();return function(){var n=df(e),i;if(t){var o=df(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return XQ(this,i)}}function XQ(e,t){if(t&&($o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QQ(e)}function QQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function df(e){return df=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},df(e)}var Dy=function(e){ZQ(r,e);var t=qQ(r);function r(n,i,o,a){return UQ(this,r),t.call(this,n,i,o,a,"master")}return GQ(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=bc(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=Om(i,"height",o),u=Om(i,"overflow",o),c=this.holder.style,h=i.scrollWidth,d=i.scrollHeight,f=i.getBoundingClientRect(),v=f.width,y=f.height,m=["auto","hidden","scroll"];if(s&&m.includes(u)){var S=i.cloneNode(!1);S.style.overflow="auto",S.style.position="absolute",i.nextElementSibling?s.insertBefore(S,i.nextElementSibling):s.appendChild(S);var _=parseInt(li(S,o).height,10);s.removeChild(S),_===0&&(y=0)}y=Math.min(y,d),c.height=l==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,h),c.width="".concat(v,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=yc(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,a="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!o.hasOversizedColumnHeadersMarked[a]){for(var u=i.getSetting("rowHeaders"),c=u.length,h=this.getRenderedColumnsCount(),d=0;d<l;d++)for(var f=-1*c;f<h;f++)this.markIfOversizedColumnHeader(f);o.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(So);it(Dy,SO),it(Dy,Oy);const eJ=Dy;function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function tJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nJ(n.key),n)}}function rJ(e,t,r){return t&&VO(e.prototype,t),r&&VO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nJ(e){var t=iJ(e,"string");return Gs(t)==="symbol"?t:String(t)}function iJ(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oJ=function(){function e(t,r,n,i,o){var a=this;tJ(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return rJ(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=Zt(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=c?h.right-s:h.left,f=s-d,v,y;if(u)return ht(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(f,s):v=Math.min(this.getContainerFillWidth(),f,s),a===o&&l>0&&this.sumColumnWidths(0,l-1)>v)return i.documentElement.clientWidth;if(a!==o&&(y=Om(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,ht(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return Pt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Zt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=ht(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ci,n=this.wtSettings,i=this.wtTable,o,a,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===ci?o=1/0:o=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),h=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,o-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(h-c,h),o-=s),i.holder.clientHeight===i.holder.offsetHeight?a=0:a=$t(this.domBindings.rootDocument),new SY({viewportSize:o,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(f){return i.getRowHeight(f)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ci,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&a>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);a+=l,o-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=$t(this.domBindings.rootDocument)),new oy({viewportSize:o,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return i.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,h){return n.getSetting("onBeforeStretchingColumnWidth",c,h)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(Rt),o=this.createColumnsCalculator(Rt);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(ci),this.columnsRenderCalculator=this.createColumnsCalculator(ci)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Rt),this.columnsVisibleCalculator=this.createColumnsCalculator(Rt)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.rowsRenderCalculator,s=a.startRow,l=a.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.columnsRenderCalculator,s=a.startColumn,l=a.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){We(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const aJ=oJ;function Mo(e){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(e)}function sJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uJ(n.key),n)}}function lJ(e,t,r){return t&&zO(e.prototype,t),r&&zO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uJ(e){var t=cJ(e,"string");return Mo(t)==="symbol"?t:String(t)}function cJ(e,t){if(Mo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hy(e,t)}function Hy(e,t){return Hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hy(e,t)}function hJ(e){var t=vJ();return function(){var n=vf(e),i;if(t){var o=vf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dJ(this,i)}}function dJ(e,t){if(t&&(Mo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ly(e)}function Ly(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vf(e){return vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vf(e)}var mJ=function(e){fJ(r,e);var t=hJ(r);function r(n,i){var o;sJ(this,r),o=t.call(this,n,new zQ(i));var a=o.wtSettings.getSetting("facade",Ly(o));return o.wtTable=new eJ(o.getTableDao(),a,o.domBindings,o.wtSettings),o.wtViewport=new aJ(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new E2(a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new jQ(Ly(o),a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return lJ(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],s=[];We(o,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),a.push(l)}),qe(this.wtTable.wtRootElement.parentNode,a),Ae(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(_y);function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function yJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gJ(n.key),n)}}function pJ(e,t,r){return t&&UO(e.prototype,t),r&&UO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gJ(e){var t=bJ(e,"string");return Ys(t)==="symbol"?t:String(t)}function bJ(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wJ=function(){function e(t){yJ(this,e),t instanceof _y?this._wot=t:this._initFromSettings(t)}return pJ(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new mJ(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wot.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,a){return this._wot.wtSettings.getSetting(r,n,i,o,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),GO=nt,SJ=Te,YO=Ee,_J=xa,CJ=Sa,OJ=Ut,TJ=Ra.f,KO=YO(TJ),RJ=YO([].push),EJ=GO&&SJ(function(){var e=Object.create(null);return e[2]=2,!KO(e,2)}),ZO=function(e){return function(t){for(var r=OJ(t),n=CJ(r),i=EJ&&_J(r)===null,o=n.length,a=0,s=[],l;o>a;)l=n[a++],(!GO||(i?l in r:KO(r,l)))&&RJ(s,e?[l,r[l]]:r[l]);return s}},kJ={entries:ZO(!0),values:ZO(!1)},AJ=we,xJ=kJ.values;AJ({target:"Object",stat:!0},{values:function(t){return xJ(t)}});function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function Fy(e,t){return MJ(e)||$J(e,t)||PJ(e,t)||IJ()}function IJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PJ(e,t){if(e){if(typeof e=="string")return qO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(e,t)}}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $J(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function MJ(e){if(Array.isArray(e))return e}function NJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HJ(n.key),n)}}function DJ(e,t,r){return t&&XO(e.prototype,t),r&&XO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HJ(e){var t=LJ(e,"string");return Ks(t)==="symbol"?t:String(t)}function LJ(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FJ=function(){function e(t,r){NJ(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return DJ(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Pm(r);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var s=i[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),o=l.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,o.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Sn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};We(a,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};We(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,a,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",c=this.selectionHandles.styles,h=c.top,d=c.topHitArea,f=c.bottom,v=c.bottomHitArea,y=parseInt(h.borderWidth,10),m=parseInt(h.width,10),S=parseInt(d.width,10),_=this.wot.wtTable.getWidth(),O=this.wot.wtTable.getHeight();h.top="".concat(parseInt(i-m-1,10),"px"),h[u]="".concat(parseInt(o-m-1,10),"px"),d.top="".concat(parseInt(i-S/4*3,10),"px"),d[u]="".concat(parseInt(o-S/4*3,10),"px");var R=Math.min(parseInt(o+a,10),_-m-y*2),T=Math.min(parseInt(o+a-S/4,10),_-S-y*2);f[u]="".concat(R,"px"),v[u]="".concat(T,"px");var D=Math.min(parseInt(i+s,10),O-m-y*2),H=Math.min(parseInt(i+s-S/4,10),O-S-y*2);f.top="".concat(D,"px"),v.top="".concat(H,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",d.display="block",this.isPartRange(r,n)?(f.display="none",v.display="none"):(f.display="block",v.display="block")):(h.display="none",f.display="none",d.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",d.zIndex="9999"):(h.zIndex="",d.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s,l,u,c,h,d,f=i.getRenderedRowsCount(),v=0;v<f;v+=1){var y=i.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){s=y,h=r[0];break}}for(var m=f-1;m>=0;m-=1){var S=i.rowFilter.renderedToSource(m);if(S>=r[0]&&S<=r[2]){l=S;break}}for(var _=i.getRenderedColumnsCount(),O=0;O<_;O+=1){var R=i.columnFilter.renderedToSource(O);if(R>=r[1]&&R<=r[3]){u=R,d=r[1];break}}for(var T=_-1;T>=0;T-=1){var D=i.columnFilter.renderedToSource(T);if(D>=r[1]&&D<=r[3]){c=D;break}}if(s===void 0||u===void 0){this.disappear();return}var H=i.getCell(this.wot.createCellCoords(s,u)),V=s!==l||u!==c,F=V?i.getCell(this.wot.createCellCoords(l,c)):H,q=Pt(H),le=V?Pt(F):q,I=Pt(i.TABLE),j=ht(i.TABLE),C=q.top,z=q.left,fe=this.wot.wtSettings.getSetting("rtlMode"),G=0,ve=0;if(fe){var Q=ht(H),g=a.innerWidth-I.left-j;ve=z+Q-le.left,G=a.innerWidth-z-Q-g-1}else ve=le.left+ht(F)-z,G=z-I.left-1;if(this.isEntireColumnSelected(s,l)){var p=this.getDimensionsFromHeader("columns",u,c,h,I),w=null;if(p){var x=Fy(p,3);w=x[0],G=x[1],ve=x[2]}w&&(H=w)}var k=C-I.top-1,P=le.top+Zt(F)-C;if(this.isEntireRowSelected(u,c)){var N=this.getDimensionsFromHeader("rows",s,l,d,I),Z=null;if(N){var U=Fy(N,3);Z=U[0],k=U[1],P=U[2]}Z&&(H=Z)}var X=li(H,a);parseInt(X.borderTopWidth,10)>0&&(k+=1,P=P>0?P-1:0),parseInt(X[fe?"borderRightWidth":"borderLeftWidth"],10)>0&&(G+=1,ve=ve>0?ve-1:0);var ne=fe?"right":"left";this.topStyle.top="".concat(k,"px"),this.topStyle[ne]="".concat(G,"px"),this.topStyle.width="".concat(ve,"px"),this.topStyle.display="block",this.startStyle.top="".concat(k,"px"),this.startStyle[ne]="".concat(G,"px"),this.startStyle.height="".concat(P,"px"),this.startStyle.display="block";var ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(k+P-ie,"px"),this.bottomStyle[ne]="".concat(G,"px"),this.bottomStyle.width="".concat(ve,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(k,"px"),this.endStyle[ne]="".concat(G+ve-ie,"px"),this.endStyle.height="".concat(P+1,"px"),this.endStyle.display="block";var ge=this.settings.border.cornerVisible;ge=typeof ge=="function"?ge(this.settings.layerLevel):ge;var be=this.wot.getSetting("onModifyGetCellCoords",l,c),b=l,W=c;if(be&&Array.isArray(be)){var B=Fy(be,4);b=B[2],W=B[3]}if(Sn()||!ge||this.isPartRange(b,W))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(k+P+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ne]="".concat(G+ve+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var A=bc(i.TABLE),E=A===a;E&&(A=o.documentElement);var $=parseInt(this.cornerDefaultStyle.width,10)/2,Y=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var K=E?F.getBoundingClientRect().left:F.offsetLeft,L=!1,J=0;fe?(J=K-parseInt(this.cornerDefaultStyle.width,10)/2,L=J<0):(J=K+ht(F)+parseInt(this.cornerDefaultStyle.width,10)/2,L=J>=wc(A)),L&&(this.cornerStyle[ne]="".concat(Math.floor(G+ve+this.cornerCenterPointOffset-$),"px"),this.cornerStyle[fe?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var oe=E?F.getBoundingClientRect().top:F.offsetTop,ee=oe+Zt(F)+parseInt(this.cornerDefaultStyle.height,10)/2,de=ee>=Rn(A);de&&(this.cornerStyle.top="".concat(Math.floor(k+P+this.cornerCenterPointOffset-Y),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Sn()&&this.updateMultipleSelectionHandlesPosition(l,c,k,G,ve,P)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,c=null,h=null,d=null,f=null,v=null,y=null,m=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},c=function(){return Zt.apply(void 0,arguments)},h="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},c=function(){return ht.apply(void 0,arguments)},h="ht__selection--columns",v="left";break}if(l.classList.contains(h)){var S=this.wot.getSetting("columnHeaders").length;if(y=u(n,S-o),m=u(i,S-o),!y||!m)return!1;var _=Pt(y),O=Pt(m);return y&&m&&(d=_[v]-a[v]-1,f=O[v]+c(m)-_[v]),[y,d,f]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?Ae(this[r],"hidden"):(Je(this[r],"hidden")&&qe(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Ae(this[r],"hidden"):qe(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Sn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const jJ=FJ;function BJ(e,t){return UJ(e)||zJ(e,t)||VJ(e,t)||WJ()}function WJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VJ(e,t){if(e){if(typeof e=="string")return QO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(e,t)}}function QO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function UJ(e){if(Array.isArray(e))return e}function No(e){"@babel/helpers - typeof";return No=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},No(e)}function GJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KJ(n.key),n)}}function YJ(e,t,r){return t&&JO(e.prototype,t),r&&JO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KJ(e){var t=ZJ(e,"string");return No(t)==="symbol"?t:String(t)}function ZJ(e,t){if(No(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(No(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qJ=function(){function e(t,r){GJ(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return YJ(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new jJ(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(No(s)==="object"){var l=o;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),Ae(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(Je(o,u)){var c=s+1;l="".concat(r,"-").concat(c)}else l=i(o,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=BJ(o,4),s=a[0],l=a[1],u=a[2],c=a[3],h=this.settings,d=h.highlightHeaderClassName,f=h.highlightColumnClassName,v=h.highlightRowClassName,y=h.highlightOnlyClosestHeader,m=h.selectionType,S=m===void 0||["active-header","header"].includes(m);if(S&&l!==null&&c!==null)for(var _=0,O=0;O<i;O+=1){var R=r.wtTable.columnFilter.renderedToSource(O);if(R>=l&&R<=c){var T=r.wtTable.getColumnHeaders(R),D=T.length-1;y&&T.length>1&&(T=[T[D]]);for(var H=0;H<T.length;H+=1){var V=[],F=T[H];d&&V.push(d),f&&V.push(f),H=y?D:H;var q=r.getSetting("onBeforeHighlightingColumnHeader",R,H,{selectionType:m,columnCursor:_,selectionWidth:c-l+1,classNames:V});q!==R&&(F=r.wtTable.getColumnHeader(q,H)),Ae(F,V)}_+=1}}if(s!==null&&u!==null)for(var le=0,I=0;I<n;I+=1){var j=r.wtTable.rowFilter.renderedToSource(I);if(S&&j>=s&&j<=u){var C=r.wtTable.getRowHeaders(j),z=C.length-1;y&&C.length>1&&(C=[C[z]]);for(var fe=0;fe<C.length;fe+=1){var G=[],ve=C[fe];d&&G.push(d),v&&G.push(v),fe=y?z:fe;var Q=r.getSetting("onBeforeHighlightingRowHeader",j,fe,{selectionType:m,rowCursor:le,selectionHeight:u-s+1,classNames:G});Q!==j&&(ve=r.wtTable.getRowHeader(Q,fe)),Ae(ve,G)}le+=1}if(l!==null&&c!==null)for(var g=0;g<i;g+=1){var p=r.wtTable.columnFilter.renderedToSource(g);j>=s&&j<=u&&p>=l&&p<=c?this.settings.className&&this.addClassAtCoords(r,j,p,this.settings.className,this.settings.markIntersections):j>=s&&j<=u?v&&this.addClassAtCoords(r,j,p,v):p>=l&&p<=c&&f&&this.addClassAtCoords(r,j,p,f);var w=r.getSetting("onAfterDrawSelection",j,p,this.settings.layerLevel);typeof w=="string"&&this.addClassAtCoords(r,j,p,w)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const XJ=qJ;function eT(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,o=e.selection,a=e.controller,s=e.cellCoordsFactory,l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):c&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!a.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function QJ(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(o(u-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var JJ=new Map([["mousedown",eT],["mouseover",QJ],["touchstart",eT]]);function tT(e,t){var r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;JJ.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:RC(e)||e.type==="touchstart",isRightClick:xc(e)})}var rT=new WeakMap,jy=Symbol("rootInstance");function eee(e){rT.set(e,!0)}function tee(e){return e===jy}function By(e){return rT.has(e)}function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function qs(e,t){return iee(e)||nee(e,t)||iT(e,t)||ree()}function ree(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function iee(e){if(Array.isArray(e))return e}function nT(e){return see(e)||aee(e)||iT(e)||oee()}function oee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iT(e,t){if(e){if(typeof e=="string")return Wy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wy(e,t)}}function aee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function see(e){if(Array.isArray(e))return Wy(e)}function Wy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sT(n.key),n)}}function uee(e,t,r){return t&&oT(e.prototype,t),r&&oT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aT(e,t,r){cee(e,t),t.set(e,r)}function cee(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function In(e,t,r){return t=sT(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sT(e){var t=fee(e,"string");return Zs(t)==="symbol"?t:String(t)}function fee(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lT(e,t){var r=cT(e,t,"get");return hee(e,r)}function hee(e,t){return t.get?t.get.call(e):t.value}function uT(e,t,r){var n=cT(e,t,"set");return dee(e,n,r),r}function cT(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dee(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var mi=new WeakMap,Vy=new WeakMap,zy=new WeakMap,vee=function(){function e(t){lee(this,e),In(this,"instance",void 0),In(this,"eventManager",void 0),In(this,"settings",void 0),In(this,"THEAD",void 0),In(this,"TBODY",void 0),In(this,"_wt",void 0),In(this,"activeWt",void 0),aT(this,Vy,{writable:!0,value:0}),aT(this,zy,{writable:!0,value:0}),In(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new En(this.instance),this.settings=this.instance.getSettings(),mi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return uee(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wt.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=mi.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),Ae(i,"handsontable"),r.table=o.createElement("TABLE"),Ae(r.table,"htCore"),this.instance.getSettings().tableClassName&&Ae(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=mi.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,s=i.selection,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;sC(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&sC(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&RC(u)&&s.finish(),n.mouseDown=!1,(km(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!o.contains(u.target)&&!xc(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&xc(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var c=u.target,h=u.x||u.clientX,d=u.y||u.clientY,f=u.target;if(!(n.mouseDown||!o||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(f===v){var y=$t(a);if(a.elementFromPoint(h+y,d)!==v||a.elementFromPoint(h,d+y)!==v)return}else for(;f!==l;){if(f===null){if(u.isTargetWebComponent)break;return}if(f===o)return;f=f.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Em(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,nT(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var a=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=o-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=mi.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return By(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,h){var d;return(d=r.instance).getDataAtCell.apply(d,nT(r.translateFromRenderableToVisualIndex(c,h)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(h,d){var f=h>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(h):h;r.appendRowHeader(f,d)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),uT(r,zy,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(h,d){var f=h>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(h):h;r.appendColHeader(f,d)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),uT(r,Vy,c.length),c},columnWidth:function(c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(h===null?c:h)},rowHeight:function(c){var h=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(h===null?c:h)},cellRenderer:function(c,h,d){var f=r.translateFromRenderableToVisualIndex(c,h),v=qs(f,2),y=v[0],m=v[1],S=r.instance.runHooks("modifyGetCellCoords",y,m),_=y,O=m;if(Array.isArray(S)){var R=qs(S,2);_=R[0],O=R[1]}var T=r.instance.getCellMeta(_,O),D=r.instance.colToProp(O),H=r.instance.getDataAtRowProp(_,D);r.instance.hasHook("beforeValueRender")&&(H=r.instance.runHooks("beforeValueRender",H,T)),r.instance.runHooks("beforeRenderer",d,y,m,D,H,T),r.instance.getCellRenderer(T)(r.instance,d,y,m,D,H,T),r.instance.runHooks("afterRenderer",d,y,m,D,H,T)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,h,d,f){var v=r.translateFromRenderableToVisualCoords(h),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=f,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,v,d,y),!co(c)&&(tT(c,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(S,_){return r.instance._createCellCoords(S,_)}}),r.instance.runHooks("afterOnCellMouseDown",c,v,d),r.activeWt=r._wt)},onCellContextMenu:function(c,h,d,f){var v=r.translateFromRenderableToVisualCoords(h);r.activeWt=f,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,v,d),!co(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,v,d),r.activeWt=r._wt)},onCellMouseOut:function(c,h,d,f){var v=r.translateFromRenderableToVisualCoords(h);r.activeWt=f,r.instance.runHooks("beforeOnCellMouseOut",c,v,d),!co(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,v,d),r.activeWt=r._wt)},onCellMouseOver:function(c,h,d,f){var v=r.translateFromRenderableToVisualCoords(h),y={row:!1,column:!1,cell:!1};r.activeWt=f,r.instance.runHooks("beforeOnCellMouseOver",c,v,d,y),!co(c)&&(n.mouseDown&&tT(c,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(S,_){return r.instance._createCellCoords(S,_)}}),r.instance.runHooks("afterOnCellMouseOver",c,v,d),r.activeWt=r._wt)},onCellMouseUp:function(c,h,d,f){var v=r.translateFromRenderableToVisualCoords(h);r.activeWt=f,r.instance.runHooks("beforeOnCellMouseUp",c,v,d),!(co(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,v,d),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,h){return r.beforeRender(c,h)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,h,d){var f=r.instance.rowIndexMapper,v=f.getVisualFromRenderableIndex(c),y=r.instance.runHooks("beforeHighlightingRowHeader",v,h,d);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(c,h,d){var f=r.instance.columnIndexMapper,v=f.getVisualFromRenderableIndex(c),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,h,d);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(c,h,d){var f,v=r.translateFromRenderableToVisualIndex(c,h),y=qs(v,2),m=y[0],S=y[1],_=r.instance.selection.getSelectedRange(),O=_.size();if(O>0){var R=(d??0)+1-O,T=_.peekByIndex(R);f=[T.from.row,T.from.col,T.to.row,T.to.col]}return r.instance.runHooks("afterDrawSelection",m,S,f,d)},onBeforeDrawBorders:function(c,h){var d=qs(c,4),f=d[0],v=d[1],y=d[2],m=d[3],S=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(f),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",S,h)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,h){var d=r.instance.columnIndexMapper.getVisualFromRenderableIndex(h);return r.instance.runHooks("beforeStretchingColumnWidth",c,d)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,h,d){var f=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=h>=0?v.getVisualFromRenderableIndex(h):h,m=c>=0?f.getVisualFromRenderableIndex(c):c,S=r.instance.runHooks("modifyGetCellCoords",m,y,d);if(Array.isArray(S)){var _=qs(S,4),O=_[0],R=_[1],T=_[2],D=_[3];return[O>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(O,1)):O,R>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(R,1)):R,T>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(T,-1)):T,D>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(D,-1)):D]}},viewportRowCalculatorOverride:function(c){var h=r.settings.viewportRowRenderingOffset;if(h==="auto"&&r.settings.fixedRowsTop&&(h=10),h>0||h==="auto"){var d=r.countRenderableRows(),f=c.startRow,v=c.endRow;if(typeof h=="number")c.startRow=Math.max(f-h,0),c.endRow=Math.min(v+h,d-1);else if(h==="auto"){var y=Math.ceil(v/d*12);c.startRow=Math.max(f-y,0),c.endRow=Math.min(v+y,d-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var h=r.settings.viewportColumnRenderingOffset;if(h==="auto"&&r.settings.fixedColumnsStart&&(h=10),h>0||h==="auto"){var d=r.countRenderableColumns(),f=c.startColumn,v=c.endColumn;if(typeof h=="number"&&(c.startColumn=Math.max(f-h,0),c.endColumn=Math.min(v+h,d-1)),h==="auto"){var y=Math.ceil(v/d*6);c.startColumn=Math.max(f-y,0),c.endColumn=Math.min(v+y,d-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new wJ(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(o,"mousedown",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Em(r))return!0;var n=pm(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return mi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Je(i,"relative")){lo(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,s=o.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;Je(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,i,o):(lo(n),this.appendColHeader(r,n,i,o))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,o),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Je(r,"colHeader")?a=s.wtTable.columnFilter.sourceToRendered(n):Je(r,"rowHeader")&&(a=s.wtTable.rowFilter.sourceToRendered(n))),a>-1?hz(r,i(n,o)):(ms(r," "),Ae(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=mi.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=mi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return lT(this,Vy)}},{key:"getRowHeadersCount",value:function(){return lT(this,zy)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}(),mee="ABCDEFGHIJKLMNOPQRSTUVWXYZ",fT=mee.length;function yee(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%fT,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/fT,10);return r}function hT(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&hr(e[0])&&(t=Cv(e[0]))),t}function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function pee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bee(n.key),n)}}function gee(e,t,r){return t&&dT(e.prototype,t),r&&dT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bee(e){var t=wee(e,"string");return Xs(t)==="symbol"?t:String(t)}function wee(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var See=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];pee(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return gee(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return Ce(this.data,function(o,a){var s=n.getAtCell(a,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(d,f){u[f]=o.getAtPhysicalCell(r,f,l)}):pt(n,i,function(d){u[d-n]=o.getAtPhysicalCell(r,d,l)});else if(hr(l)||Xe(l))if(a?u=[]:u={},!s||a){var c=0,h=this.countFirstRowKeys()-1;pt(c,h,function(d){var f=o.colToProp(d);if(d>=(n||c)&&d<=(i||h)&&!Number.isInteger(f)){var v=o.getAtPhysicalCell(r,f,l);a?u.push(v):_v(u,f,v)}})}else We(l,function(d,f){_v(u,f,o.getAtPhysicalCell(r,f,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=Xi(i);this.hot.runHooks("modifySourceData",r,n,o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:_v(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=BL(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=Xi(o);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,c=null;n===null||i===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),c=Math.max(n.col,i.col));var h=[];return pt(s,u,function(d){h.push(a?r.getAtRow(d,void 0,void 0,o):r.getAtRow(d,l,c,o))}),h}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return hT(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),vT=Qe,_ee=function(e){return e!==void 0&&(vT(e,"value")||vT(e,"writable"))},Cee=we,Oee=ct,Tee=tt,Ree=rt,Eee=_ee,kee=Vr,Aee=xa;function mT(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(Ree(e)===r)return e[t];if(n=kee.f(e,t),n)return Eee(n)?n.value:n.get===void 0?void 0:Oee(n.get,r);if(Tee(i=Aee(e)))return mT(i,t,r)}Cee({target:"Reflect",stat:!0},{get:mT});var xee=we,Iee=Te,Pee=Ut,yT=Vr.f,pT=nt,$ee=!pT||Iee(function(){yT(1)});xee({target:"Object",stat:!0,forced:$ee,sham:!pT},{getOwnPropertyDescriptor:function(t,r){return yT(Pee(t),r)}});var Mee="localHooks",gT={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,o,a,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)Am(this._localHooks[t][u],this,r,n,i,o,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Zr(gT,"MIXIN_NAME",Mee,{writable:!1,enumerable:!1});const Pn=gT;function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function Nee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hee(n.key),n)}}function Dee(e,t,r){return t&&bT(e.prototype,t),r&&bT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hee(e){var t=Lee(e,"string");return Qs(t)==="symbol"?t:String(t)}function Lee(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Js=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Nee(this,e),this.indexedValues=[],this.initValueOrFn=t}return Dee(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Xe(this.initValueOrFn)?pt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):pt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();it(Js,Pn);function Uy(e){return Wee(e)||Bee(e)||jee(e)||Fee()}function Fee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jee(e,t){if(e){if(typeof e=="string")return Gy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gy(e,t)}}function Bee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wee(e){if(Array.isArray(e))return Gy(e)}function Gy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wT(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(Uy(e.slice(0,i)),Uy(r.map(function(o,a){return Xe(n)?n(o,a):n})),Uy(i===void 0?[]:e.slice(i)))}function ST(e,t){return Qa(e,function(r,n){return t.includes(n)===!1})}function Do(e){"@babel/helpers - typeof";return Do=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(e)}function Vee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uee(n.key),n)}}function zee(e,t,r){return t&&_T(e.prototype,t),r&&_T(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uee(e){var t=Gee(e,"string");return Do(t)==="symbol"?t:String(t)}function Gee(e,t){if(Do(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Do(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function el(){return typeof Reflect<"u"&&Reflect.get?el=Reflect.get.bind():el=function(t,r,n){var i=Yee(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},el.apply(this,arguments)}function Yee(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function Kee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yy(e,t)}function Yy(e,t){return Yy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yy(e,t)}function Zee(e){var t=Qee();return function(){var n=yi(e),i;if(t){var o=yi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qee(this,i)}}function qee(e,t){if(t&&(Do(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xee(e)}function Xee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yi(e)}var mf=function(e){Kee(r,e);var t=Zee(r);function r(){return Vee(this,r),t.apply(this,arguments)}return zee(r,[{key:"insert",value:function(i,o){this.indexedValues=wT(this.indexedValues,i,o,this.initValueOrFn),el(yi(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=ST(this.indexedValues,i),el(yi(r.prototype),"remove",this).call(this,i)}}]),r}(Js);function Ho(e){"@babel/helpers - typeof";return Ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(e)}function Jee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tte(n.key),n)}}function ete(e,t,r){return t&&CT(e.prototype,t),r&&CT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tte(e){var t=rte(e,"string");return Ho(t)==="symbol"?t:String(t)}function rte(e,t){if(Ho(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ho(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ky(e,t)}function Ky(e,t){return Ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ky(e,t)}function ite(e){var t=ste();return function(){var n=yf(e),i;if(t){var o=yf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ote(this,i)}}function ote(e,t){if(t&&(Ho(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ate(e)}function ate(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ste(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yf(e){return yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yf(e)}var OT=function(e){nte(r,e);var t=ite(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Jee(this,r),t.call(this,n)}return ete(r,[{key:"getHiddenIndexes",value:function(){return Zi(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(mf);function Zy(e){return fte(e)||cte(e)||ute(e)||lte()}function lte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ute(e,t){if(e){if(typeof e=="string")return qy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qy(e,t)}}function cte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fte(e){if(Array.isArray(e))return qy(e)}function qy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TT(e,t,r){return[].concat(Zy(e.slice(0,t)),Zy(r),Zy(e.slice(t)))}function pf(e,t){return Qa(e,function(r){return t.includes(r)===!1})}function RT(e,t){return Yr(e,function(r){return r-t.filter(function(n){return n<r}).length})}function ET(e,t){var r=t[0],n=t.length;return Yr(e,function(i){return i>=r?i+n:i})}function Lo(e){"@babel/helpers - typeof";return Lo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lo(e)}function hte(e){return yte(e)||mte(e)||vte(e)||dte()}function dte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vte(e,t){if(e){if(typeof e=="string")return Xy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xy(e,t)}}function mte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yte(e){if(Array.isArray(e))return Xy(e)}function Xy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xT(n.key),n)}}function gte(e,t,r){return t&&kT(e.prototype,t),r&&kT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function an(){return typeof Reflect<"u"&&Reflect.get?an=Reflect.get.bind():an=function(t,r,n){var i=bte(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},an.apply(this,arguments)}function bte(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_r(e),e!==null););return e}function wte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qy(e,t)}function Qy(e,t){return Qy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qy(e,t)}function Ste(e){var t=Cte();return function(){var n=_r(e),i;if(t){var o=_r(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _te(this,i)}}function _te(e,t){if(t&&(Lo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AT(e)}function AT(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _r(e){return _r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_r(e)}function Ote(e,t,r){return t=xT(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xT(e){var t=Tte(e,"string");return Lo(t)==="symbol"?t:String(t)}function Tte(e,t){if(Lo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rte=function(e){wte(r,e);var t=Ste(r);function r(){var n;pte(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o)),Ote(AT(n),"orderOfIndexes",[]),n}return gte(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=hte(Array(i.length).keys()),an(_r(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=pf(this.orderOfIndexes,[i]),Xe(this.initValueOrFn)?an(_r(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):an(_r(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,an(_r(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=wT(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=ET(this.orderOfIndexes,o),an(_r(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=ST(this.indexedValues,i),this.orderOfIndexes=pf(this.orderOfIndexes,i),this.orderOfIndexes=RT(this.orderOfIndexes,i),an(_r(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(Js);function Fo(e){"@babel/helpers - typeof";return Fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(e)}function Ete(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ate(n.key),n)}}function kte(e,t,r){return t&&IT(e.prototype,t),r&&IT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ate(e){var t=xte(e,"string");return Fo(t)==="symbol"?t:String(t)}function xte(e,t){if(Fo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ite(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jy(e,t)}function Jy(e,t){return Jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jy(e,t)}function Pte(e){var t=Nte();return function(){var n=gf(e),i;if(t){var o=gf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $te(this,i)}}function $te(e,t){if(t&&(Fo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mte(e)}function Mte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gf(e){return gf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gf(e)}var PT=function(e){Ite(r,e);var t=Pte(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Ete(this,r),t.call(this,n)}return kte(r,[{key:"getTrimmedIndexes",value:function(){return Zi(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(mf);function jo(e){"@babel/helpers - typeof";return jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(e)}function Dte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lte(n.key),n)}}function Hte(e,t,r){return t&&$T(e.prototype,t),r&&$T(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lte(e){var t=Fte(e,"string");return jo(t)==="symbol"?t:String(t)}function Fte(e,t){if(jo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tl(){return typeof Reflect<"u"&&Reflect.get?tl=Reflect.get.bind():tl=function(t,r,n){var i=jte(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},tl.apply(this,arguments)}function jte(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function Bte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ep(e,t)}function ep(e,t){return ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ep(e,t)}function Wte(e){var t=Ute();return function(){var n=pi(e),i;if(t){var o=pi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Vte(this,i)}}function Vte(e,t){if(t&&(jo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zte(e)}function zte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ute(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pi(e)}var Gte=function(e){Bte(r,e);var t=Wte(r);function r(){return Dte(this,r),t.call(this,function(n){return n})}return Hte(r,[{key:"insert",value:function(i,o){var a=ET(this.indexedValues,o);this.indexedValues=TT(a,i,o),tl(pi(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=pf(this.indexedValues,i);this.indexedValues=RT(o,i),tl(pi(r.prototype),"remove",this).call(this,i)}}]),r}(Js),MT=new Map([["hiding",OT],["index",Js],["linkedPhysicalIndexToValue",Rte],["physicalIndexToValue",mf],["trimming",PT]]);function Yte(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!MT.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(MT.get(e))(t)}function rl(e){"@babel/helpers - typeof";return rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rl(e)}function Kte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qte(n.key),n)}}function Zte(e,t,r){return t&&NT(e.prototype,t),r&&NT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qte(e){var t=Xte(e,"string");return rl(t)==="symbol"?t:String(t)}function Xte(e,t){if(rl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tp=function(){function e(){Kte(this,e),this.collection=new Map}return Zte(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);Ie(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return Bt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();it(tp,Pn);function Bo(e){"@babel/helpers - typeof";return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(e)}function Qte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ere(n.key),n)}}function Jte(e,t,r){return t&&DT(e.prototype,t),r&&DT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ere(e){var t=tre(e,"string");return Bo(t)==="symbol"?t:String(t)}function tre(e,t){if(Bo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rp(e,t)}function rp(e,t){return rp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rp(e,t)}function nre(e){var t=are();return function(){var n=bf(e),i;if(t){var o=bf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ire(this,i)}}function ire(e,t){if(t&&(Bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ore(e)}function ore(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function are(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bf(e){return bf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bf(e)}var HT=function(e){rre(r,e);var t=nre(r);function r(n,i){var o;return Qte(this,r),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return Jte(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=Yr(this.get(),function(h){return h.getValues()}),a=[],s=Ie(o[0])&&o[0].length||0,l=0;l<s;l+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(o[c][l]);a.push(u)}return Yr(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return Ie(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(tp);function nl(e){"@babel/helpers - typeof";return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(e)}function sre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ure(n.key),n)}}function lre(e,t,r){return t&&LT(e.prototype,t),r&&LT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ure(e){var t=cre(e,"string");return nl(t)==="symbol"?t:String(t)}function cre(e,t){if(nl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fre(e,t,r){hre(e,t),t.set(e,r)}function hre(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dre(e,t,r){var n=FT(e,t,"set");return vre(e,n,r),r}function vre(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function mre(e,t){var r=FT(e,t,"get");return yre(e,r)}function FT(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function yre(e,t){return t.get?t.get.call(e):t.value}var np=new WeakMap,jT=function(){function e(){sre(this,e),fre(this,np,{writable:!0,value:[]})}return lre(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(mre(this,np)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){dre(this,np,r)}}]),e}();it(jT,Pn);function BT(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function il(e){"@babel/helpers - typeof";return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(e)}function pre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bre(n.key),n)}}function gre(e,t,r){return t&&WT(e.prototype,t),r&&WT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bre(e){var t=wre(e,"string");return il(t)==="symbol"?t:String(t)}function wre(e,t){if(il(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ol(e,t,r){Sre(e,t),t.set(e,r)}function Sre(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(e,t){var r=VT(e,t,"get");return _re(e,r)}function _re(e,t){return t.get?t.get.call(e):t.value}function wf(e,t,r){var n=VT(e,t,"set");return Cre(e,n,r),r}function VT(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Cre(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Sf=new WeakMap,al=new WeakMap,_f=new WeakMap,Cf=new WeakMap,Of=new WeakMap,Ore=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;pre(this,e),ol(this,Sf,{writable:!0,value:new Set}),ol(this,al,{writable:!0,value:[]}),ol(this,_f,{writable:!0,value:[]}),ol(this,Cf,{writable:!0,value:!1}),ol(this,Of,{writable:!0,value:!1}),wf(this,Of,r??!1)}return gre(e,[{key:"createObserver",value:function(){var r=this,n=new jT;return sr(this,Sf).add(n),n.addLocalHook("unsubscribe",function(){sr(r,Sf).delete(n)}),n._writeInitialChanges(BT(sr(this,al),sr(this,_f))),n}},{key:"emit",value:function(r){var n=sr(this,_f);(!sr(this,Cf)||sr(this,al).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(sr(this,Of)):wf(this,al,new Array(r.length).fill(sr(this,Of))),sr(this,Cf)||(wf(this,Cf,!0),n=sr(this,al)));var i=BT(n,r);sr(this,Sf).forEach(function(o){return o._write(i)}),wf(this,_f,r)}}]),e}();function sl(e){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}function ip(e){return kre(e)||Ere(e)||Rre(e)||Tre()}function Tre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rre(e,t){if(e){if(typeof e=="string")return op(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return op(e,t)}}function Ere(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kre(e){if(Array.isArray(e))return op(e)}function op(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Are(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ire(n.key),n)}}function xre(e,t,r){return t&&zT(e.prototype,t),r&&zT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ire(e){var t=Pre(e,"string");return sl(t)==="symbol"?t:String(t)}function Pre(e,t){if(sl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ap=function(){function e(){var t=this;Are(this,e),this.indexesSequence=new Gte,this.trimmingMapsCollection=new HT(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new HT(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new tp,this.hidingChangesObservable=new Ore({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return xre(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,Yte(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof PT?this.trimmingMapsCollection.register(r,n):n instanceof OT?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return Ie(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return Ie(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return Ie(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return Ie(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=a.findIndex(function(l){return l>r}):s=a.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:a[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=ip(new Array(r).keys()),this.notHiddenIndexesCache=ip(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=ip(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=Yr(r,function(h){return i.getPhysicalFromVisualIndex(h)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=pf(this.getIndexesSequence(),o),u=a-s;if(n+s<a){var c=l.filter(function(h){return i.isTrimmed(h)===!1})[n];u=l.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(TT(l,u,o)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=Ie(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Yr(new Array(n).fill(o),function(l,u){return l+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),e}();it(ap,Pn);var UT;function $re(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Mre(e,t){return We(t,function(r,n){Bt(e[n])&&(e[n]=r)}),e}function GT(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function YT(e){Ie(e)&&Gz(wr(UT||(UT=$re(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Nre(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var KT=ui("phraseFormatters"),Dre=KT.register,Hre=KT.getValues;function Lre(e,t){Dre(e,t)}function Fre(){return Hre()}Lre("pluralize",Nre);var ZT="ContextMenu:items",Oe=ZT,qT="".concat(Oe,".noItems"),XT="".concat(Oe,".insertRowAbove"),QT="".concat(Oe,".insertRowBelow"),JT="".concat(Oe,".insertColumnOnTheLeft"),eR="".concat(Oe,".insertColumnOnTheRight"),tR="".concat(Oe,".removeRow"),rR="".concat(Oe,".removeColumn"),nR="".concat(Oe,".undo"),iR="".concat(Oe,".redo"),oR="".concat(Oe,".readOnly"),aR="".concat(Oe,".clearColumn"),sp="".concat(Oe,".copy"),lp="".concat(Oe,".copyWithHeaders"),up="".concat(Oe,".copyWithGroupHeaders"),cp="".concat(Oe,".copyHeadersOnly"),fp="".concat(Oe,".cut"),sR="".concat(Oe,".freezeColumn"),lR="".concat(Oe,".unfreezeColumn"),uR="".concat(Oe,".mergeCells"),cR="".concat(Oe,".unmergeCells"),fR="".concat(Oe,".addComment"),hR="".concat(Oe,".editComment"),dR="".concat(Oe,".removeComment"),vR="".concat(Oe,".readOnlyComment"),mR="".concat(Oe,".align"),yR="".concat(Oe,".align.left"),pR="".concat(Oe,".align.center"),gR="".concat(Oe,".align.right"),bR="".concat(Oe,".align.justify"),wR="".concat(Oe,".align.top"),SR="".concat(Oe,".align.middle"),_R="".concat(Oe,".align.bottom"),CR="".concat(Oe,".borders"),OR="".concat(Oe,".borders.top"),TR="".concat(Oe,".borders.right"),RR="".concat(Oe,".borders.bottom"),ER="".concat(Oe,".borders.left"),kR="".concat(Oe,".borders.remove"),AR="".concat(Oe,".nestedHeaders.insertChildRow"),xR="".concat(Oe,".nestedHeaders.detachFromParent"),IR="".concat(Oe,".hideColumn"),PR="".concat(Oe,".showColumn"),$R="".concat(Oe,".hideRow"),MR="".concat(Oe,".showRow"),Wt="Filters:",et="".concat(Wt,"conditions"),NR="".concat(et,".none"),DR="".concat(et,".isEmpty"),HR="".concat(et,".isNotEmpty"),LR="".concat(et,".isEqualTo"),FR="".concat(et,".isNotEqualTo"),jR="".concat(et,".beginsWith"),BR="".concat(et,".endsWith"),WR="".concat(et,".contains"),VR="".concat(et,".doesNotContain"),jre="".concat(et,".byValue"),zR="".concat(et,".greaterThan"),UR="".concat(et,".greaterThanOrEqualTo"),GR="".concat(et,".lessThan"),YR="".concat(et,".lessThanOrEqualTo"),KR="".concat(et,".isBetween"),ZR="".concat(et,".isNotBetween"),qR="".concat(et,".after"),XR="".concat(et,".before"),QR="".concat(et,".today"),JR="".concat(et,".tomorrow"),eE="".concat(et,".yesterday"),tE="".concat(Wt,"labels.filterByCondition"),rE="".concat(Wt,"labels.filterByValue"),nE="".concat(Wt,"labels.conjunction"),iE="".concat(Wt,"labels.disjunction"),oE="".concat(Wt,"values.blankCells"),aE="".concat(Wt,"buttons.selectAll"),sE="".concat(Wt,"buttons.clear"),lE="".concat(Wt,"buttons.ok"),uE="".concat(Wt,"buttons.cancel"),cE="".concat(Wt,"buttons.placeholder.search"),fE="".concat(Wt,"buttons.placeholder.value"),hE="".concat(Wt,"buttons.placeholder.secondValue");const Bre=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:fR,CONTEXTMENU_ITEMS_ALIGNMENT:mR,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:_R,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:pR,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:bR,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:yR,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:SR,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:gR,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:wR,CONTEXTMENU_ITEMS_BORDERS:CR,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:RR,CONTEXTMENU_ITEMS_BORDERS_LEFT:ER,CONTEXTMENU_ITEMS_BORDERS_RIGHT:TR,CONTEXTMENU_ITEMS_BORDERS_TOP:OR,CONTEXTMENU_ITEMS_CLEAR_COLUMN:aR,CONTEXTMENU_ITEMS_COPY:sp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:cp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:up,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:lp,CONTEXTMENU_ITEMS_CUT:fp,CONTEXTMENU_ITEMS_EDIT_COMMENT:hR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:sR,CONTEXTMENU_ITEMS_HIDE_COLUMN:IR,CONTEXTMENU_ITEMS_HIDE_ROW:$R,CONTEXTMENU_ITEMS_INSERT_LEFT:JT,CONTEXTMENU_ITEMS_INSERT_RIGHT:eR,CONTEXTMENU_ITEMS_MERGE_CELLS:uR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:xR,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:AR,CONTEXTMENU_ITEMS_NO_ITEMS:qT,CONTEXTMENU_ITEMS_READ_ONLY:oR,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:vR,CONTEXTMENU_ITEMS_REDO:iR,CONTEXTMENU_ITEMS_REMOVE_BORDERS:kR,CONTEXTMENU_ITEMS_REMOVE_COLUMN:rR,CONTEXTMENU_ITEMS_REMOVE_COMMENT:dR,CONTEXTMENU_ITEMS_REMOVE_ROW:tR,CONTEXTMENU_ITEMS_ROW_ABOVE:XT,CONTEXTMENU_ITEMS_ROW_BELOW:QT,CONTEXTMENU_ITEMS_SHOW_COLUMN:PR,CONTEXTMENU_ITEMS_SHOW_ROW:MR,CONTEXTMENU_ITEMS_UNDO:nR,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:lR,CONTEXTMENU_ITEMS_UNMERGE_CELLS:cR,CONTEXT_MENU_ITEMS_NAMESPACE:ZT,FILTERS_BUTTONS_CANCEL:uE,FILTERS_BUTTONS_CLEAR:sE,FILTERS_BUTTONS_OK:lE,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:cE,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:hE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:fE,FILTERS_BUTTONS_SELECT_ALL:aE,FILTERS_CONDITIONS_AFTER:qR,FILTERS_CONDITIONS_BEFORE:XR,FILTERS_CONDITIONS_BEGINS_WITH:jR,FILTERS_CONDITIONS_BETWEEN:KR,FILTERS_CONDITIONS_BY_VALUE:jre,FILTERS_CONDITIONS_CONTAINS:WR,FILTERS_CONDITIONS_EMPTY:DR,FILTERS_CONDITIONS_ENDS_WITH:BR,FILTERS_CONDITIONS_EQUAL:LR,FILTERS_CONDITIONS_GREATER_THAN:zR,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:UR,FILTERS_CONDITIONS_LESS_THAN:GR,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:YR,FILTERS_CONDITIONS_NAMESPACE:et,FILTERS_CONDITIONS_NONE:NR,FILTERS_CONDITIONS_NOT_BETWEEN:ZR,FILTERS_CONDITIONS_NOT_CONTAIN:VR,FILTERS_CONDITIONS_NOT_EMPTY:HR,FILTERS_CONDITIONS_NOT_EQUAL:FR,FILTERS_CONDITIONS_TODAY:QR,FILTERS_CONDITIONS_TOMORROW:JR,FILTERS_CONDITIONS_YESTERDAY:eE,FILTERS_DIVS_FILTER_BY_CONDITION:tE,FILTERS_DIVS_FILTER_BY_VALUE:rE,FILTERS_LABELS_CONJUNCTION:nE,FILTERS_LABELS_DISJUNCTION:iE,FILTERS_NAMESPACE:Wt,FILTERS_VALUES_BLANK_CELLS:oE},Symbol.toStringTag,{value:"Module"}));function ll(e){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}var ae;function se(e,t,r){return t=Wre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wre(e){var t=Vre(e,"string");return ll(t)==="symbol"?t:String(t)}function Vre(e,t){if(ll(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dE=(ae={languageCode:"en-US"},se(ae,qT,"No available options"),se(ae,XT,"Insert row above"),se(ae,QT,"Insert row below"),se(ae,JT,"Insert column left"),se(ae,eR,"Insert column right"),se(ae,tR,["Remove row","Remove rows"]),se(ae,rR,["Remove column","Remove columns"]),se(ae,nR,"Undo"),se(ae,iR,"Redo"),se(ae,oR,"Read only"),se(ae,aR,"Clear column"),se(ae,mR,"Alignment"),se(ae,yR,"Left"),se(ae,pR,"Center"),se(ae,gR,"Right"),se(ae,bR,"Justify"),se(ae,wR,"Top"),se(ae,SR,"Middle"),se(ae,_R,"Bottom"),se(ae,sR,"Freeze column"),se(ae,lR,"Unfreeze column"),se(ae,CR,"Borders"),se(ae,OR,"Top"),se(ae,TR,"Right"),se(ae,RR,"Bottom"),se(ae,ER,"Left"),se(ae,kR,"Remove border(s)"),se(ae,fR,"Add comment"),se(ae,hR,"Edit comment"),se(ae,dR,"Delete comment"),se(ae,vR,"Read-only comment"),se(ae,uR,"Merge cells"),se(ae,cR,"Unmerge cells"),se(ae,sp,"Copy"),se(ae,lp,["Copy with header","Copy with headers"]),se(ae,up,["Copy with group header","Copy with group headers"]),se(ae,cp,["Copy header only","Copy headers only"]),se(ae,fp,"Cut"),se(ae,AR,"Insert child row"),se(ae,xR,"Detach from parent"),se(ae,IR,["Hide column","Hide columns"]),se(ae,PR,["Show column","Show columns"]),se(ae,$R,["Hide row","Hide rows"]),se(ae,MR,["Show row","Show rows"]),se(ae,NR,"None"),se(ae,DR,"Is empty"),se(ae,HR,"Is not empty"),se(ae,LR,"Is equal to"),se(ae,FR,"Is not equal to"),se(ae,jR,"Begins with"),se(ae,BR,"Ends with"),se(ae,WR,"Contains"),se(ae,VR,"Does not contain"),se(ae,zR,"Greater than"),se(ae,UR,"Greater than or equal to"),se(ae,GR,"Less than"),se(ae,YR,"Less than or equal to"),se(ae,KR,"Is between"),se(ae,ZR,"Is not between"),se(ae,qR,"After"),se(ae,XR,"Before"),se(ae,QR,"Today"),se(ae,JR,"Tomorrow"),se(ae,eE,"Yesterday"),se(ae,oE,"Blank cells"),se(ae,tE,"Filter by condition"),se(ae,rE,"Filter by value"),se(ae,nE,"And"),se(ae,iE,"Or"),se(ae,aE,"Select all"),se(ae,sE,"Clear"),se(ae,lE,"OK"),se(ae,uE,"Cancel"),se(ae,cE,"Search"),se(ae,fE,"Value"),se(ae,hE,"Second value"),ae),hp=dE.languageCode,Tf=ui("languagesDictionaries"),zre=Tf.register,vE=Tf.getItem,Ure=Tf.hasItem,Gre=Tf.getValues;mE(dE);function mE(e,t){var r=e,n=t;return hr(e)&&(n=e,r=n.languageCode),Yre(r,n),zre(r,bn(n)),bn(n)}function Yre(e,t){e!==hp&&Mre(t,vE(hp))}function yE(e){return dp(e)?bn(vE(e)):null}function dp(e){return Ure(e)}function Kre(){return Gre()}function pE(e,t,r){var n=yE(e);if(n===null)return null;var i=n[t];if(Bt(i))return null;var o=Zre(i,r);return Array.isArray(o)?o[0]:o}function Zre(e,t){var r=e;return Ce(Fre(),function(n){r=n(e,t)}),r}function qre(e){var t=GT(e);return dp(t)||(t=hp,YT(e)),t}var Xre=we,Qre=nt,Jre=Eb,ene=Ut,tne=Vr,rne=Li;Xre({target:"Object",stat:!0,sham:!Qre},{getOwnPropertyDescriptors:function(t){for(var r=ene(t),n=tne.f,i=Jre(r),o={},a=0,s,l;i.length>a;)l=n(r,s=i[a++]),l!==void 0&&rne(o,s,l);return o}});var vp="active-header",Rf="area",ul="cell",mp="fill",Ef="header",yp="custom-selection";function Wo(e){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(e)}function nne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wE(n.key),n)}}function ine(e,t,r){return t&&gE(e.prototype,t),r&&gE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kf(){return typeof Reflect<"u"&&Reflect.get?kf=Reflect.get.bind():kf=function(t,r,n){var i=one(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kf.apply(this,arguments)}function one(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vo(e),e!==null););return e}function ane(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pp(e,t)}function pp(e,t){return pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pp(e,t)}function sne(e){var t=une();return function(){var n=Vo(e),i;if(t){var o=Vo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lne(this,i)}}function lne(e,t){if(t&&(Wo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bE(e)}function bE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function une(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vo(e){return Vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vo(e)}function cne(e,t,r){return t=wE(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wE(e){var t=fne(e,"string");return Wo(t)==="symbol"?t:String(t)}function fne(e,t){if(Wo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hne=function(e){ane(r,e);var t=sne(r);function r(n,i){var o;return nne(this,r),o=t.call(this,n,null),cne(bE(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return ine(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,kf(Vo(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,a=i.to,s=this.getNearestNotHiddenCoords(o,1),l=this.getNearestNotHiddenCoords(a,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=o,l=a}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,a);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,o,a){if(o<0)return o;var s=i.getNearestNotHiddenIndex(o,a),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,a=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,a);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,s=o.row===null||a.row===null,l=o.col===null||a.col===null,u=this.settings.createCellCoords(s?null:Math.min(o.row,a.row),l?null:Math.min(o.col,a.col)),c=this.settings.createCellCoords(s?null:Math.max(o.row,a.row),l?null:Math.max(o.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(a,a,s)}}]),r}(XJ);const zo=hne;function cl(e){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cl(e)}var dne=["activeHeaderClassName"];function SE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _E(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SE(Object(r),!0).forEach(function(n){vne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vne(e,t,r){return t=mne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=yne(e,"string");return cl(t)==="symbol"?t:String(t)}function yne(e,t){if(cl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pne(e,t){if(e==null)return{};var r=gne(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gne(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function bne(e){var t=e.activeHeaderClassName,r=pne(e,dne),n=new zo(_E(_E({highlightHeaderClassName:t},r),{},{selectionType:vp}));return n}function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}var wne=["layerLevel","areaCornerVisible"];function CE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CE(Object(r),!0).forEach(function(n){Sne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sne(e,t,r){return t=_ne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ne(e){var t=Cne(e,"string");return fl(t)==="symbol"?t:String(t)}function Cne(e,t){if(fl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function One(e,t){if(e==null)return{};var r=Tne(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tne(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Rne(e){var t=e.layerLevel,r=e.areaCornerVisible,n=One(e,wne),i=new zo(OE(OE({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Rf}));return i}function hl(e){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}var Ene=["cellCornerVisible"];function TE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TE(Object(r),!0).forEach(function(n){kne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kne(e,t,r){return t=Ane(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ane(e){var t=xne(e,"string");return hl(t)==="symbol"?t:String(t)}function xne(e,t){if(hl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ine(e,t){if(e==null)return{};var r=Pne(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pne(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function $ne(e){var t=e.cellCornerVisible,r=Ine(e,Ene),n=new zo(RE(RE({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:ul}));return n}function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}var Mne=["border","visualCellRange"];function EE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EE(Object(r),!0).forEach(function(n){Nne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nne(e,t,r){return t=Dne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dne(e){var t=Hne(e,"string");return dl(t)==="symbol"?t:String(t)}function Hne(e,t){if(dl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lne(e,t){if(e==null)return{};var r=Fne(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fne(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function jne(e){var t=e.border,r=e.visualCellRange,n=Lne(e,Mne),i=new zo(gp(gp(gp({},t),n),{},{selectionType:yp}),r);return i}var kE=nt,Bne=Ee,Wne=ct,Vne=Te,bp=Sa,zne=ka,Une=Ra,Gne=Ht,Yne=ya,Uo=Object.assign,AE=Object.defineProperty,Kne=Bne([].concat),Zne=!Uo||Vne(function(){if(kE&&Uo({b:1},Uo(AE({},"a",{enumerable:!0,get:function(){AE(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),Uo({},e)[r]!=7||bp(Uo({},t)).join("")!=n})?function(t,r){for(var n=Gne(t),i=arguments.length,o=1,a=zne.f,s=Une.f;i>o;)for(var l=Yne(arguments[o++]),u=a?Kne(bp(l),a(l)):bp(l),c=u.length,h=0,d;c>h;)d=u[h++],(!kE||Wne(s,l,d))&&(n[d]=l[d]);return n}:Uo,qne=we,xE=Zne;qne({target:"Object",stat:!0,arity:2,forced:Object.assign!==xE},{assign:xE});function vl(e){"@babel/helpers - typeof";return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vl(e)}function IE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IE(Object(r),!0).forEach(function(n){Xne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xne(e,t,r){return t=Qne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qne(e){var t=Jne(e,"string");return vl(t)==="symbol"?t:String(t)}function Jne(e,t){if(vl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eie(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function tie(e){var t=Object.assign({},(eie(e),e)),r=new zo(PE(PE({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:mp}));return r}function ml(e){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}var rie=["headerClassName","rowClassName","columnClassName"];function $E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ME(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$E(Object(r),!0).forEach(function(n){nie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$E(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nie(e,t,r){return t=iie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iie(e){var t=oie(e,"string");return ml(t)==="symbol"?t:String(t)}function oie(e,t){if(ml(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aie(e,t){if(e==null)return{};var r=sie(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sie(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function lie(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=aie(e,rie),o=new zo(ME(ME({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:Ef}));return o}function yl(e){"@babel/helpers - typeof";return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yl(e)}function NE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NE(Object(r),!0).forEach(function(n){cie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cie(e,t,r){return t=fie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fie(e){var t=hie(e,"string");return yl(t)==="symbol"?t:String(t)}function hie(e,t){if(yl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DE=ui("highlight/types"),Go=DE.register,die=DE.getItem;Go(vp,bne),Go(Rf,Rne),Go(ul,$ne),Go(yp,jne),Go(mp,tie),Go(Ef,lie);function Yo(e,t){return die(e)(uie({type:e},t))}function pl(e){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(e)}function $n(e){return pie(e)||yie(e)||mie(e)||vie()}function vie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mie(e,t){if(e){if(typeof e=="string")return wp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wp(e,t)}}function yie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pie(e){if(Array.isArray(e))return wp(e)}function wp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HE(Object(r),!0).forEach(function(n){gie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gie(e,t,r){return t=FE(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FE(n.key),n)}}function wie(e,t,r){return t&&LE(e.prototype,t),r&&LE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FE(e){var t=Sie(e,"string");return pl(t)==="symbol"?t:String(t)}function Sie(e,t){if(pl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ie=function(e){function t(r){bie(this,t),this.options=r,this.layerLevel=0,this.cell=Yo(ul,r),this.fill=Yo(mp,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return wie(t,[{key:"isEnabledFor",value:function(n,i){var o=n;n===ul&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=Yo(Rf,gl({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return $n(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=Yo(Ef,gl({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return $n(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=Yo(vp,gl({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return $n(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return $n(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Yo(yp,gl(gl({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Ce(this.areas.values(),function(n){return void n.clear()}),Ce(this.headers.values(),function(n){return void n.clear()}),Ce(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat($n(this.areas.values()),$n(this.headers.values()),$n(this.activeHeaders.values()),$n(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Cie=_ie;function bl(e){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function Oie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rie(n.key),n)}}function Tie(e,t,r){return t&&jE(e.prototype,t),r&&jE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rie(e){var t=Eie(e,"string");return bl(t)==="symbol"?t:String(t)}function Eie(e,t){if(bl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kie=function(e){function t(r){Oie(this,t),this.ranges=[],this.createCellRange=r}return Tie(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function Aie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iie(n.key),n)}}function xie(e,t,r){return t&&BE(e.prototype,t),r&&BE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iie(e){var t=Pie(e,"string");return wl(t)==="symbol"?t:String(t)}function Pie(e,t){if(wl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WE=function(){function e(t,r){Aie(this,e),this.range=t,this.options=r}return xie(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,c=a,h=0,d=0;if(this.runLocalHooks("beforeTransformStart",o),l!==null&&u!==null){var f=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),S=this.options.minSpareCols(),_=this.options.autoWrapRow(),O=this.options.autoWrapCol();l+r>f-1?i&&m>0&&!(y&&l>=f-y-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):O&&(o.row=1-f,o.col=u+o.col===v-1?1-v:1):O&&l+o.row<0&&u+o.col>=0&&(o.row=f-1,o.col=u+o.col===0?v-1:-1),u+o.col>v-1?i&&S>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):_&&(o.row=l+o.row===f-1?1-f:1,o.col=1-v):_&&u+o.col<0&&l+o.row>=0&&(o.row=l+o.row===0?f-1:-1,o.col=v-1);var R=this.options.createCellCoords(l+o.row,u+o.col);h=0,d=0,R.row<0?(h=-1,R.row=0):R.row>0&&R.row>=f&&(h=1,R.row=f-1),R.col<0?(d=-1,R.col=0):R.col>0&&R.col>=v&&(d=1,R.col=v-1),c=this.options.renderableToVisualCoords(R)}return this.runLocalHooks("afterTransformStart",c,h,d),c}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),a=o.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(o.highlight),c=u.row,h=u.col;if(c!==null&&h!==null){var d=this.options.countRows(),f=this.options.countCols(),v=this.options.visualToRenderableCoords(o.to),y=v.row,m=v.col,S=this.options.createCellCoords(y+i.row,m+i.col);s=0,l=0,S.row<0?(s=-1,S.row=0):S.row>0&&S.row>=d&&(s=1,S.row=d-1),S.col<0?(l=-1,S.col=0):S.col>0&&S.col>=f&&(l=1,S.col=f-1),a=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),e}();it(WE,Pn);const $ie=WE;function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}var VE=0,zE=1,UE=2,_p=3,Mie=[_p,UE],Nie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Cp=Symbol("root"),GE=Symbol("child");function YE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cp;if(t!==Cp&&t!==GE)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Cp,i=VE;if(r){var o=e[0];if(e.length===0)i=zE;else if(n&&o instanceof sy)i=_p;else if(n&&Array.isArray(o))i=YE(o,GE);else if(e.length>=2&&e.length<=4){var a=!e.some(function(s,l){return!Nie[l].includes(Sp(s))});a&&(i=UE)}}return i}function Die(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!Mie.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=e===_p,s=a?o.from.row:o[0],l=a?o.from.col:o[1],u=a?o.to.row:o[2],c=a?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Bt(u)&&(u=s),Bt(c)&&(c=l),!n){var h=s,d=l,f=u,v=c;s=Math.min(h,f),l=Math.min(d,v),u=Math.max(h,f),c=Math.max(d,v)}return[s,l,u,c]}}function Mn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function Sl(e){"@babel/helpers - typeof";return Sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sl(e)}var KE;function ZE(e,t){return jie(e)||Fie(e,t)||Lie(e,t)||Hie()}function Hie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lie(e,t){if(e){if(typeof e=="string")return qE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qE(e,t)}}function qE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function jie(e){if(Array.isArray(e))return e}function Bie(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zie(n.key),n)}}function Vie(e,t,r){return t&&XE(e.prototype,t),r&&XE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zie(e){var t=Uie(e,"string");return Sl(t)==="symbol"?t:String(t)}function Uie(e,t){if(Sl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QE=function(){function e(t,r){var n=this;Wie(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new kie(function(i,o,a){return n.tableProps.createCellRange(i,o,a)}),this.highlight=new Cie({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},createCellRange:function(o,a,s){return n.tableProps.createCellRange(o,a,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new $ie(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return Vie(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=Bt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),c),(!o||o&&!a&&Bt(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(ul,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(Ce(this.highlight.getAreas(),function(y){return void y.clear()}),Ce(this.highlight.getHeaders(),function(y){return void y.clear()}),Ce(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(Rf,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Ef,i.highlight)){var c=this.tableProps.countRowsTranslated()===0,h=this.tableProps.countColsTranslated()===0,d=i;if((c||h)&&(d=i.clone()),c&&(d.from.row=-1),h&&(d.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&d.from.normalize(),s.add(d.from).commit()):s.add(d.from).add(d.to).commit(),this.isEntireRowSelected()){var f=this.tableProps.countCols()===i.getWidth();f&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===i.getHeight();v&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Xi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=YE(r);if(i===zE)return!1;if(i===VE)throw new Error(wr(KE||(KE=Bie([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Die(i,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var c=o(u),h=ZE(c,4),d=h[0],f=h[1],v=h[2],y=h[3],m=Mn(d,a)&&Mn(f,s)&&Mn(v,a)&&Mn(y,s);return!m});return l&&(this.clear(),Ce(r,function(u){var c=o(u),h=ZE(c,4),d=h[0],f=h[1],v=h[2],y=h[3];n.setRangeStartOnly(n.tableProps.createCellCoords(d,f),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Mn(o,s)&&Mn(a,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=Mn(r,o)&&Mn(n,o);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),e}();it(QE,Pn);var Gie=we,JE=pu,Yie=Vr.f,Kie=Ni,ek=mt,Zie=eS,qie=cr,Xie=tS,tk=JE("".startsWith),Qie=JE("".slice),Jie=Math.min,rk=Xie("startsWith"),eoe=!rk&&!!function(){var e=Yie(String.prototype,"startsWith");return e&&!e.writable}();Gie({target:"String",proto:!0,forced:!eoe&&!rk},{startsWith:function(t){var r=ek(qie(this));Zie(t);var n=Kie(Jie(arguments.length>1?arguments[1]:void 0,r.length)),i=ek(t);return tk?tk(r,i,n):Qie(r,n,n+i.length)===i}});var nk=/^(\r\n|\n\r|\r|\n)/,toe=/^[^\t\r\n]+/,ik=/^\t/;function roe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(ik))e=e.replace(ik,""),r+=1,t[n][r]="";else if(e.match(nk))e=e.replace(nk,""),r=0,n+=1,t[n]=[""];else{var o="";if(e.startsWith('"')){for(var a=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(a+=1),o+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=e.match(toe);o=u?u[0]:"",e=e.slice(o.length)}t[n][r]=o}return t}function _l(e){var t,r,n,i,o="",a;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;t!==r-1&&(o+=`
`)}return o}function Op(e){return aoe(e)||ooe(e)||ioe(e)||noe()}function noe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ioe(e,t){if(e){if(typeof e=="string")return Tp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tp(e,t)}}function ooe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aoe(e){if(Array.isArray(e))return Tp(e)}function Tp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ko(e){"@babel/helpers - typeof";return Ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ko(e)}function soe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ok(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uoe(n.key),n)}}function loe(e,t,r){return t&&ok(e.prototype,t),r&&ok(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uoe(e){var t=coe(e,"string");return Ko(t)==="symbol"?t:String(t)}function coe(e,t){if(Ko(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ko(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var foe=function(){function e(t,r,n){soe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return loe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,s=!1;if(typeof n=="function"){var l=Cv(r);o=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;o=Math.min(u,n.length)}for(i=0;i<o;i++){var c=s?n(i):n[i];if(hr(c)){if(typeof c.data<"u"){var h=s?a:i;this.colToPropCache[h]=c.data,this.propToColCache.set(c.data,h)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return hT(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,a=n,s=i,l;return typeof a>"u"&&(a=0,s=""),Ko(r)==="object"&&!Array.isArray(r)&&We(r,function(u,c){u===null?(l=s+c,o.colToPropCache.push(l),o.propToColCache.set(l,a),a+=1):a=o.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&Ie(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(Ie(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Ja(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.source,s=o.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),c=u,h=0,d=r;(typeof d!="number"||d>=u)&&(d=u),d<this.instance.countRows()&&(c=this.instance.toPhysicalRow(d));var f=this.instance.runHooks("beforeCreateRow",d,i,a);if(f===!1||c===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,m=[],S=function(){var R=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?R=bn(n.getSchema()):(R=[],pt(y-1,function(){return R.push(null)})):n.instance.dataType==="function"?R=n.tableMeta.dataSchema(d+h):(R={},PS(R,n.getSchema())),m.push(R),h+=1};h<i&&u+h<v;)S();this.instance.rowIndexMapper.insertIndexes(d,h),l==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,m);var _=this.instance.toVisualRow(c);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),h>0&&(r==null?this.metaManager.createRow(null,h):a!=="auto"&&this.metaManager.createRow(c,i)),this.instance.runHooks("afterCreateRow",_,h,a),this.instance.forceFullRender=!0,{delta:h,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,a=i.mode,s=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),h=r;(typeof h!="number"||h>=c)&&(h=c);var d=this.instance.runHooks("beforeCreateCol",h,n,o);if(d===!1)return{delta:0};var f=c;h<this.instance.countCols()&&(f=this.instance.toPhysicalColumn(h));var v=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,S=f;s==="end"&&(S=Math.min(S+1,c));for(var _=S;m<n&&y<u;){if(typeof h!="number"||h>=y)if(v>0)for(var O=0;O<v;O+=1)typeof l[O]>"u"&&(l[O]=[]),l[O].push(null);else l.push([null]);else for(var R=0;R<v;R++)l[R].splice(S,0,null);m+=1,S+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(h,m),m>0&&(r==null?this.metaManager.createColumn(null,m):o!=="auto"&&this.metaManager.createColumn(_,n));var T=this.instance.toVisualColumn(_);return this.instance.runHooks("afterCreateCol",T,m,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:_}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(a,i),l=this.instance.countSourceRows();a=(l+a)%l;var u=this.instance.runHooks("beforeRemoveRow",a,s.length,s,o);if(u===!1)return!1;var c=s.length;if(this.filterData(a,c,s),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var h=Ie(this.tableMeta.columns)||Ie(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&h===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var d=s.slice(0).sort(function(f,v){return v-f});return d.forEach(function(f){n.metaManager.removeRow(f,1)}),this.instance.runHooks("afterRemoveRow",a,c,s,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),s=a.slice(0).sort(function(_,O){return O-_}),l=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(l===!1)return!1;for(var u=!0,c=s.length,h=this.dataSource,d=0;d<c;d++)u&&a[0]!==a[d]-d&&(u=!1);if(u)for(var f=0,v=this.instance.countSourceRows();f<v;f++)h[f].splice(a[0],n),f===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var S=0;S<c;S++)h[y].splice(s[S],1),y===0&&this.metaManager.removeColumn(s[S],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];kS(u,s);for(var h=0;h<i;)u.push(null),h+=1;return HL(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];kS(u,s);for(var h=0;h<i;)u.push(null),h+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,i){var o=this,a=this.instance.runHooks("beforeDataSplice",r,n,i);if(a!==!1){var s=[].concat(Op(this.dataSource.slice(0,r)),Op(i),Op(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return o.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var s=null;if(o&&o.hasOwnProperty&&wn(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=o;if(!u)return null;for(var c=0,h=l.length;c<h;c++)if(u=u[l[c]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var d=Xi(s);this.instance.runHooks("modifyData",i,this.propToCol(n),d,"get"),d.isTouched()&&(s=d.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),a=i,s=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=Xi(a);this.instance.runHooks("modifyData",o,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&wn(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),h=s,d=0,f;for(d=0,f=c.length-1;d<f;d++)typeof h[c[d]]>"u"&&(h[c[d]]={}),h=h[c[d]];h[c[d]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+r)%i,s=n,l;a<i&&s;)l=this.instance.toPhysicalRow(a),o.push(l),s-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],a=(i+r)%i,s=n;a<i&&s;){var l=this.instance.toPhysicalColumn(a);o.push(l),s-=1,a+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],a,s,l,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var h=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),f=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=d;a++){l=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=f&&v!==null;s++)l.push(h.call(this,a,this.colToProp(s)));v!==null&&o.push(l)}return o}},{key:"getText",value:function(r,n){return _l(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return _l(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}(),Rp=ui("cellTypes"),hoe=Rp.register,doe=Rp.getItem,ak=Rp.hasItem;function voe(e){if(!ak(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return doe(e)}function moe(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,o=r.validator;n&&$C(e,n),i&&sY(e,i),o&&fY(e,o),hoe(e,t)}function yoe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!wn(t,e)}function Af(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?voe(t.type):t.type;if(e._automaticallyAssignedMetaProps&&We(t,function(o,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!hr(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};We(n,function(o,a){if(yoe(a,r)){var s;i[a]=o,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),qi(e,i)}}function poe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}jL(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function xf(e){return Number.isInteger(e)&&e>=0}function If(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Pf(e){return e==null}function Ep(e){"@babel/helpers - typeof";return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(e)}const sk=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),ai(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),ai(i)===!1)return Ep(i)==="object"?(o=this.getCellMeta(t,r),$S(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Cl(e){"@babel/helpers - typeof";return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(e)}function lk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lk(Object(r),!0).forEach(function(n){goe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function goe(e,t,r){return t=hk(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ck(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hk(n.key),n)}}function fk(e,t,r){return t&&ck(e.prototype,t),r&&ck(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hk(e){var t=boe(e,"string");return Cl(t)==="symbol"?t:String(t)}function boe(e,t){if(Cl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function woe(){return fk(function e(){dk(this,e)})}var Soe=function(){function e(t){dk(this,e),this.metaCtor=woe(),this.meta=this.metaCtor.prototype,qi(this.meta,sk()),this.meta.instance=t}return fk(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;qi(this.meta,r),Af(this.meta,uk(uk({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function Ol(e){"@babel/helpers - typeof";return Ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(e)}function _oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ooe(n.key),n)}}function Coe(e,t,r){return t&&vk(e.prototype,t),r&&vk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ooe(e){var t=Toe(e,"string");return Ol(t)==="symbol"?t:String(t)}function Toe(e,t){if(Ol(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Roe=function(){function e(t){_oe(this,e);var r=t.getMetaConstructor();this.meta=new r}return Coe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){qi(this.meta,r),Af(this.meta,r,r)}}]),e}();function Tl(e){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}function mk(e){return xoe(e)||Aoe(e)||koe(e)||Eoe()}function Eoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function koe(e,t){if(e){if(typeof e=="string")return kp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kp(e,t)}}function Aoe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xoe(e){if(Array.isArray(e))return kp(e)}function kp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ioe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$oe(n.key),n)}}function Poe(e,t,r){return t&&yk(e.prototype,t),r&&yk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $oe(e){var t=Moe(e,"string");return Tl(t)==="symbol"?t:String(t)}function Moe(e,t){if(Tl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ap=function(e){function t(r){Ioe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return Poe(t,[{key:"obtain",value:function(n){If(function(){return xf(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;If(function(){return xf(n)||Pf(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],a=this.data.length,s=0;s<i;s++)o.push(a+s),this.data.push(void 0);var l=Pf(n)?this.index.length:n;this.index=[].concat(mk(this.index.slice(0,l)),o,mk(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;If(function(){return xf(n)||Pf(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(Pf(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var s=o[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Qa(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function Noe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hoe(n.key),n)}}function Doe(e,t,r){return t&&pk(e.prototype,t),r&&pk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hoe(e){var t=Loe(e,"string");return Rl(t)==="symbol"?t:String(t)}function Loe(e,t){if(Rl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Foe=["data","width"],joe=function(){function e(t){var r=this;Noe(this,e),this.globalMeta=t,this.metas=new Ap(function(){return r._createMeta()})}return Doe(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);qi(i,n),Af(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return poe(this.globalMeta.getMetaConstructor(),Foe).prototype}}]),e}();function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function Boe(e){return Uoe(e)||zoe(e)||Voe(e)||Woe()}function Woe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Voe(e,t){if(e){if(typeof e=="string")return xp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xp(e,t)}}function zoe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uoe(e){if(Array.isArray(e))return xp(e)}function xp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Goe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Koe(n.key),n)}}function Yoe(e,t,r){return t&&gk(e.prototype,t),r&&gk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Koe(e){var t=Zoe(e,"string");return El(t)==="symbol"?t:String(t)}function Zoe(e,t){if(El(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(El(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qoe=function(){function e(t){var r=this;Goe(this,e),this.columnMeta=t,this.metas=new Ap(function(){return r._createRow()})}return Yoe(e,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);qi(o,i),Af(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var a,s=this.metas.obtain(r).obtain(n);(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(i),s[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,Boe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){If(function(){return xf(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new Ap(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function kl(e){"@babel/helpers - typeof";return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kl(e)}function Xoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Joe(n.key),n)}}function Qoe(e,t,r){return t&&bk(e.prototype,t),r&&bk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Joe(e){var t=eae(e,"string");return kl(t)==="symbol"?t:String(t)}function eae(e,t){if(kl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wk=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Xoe(this,e),this.hot=t,this.globalMeta=new Soe(t),this.tableMeta=new Roe(this.globalMeta),this.columnMeta=new joe(this.globalMeta),this.cellMeta=new qoe(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return Qoe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,a=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=o,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();it(wk,Pn);function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function Sk(e,t,r,n){var i=n.hotInstance,o=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,h=so(s),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Xe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(h),e,c,l);var f=new foe(i,e,u);if(t(f),$f(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=f.getSchema();e=[];var y,m=0,S=0;for(m=0,S=d.startRows;m<S;m++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=bn(v),e.push(y);else if(i.dataType==="array")y=bn(v[0]),e.push(y);else{y=[];for(var _=0,O=d.startCols;_<O;_++)y.push(null);e.push(y)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat($f(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),d.data=e,f.dataSource=e,a.data=e,a.dataType=i.dataType,a.colToProp=f.colToProp.bind(f),a.propToCol=f.propToCol.bind(f),a.countCachedColumns=f.countCachedColumns.bind(f),r(f),i.runHooks("after".concat(h),e,c,l),c||(i.runHooks("afterChange",null,s),i.render())}function Al(e){"@babel/helpers - typeof";return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Al(e)}function tae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nae(n.key),n)}}function rae(e,t,r){return t&&_k(e.prototype,t),r&&_k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nae(e){var t=iae(e,"string");return Al(t)==="symbol"?t:String(t)}function iae(e,t){if(Al(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Al(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oae=function(){function e(t){var r=this;tae(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Ye.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return rae(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var c=wn(r,"type")?r.type:null,h=Xe(r.cells)?r.cells(i,o,u):null;if(c)if(h){var d;h.type=(d=h.type)!==null&&d!==void 0?d:c}else h={type:c};h&&this.metaManager.updateCellMeta(i,o,h),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),e}();function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function aae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ck(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lae(n.key),n)}}function sae(e,t,r){return t&&Ck(e.prototype,t),r&&Ck(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lae(e){var t=uae(e,"string");return xl(t)==="symbol"?t:String(t)}function uae(e,t){if(xl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cae=function(){function e(t){aae(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return sae(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,a=n.onChange,s=a===void 0?function(){}:a,l=typeof o=="string",u=l?o:i,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,c,s),l&&r.installPropWatcher(o,c,s)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),Ok=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Mf=function(t){return t.map(function(r){var n=r.toLowerCase();return Ok.has(n)?Ok.get(n):n}).sort().join("+")},fae=function(t){return t.split("+")},Tk=function(t){return t.toLowerCase()},Rk;function hae(e){return mae(e)||vae(e)||Ek(e)||dae()}function dae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mae(e){if(Array.isArray(e))return Ip(e)}function yae(e,t){return bae(e)||gae(e,t)||Ek(e,t)||pae()}function pae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ek(e,t){if(e){if(typeof e=="string")return Ip(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ip(e,t)}}function Ip(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function bae(e){if(Array.isArray(e))return e}function wae(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Sae=function(t){var r=$c({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=c.keys,d=c.callback,f=c.group,v=c.runOnlyIf,y=v===void 0?function(){return!0}:v,m=c.captureCtrl,S=m===void 0?!1:m,_=c.preventDefault,O=_===void 0?!0:_,R=c.stopPropagation,T=R===void 0?!1:R,D=c.relativeToGroup,H=c.position;if(Bt(f))throw new Error("You need to define the shortcut's group.");if(Xe(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(wr(Rk||(Rk=wae([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var V={callback:d,group:f,runOnlyIf:y,captureCtrl:S,preventDefault:O,stopPropagation:T};if(Ie(D)){var F=[D,H];V.relativeToGroup=F[0],V.position=F[1]}h.forEach(function(q){var le=Mf(q),I=r.hasItem(le);if(I){var j=r.getItem(le),C=j.findIndex(function(z){return z.group===D});C!==-1?H==="before"?C-=1:C+=1:C=j.length,j.splice(C,0,V)}else r.addItem(le,[V])})},i=function(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(d){We(h,function(f,v){Object.prototype.hasOwnProperty.call(d,v)===!1&&(d[v]=h[v])}),n(d)})},o=function(c){var h=Mf(c);r.removeItem(h)},a=function(c){var h=r.getItems();h.forEach(function(d){var f=yae(d,2),v=f[0],y=f[1],m=y.filter(function(S){return S.group!==c});m.length===0?o(fae(v)):(y.length=0,y.push.apply(y,hae(m)))})},s=function(c){var h=Mf(c),d=r.getItem(h);return Ie(d)?d.slice():[]},l=function(c){var h=Mf(c);return r.hasItem(h)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:a}};function _ae(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var Cae=["meta","alt","shift","control"],Il=_ae();function Oae(e,t,r,n,i){var o=function(f){return Cae.includes(f)},a=function(f){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return f.altKey&&y.push("alt"),v&&(f.ctrlKey||f.metaKey)?y.push("control/meta"):(f.ctrlKey&&y.push("control"),f.metaKey&&y.push("meta")),f.shiftKey&&y.push("shift"),y},s=function(f){if(t(f)!==!1){var v=r(f);if(!(f.keyCode===229||v===!1||co(f))){var y=Tk(f.key),m=[];o(y)?Il.press(y):m=a(f);var S=[y].concat(m),_=i(f,S);!_&&(NS()&&m.includes("meta")||!NS()&&m.includes("control"))&&i(f,[y].concat(a(f,!0))),n(f)}}},l=function(f){if(t(f)!==!1){var v=Tk(f.key);o(v)!==!1&&Il.release(v)}},u=function(){Il.releaseAll()},c=function(){for(var f=e;f;)f.document.documentElement.addEventListener("keydown",s),f.document.documentElement.addEventListener("keyup",l),f.document.documentElement.addEventListener("blur",u),f=ym(f)},h=function(){for(var f=e;f;)f.document.documentElement.removeEventListener("keydown",s),f.document.documentElement.removeEventListener("keyup",l),f.document.documentElement.removeEventListener("blur",u),f=ym(f)};return{mount:c,unmount:h,isPressed:function(f){return Il.isPressed(f)},releasePressedKeys:function(){return Il.releaseAll()}}}var Tae=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,o=t.afterKeyDown,a=$c({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),s="grid",l=function(y){var m=Sae(y);return a.addItem(y,m),m},u=function(){return s},c=function(y){return a.getItem(y)},h=function(y){s=y},d=!1,f=Oae(r,n,i,o,function(v,y){var m=c(u()),S=!1;if(!m.hasShortcut(y))return S;for(var _=m.getShortcuts(y),O=0;O<_.length;O++){var R=_[O],T=R.callback,D=R.runOnlyIf,H=R.preventDefault,V=R.stopPropagation,F=R.captureCtrl;if(D(v)!==!1&&(d=F,S=T(v,y)===!1,d=!1,H&&v.preventDefault(),V&&v.stopPropagation(),S))break}return S});return f.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:h,isCtrlPressed:function(){return!d&&(f.isPressed("control")||f.isPressed("meta"))},releasePressedKeys:function(){return f.releasePressedKeys()},destroy:function(){return f.unmount()}}};function Vt(e){"@babel/helpers - typeof";return Vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(e)}function Fr(e,t){return kae(e)||Eae(e,t)||kk(e,t)||Rae()}function Rae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function kae(e){if(Array.isArray(e))return e}function Zo(e){return Iae(e)||xae(e)||kk(e)||Aae()}function Aae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kk(e,t){if(e){if(typeof e=="string")return Pp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pp(e,t)}}function xae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Iae(e){if(Array.isArray(e))return Pp(e)}function Pp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pae="gridDefault",$p=null;function Ak(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,a=this,s=new En(a),l,u,c,h,d=!0;tee(i)&&eee(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var f=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=qre(t.language);var y=new wk(a,t,[oae,cae]),m=y.getTableMeta(),S=y.getGlobalMeta(),_=$c();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),By(this)&&ez(t.licenseKey,e),this.guid="ht_".concat(eC()),this.columnIndexMapper=new ap,this.rowIndexMapper=new ap,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new See(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var O=function(p){var w=p.row,x=p.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getRenderableFromVisualIndex(w):w,x>=0?a.columnIndexMapper.getRenderableFromVisualIndex(x):x)},R=function(p){var w=p.row,x=p.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getVisualFromRenderableIndex(w):w,x>=0?a.columnIndexMapper.getVisualFromRenderableIndex(x):x)},T=new QE(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return l.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,w){return a._createCellCoords(p,w)},createCellRange:function(p,w,x){return a._createCellRange(p,w,x)},visualToRenderableCoords:O,renderableToVisualCoords:R,isDisabledCellSelection:function(p,w){return a.getCellMeta(p,w).disableVisualSelection}});this.selection=T;var D=function(p){var w=p.hiddenIndexesChanged;w&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var p=Xi(!1),w=n.selection.getSelectedRange(),x=w.current(),k=x.from,P=x.to,N=w.size()-1;n.runHooks("afterSelection",k.row,k.col,P.row,P.col,p,N),n.runHooks("afterSelectionByProp",k.row,a.colToProp(k.col),P.row,a.colToProp(P.col),p,N);var Z=n.selection.isSelectedByAnyHeader(),U=n.selection.selectedRange.current(),X=!0;o&&(X=!1),p.isTouched()&&(X=!p.value);var ne=n.selection.isSelectedByRowHeader(),ie=n.selection.isSelectedByColumnHeader();X!==!1&&(Z?ne?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):ie&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):U&&!n.selection.isMultiple()?n.view.scrollViewport(O(U.from)):n.view.scrollViewport(O(g))),ne&&ie?Ae(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ne?(qe(n.rootElement,"ht__selection--columns"),Ae(n.rootElement,"ht__selection--rows")):ie?(qe(n.rootElement,"ht__selection--rows"),Ae(n.rootElement,"ht__selection--columns")):qe(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var p=g.length-1,w=g[p],x=w.from,k=w.to;n.runHooks("afterSelectionEnd",x.row,x.col,k.row,k.col,p),n.runHooks("afterSelectionEndByProp",x.row,a.colToProp(x.col),k.row,a.colToProp(k.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var p=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,p,w){n.runHooks("afterModifyTransformStart",g,p,w)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,p,w){n.runHooks("afterModifyTransformEnd",g,p,w)}),this.selection.addLocalHook("afterDeselect",function(){h.destroyEditor(),n._refreshBorders(),qe(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),c={alter:function(p,w){var x,k,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,Z=arguments.length>4?arguments[4]:void 0,U=function(at){if(at.length===0)return[];var He=Zo(at);He.sort(function(ut,_e){var Be=Fr(ut,1),vt=Be[0],St=Fr(_e,1),Xt=St[0];return vt===Xt?0:vt>Xt?1:-1});var ur=Zi(He,function(ut,_e){var Be=Fr(_e,2),vt=Be[0],St=Be[1],Xt=ut[ut.length-1],Tr=Fr(Xt,2),Hn=Tr[0],hg=Tr[1],Ri=Hn+hg;if(vt<=Ri){var zl=Math.max(St-(Ri-vt),0);Xt[1]+=zl}else ut.push([vt,St]);return ut},[He[0]]);return ur};switch(p){case"insert_row_below":case"insert_row_above":var X=a.countSourceRows();if(m.maxRows===X)return;var ne=p==="insert_row_below"?"below":"above";w=(x=w)!==null&&x!==void 0?x:ne==="below"?X:0;var ie=l.createRow(w,P,{source:N,mode:ne}),ge=ie.delta,be=ie.startPhysicalIndex;if(ge){var b=T.selectedRange.current(),W=b==null?void 0:b.from,B=W==null?void 0:W.row,A=a.toVisualRow(be);if(T.isSelectedByCorner())a.selectAll();else if(Ie(B)&&B>=A){var E=b.to,$=E.row,Y=E.col,K=W.col;T.isSelectedByRowHeader()&&(K=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(B+ge,K),!0),T.setRangeEnd(a._createCellCoords($+ge,Y))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var L=p==="insert_col_end"?"end":"start";w=(k=w)!==null&&k!==void 0?k:L==="end"?a.countSourceCols():0;var J=l.createCol(w,P,{source:N,mode:L}),oe=J.delta,ee=J.startPhysicalIndex;if(oe){if(Array.isArray(m.colHeaders)){var de=[a.toVisualColumn(ee),0];de.length+=oe,Array.prototype.splice.apply(m.colHeaders,de)}var Pe=T.selectedRange.current(),Se=Pe==null?void 0:Pe.from,Ke=Se==null?void 0:Se.col,wt=a.toVisualColumn(ee);if(T.isSelectedByCorner())a.selectAll();else if(Ie(Ke)&&Ke>=wt){var dt=Pe.to,Dt=dt.row,De=dt.col,st=Se.row;T.isSelectedByColumnHeader()&&(st=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(st,Ke+oe),!0),T.setRangeEnd(a._createCellCoords(Dt,De+oe))}else a._refreshBorders()}break;case"remove_row":var Et=function(at){var He=0;Ce(at,function(ur){var ut=Fr(ur,2),_e=ut[0],Be=ut[1],vt=ai(_e)?a.countRows()-1:Math.max(_e-He,0);Number.isInteger(_e)&&(_e=Math.max(_e-He,0));var St=l.removeRow(_e,Be,N);if(St){var Xt=a.countRows(),Tr=m.fixedRowsTop;Tr>=vt+1&&(m.fixedRowsTop-=Math.min(Be,Tr-vt));var Hn=m.fixedRowsBottom;Hn&&vt>=Xt-Hn&&(m.fixedRowsBottom-=Math.min(Be,Hn)),He+=Be}})};Array.isArray(w)?Et(U(w)):Et([[w,P]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var lt=function(at){var He=0;Ce(at,function(ur){var ut=Fr(ur,2),_e=ut[0],Be=ut[1],vt=ai(_e)?a.countCols()-1:Math.max(_e-He,0),St=a.toPhysicalColumn(vt);Number.isInteger(_e)&&(_e=Math.max(_e-He,0));var Xt=l.removeCol(_e,Be,N);if(Xt){var Tr=m.fixedColumnsStart;Tr>=vt+1&&(m.fixedColumnsStart-=Math.min(Be,Tr-vt)),Array.isArray(m.colHeaders)&&(typeof St>"u"&&(St=-1),m.colHeaders.splice(St,Be)),He+=Be}})};Array.isArray(w)?lt(U(w)):lt([[w,P]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}Z||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,w=m.minSpareRows,x=m.minCols,k=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&T.deselect(),p){var P=a.countRows();P<p&&l.createRow(P,p-P,{source:"auto"})}if(w){var N=a.countEmptyRows(!0);if(N<w){var Z=w-N,U=Math.min(Z,m.maxRows-a.countSourceRows());l.createRow(a.countRows(),U,{source:"auto"})}}{var X;(x||k)&&(X=a.countEmptyCols(!0));var ne=a.countCols();if(x&&!m.columns&&ne<x){var ie=x-ne;X+=ie,l.createCol(ne,ie,{source:"auto"})}if(k&&!m.columns&&a.dataType==="array"&&X<k){ne=a.countCols();var ge=k-X,be=Math.min(ge,m.maxCols-ne);l.createCol(ne,be,{source:"auto"})}}if(T.isSelected()){var b=a.countRows(),W=a.countCols();Ce(T.selectedRange,function(B){var A=!1,E=B.from.row,$=B.from.col,Y=B.to.row,K=B.to.col;E>b-1?(E=b-1,A=!0,Y>E&&(Y=E)):Y>b-1&&(Y=b-1,A=!0,E>Y&&(E=Y)),$>W-1?($=W-1,A=!0,K>$&&(K=$)):K>W-1&&(K=W-1,A=!0,$>K&&($=K)),A&&a.selectCell(E,$,Y,K)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,w,x,k,P){var N,Z,U,X,ne=[],ie={},ge=[],be=p.row,b=p.col;if(Z=w.length,Z===0)return!1;var W=0,B=0;switch(hr(x)&&(W=x.col-b+1,B=x.row-be+1),P){case"shift_down":var A=Sv(w),E=A.length,$=Math.max(E,W),Y=a.getData().slice(be),K=Sv(Y).slice(b,b+$);for(U=0;U<$;U+=1)if(U<E){for(N=0,Z=A[U].length;N<B-Z;N+=1)A[U].push(A[U][N%Z]);U<K.length?ge.push(A[U].concat(K[U])):ge.push(A[U].concat(new Array(Y.length).fill(null)))}else ge.push(A[U%E].concat(K[U]));a.populateFromArray(be,b,Sv(ge));break;case"shift_right":var L=w.length,J=Math.max(L,B),oe=a.getData().slice(be).map(function(_e){return _e.slice(b)});for(N=0;N<J;N+=1)if(N<L){for(U=0,X=w[N].length;U<W-X;U+=1)w[N].push(w[N][U%X]);if(N<oe.length)for(var ee=0;ee<oe[N].length;ee+=1)w[N].push(oe[N][ee]);else{var de;(de=w[N]).push.apply(de,Zo(new Array(oe[0].length).fill(null)))}}else w.push(w[N%Z].slice(0,J).concat(oe[N]));a.populateFromArray(be,b,w);break;case"overwrite":default:ie.row=p.row,ie.col=p.col;var Pe=0,Se=0,Ke=!0,wt,dt=function(Be){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,St=w[Be%w.length];return vt!==null?St[vt%St.length]:St},Dt=w.length,De=x?x.row-p.row+1:0;for(x?Z=De:Z=Math.max(Dt,De),N=0;N<Z&&!(x&&ie.row>x.row&&De>Dt||!m.allowInsertRow&&ie.row>a.countRows()-1||ie.row>=m.maxRows);N++){var st=N-Pe,Et=dt(st).length,lt=x?x.col-p.col+1:0;if(x?X=lt:X=Math.max(Et,lt),ie.col=p.col,wt=a.getCellMeta(ie.row,ie.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&wt.skipRowOnPaste){Pe+=1,ie.row+=1,Z+=1;continue}for(Se=0,U=0;U<X&&!(x&&ie.col>x.col&&lt>Et||!m.allowInsertColumn&&ie.col>a.countCols()-1||ie.col>=m.maxCols);U++){if(wt=a.getCellMeta(ie.row,ie.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&wt.skipColumnOnPaste){Se+=1,ie.col+=1,X+=1;continue}if(wt.readOnly&&k!=="UndoRedo.undo"){ie.col+=1;continue}var Or=U-Se,at=dt(st,Or),He=a.getDataAtCell(ie.row,ie.col);if(at!==null&&Vt(at)==="object")if(Array.isArray(at)&&He===null&&(He=[]),He===null||Vt(He)!=="object")Ke=!1;else{var ur=Ja(Array.isArray(He)?He:He[0]||He),ut=Ja(Array.isArray(at)?at:at[0]||at);$S(ur,ut)||Array.isArray(ur)&&Array.isArray(ut)?at=bn(at):Ke=!1}else He!==null&&Vt(He)==="object"&&(Ke=!1);Ke&&ne.push([ie.row,ie.col,at]),Ke=!0,ie.col+=1}ie.row+=1}a.setDataAtCell(ne,null,null,k||"populateFromArray");break}}};function H(g){var p=GT(g);dp(p)?(a.runHooks("beforeLanguageChange",p),S.language=p,a.runHooks("afterLanguageChange",p)):YT(g)}function V(g,p){var w=g==="className"?a.rootElement:a.table;if(d)Ae(w,p);else{var x=[],k=[];S[g]&&(x=Array.isArray(S[g])?S[g]:xS(S[g])),p&&(k=Array.isArray(p)?p:xS(p));var P=AS(x,k),N=AS(k,x);P.length&&qe(w,P),N.length&&Ae(w,N)}S[g]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(Sn()||XL())&&Ae(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new vee(this),h=jm.getInstance(a,m,T),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&a.rootElement.offsetParent===null&&bz(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Vt(d)==="object"&&(a.runHooks("afterChange",d[0],d[1]),d=!1),a.runHooks("afterInit")};function F(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function q(g){var p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function le(g,p,w){if(g.length){var x=a.getActiveEditor(),k=new F,P=!0;k.onQueueEmpty=function(be){x&&P&&x.cancelChanges(),w(be)};for(var N=g.length-1;N>=0;N--){var Z=Fr(g[N],4),U=Z[0],X=Z[1],ne=Z[3],ie=l.propToCol(X),ge=a.getCellMeta(U,ie);ge.type==="numeric"&&typeof ne=="string"&&mG(ne)&&(g[N][3]=q(ne)),a.getCellValidator(ge)&&(k.addValidatorToQueue(),a.validateCell(g[N][3],ge,function(be,b){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");if(W===!1&&b.allowInvalid===!1){P=!1,g.splice(be,1),b.valid=!0;var B=a.getCell(b.visualRow,b.visualCol);B!==null&&qe(B,m.invalidCellClassName)}k.removeValidatorFormQueue()}}(N,ge),p))}k.checkIfQueueIsEmpty()}}function I(g,p){var w=g.length-1;if(!(w<0)){for(;w>=0;w--){var x=!1;if(g[w]===null){g.splice(w,1);continue}if(!((g[w][2]===null||g[w][2]===void 0)&&(g[w][3]===null||g[w][3]===void 0))){if(m.allowInsertRow)for(;g[w][0]>a.countRows()-1;){var k=l.createRow(void 0,void 0,{source:p}),P=k.delta;if(P===0){x=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;l.propToCol(g[w][1])>a.countCols()-1;){var N=l.createCol(void 0,void 0,{source:p}),Z=N.delta;if(Z===0){x=!0;break}}x||l.set(g[w][0],g[w][1],g[w][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,p),h.lockEditor(),a._refreshBorders(null),h.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,p||"edit");var U=a.getActiveEditor();U&&Ie(U.refreshValue)&&U.refreshValue()}}this._createCellCoords=function(g,p){return a.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,w){return a.view._wt.createCellRange(g,p,w)},this.validateCell=function(g,p,w,x){var k=a.getCellValidator(p);function P(N){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!Z||p.hidden===!0){w(N);return}var U=p.visualCol,X=p.visualRow,ne=a.getCell(X,U,!0);if(ne&&ne.nodeName!=="TH"){var ie=a.rowIndexMapper.getRenderableFromVisualIndex(X),ge=a.columnIndexMapper.getRenderableFromVisualIndex(U);a.view._wt.getSetting("cellRenderer",ie,ge,ne)}w(N)}XV(k)&&(k=function(N){return function(Z,U){U(N.test(Z))}}(k)),Xe(k)?(g=a.runHooks("beforeValidate",g,p.visualRow,p.prop,x),a._registerImmediate(function(){k.call(p,g,function(N){a&&(N=a.runHooks("afterValidate",N,g,p.visualRow,p.prop,x),p.valid=N,P(N),a.runHooks("postAfterValidate",N,g,p.visualRow,p.prop,x))})})):a._registerImmediate(function(){p.valid=!0,P(p.valid,!1)})};function j(g,p,w){return Array.isArray(g)?g:[[g,p,w]]}function C(g,p){var w=a.getActiveEditor(),x=a.runHooks("beforeChange",g,p||"edit"),k=g.filter(function(P){return P!==null});return x===!1||k.length===0?(w&&w.cancelChanges(),[]):k}this.setDataAtCell=function(g,p,w,x){var k=j(g,p,w),P=[],N=x,Z,U,X;for(Z=0,U=k.length;Z<U;Z++){if(Vt(k[Z])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[Z][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[Z][1]>=this.countCols()?X=k[Z][1]:X=l.colToProp(k[Z][1]),P.push([k[Z][0],X,u.getAtCell(this.toPhysicalRow(k[Z][0]),k[Z][1]),k[Z][2]])}!N&&Vt(g)==="object"&&(N=p);var ne=C(P,x);a.runHooks("afterSetDataAtCell",ne,N),le(ne,N,function(){I(ne,N)})},this.setDataAtRowProp=function(g,p,w,x){var k=j(g,p,w),P=[],N=x,Z,U;for(Z=0,U=k.length;Z<U;Z++)P.push([k[Z][0],k[Z][1],u.getAtCell(this.toPhysicalRow(k[Z][0]),k[Z][1]),k[Z][2]]);!N&&Vt(g)==="object"&&(N=p);var X=C(P,x);a.runHooks("afterSetDataAtRowProp",X,N),le(X,N,function(){I(X,N)})},this.listen=function(){a&&!a.isListening()&&($p=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&($p=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return $p===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,p)},this.populateFromArray=function(g,p,w,x,k,P,N){if(!(Vt(w)==="object"&&Vt(w[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var Z=typeof x=="number"?a._createCellCoords(x,k):null;return c.populateFromArray(a._createCellCoords(g,p),w,Z,P,N)},this.spliceCol=function(g,p,w){for(var x,k=arguments.length,P=new Array(k>3?k-3:0),N=3;N<k;N++)P[N-3]=arguments[N];return(x=l).spliceCol.apply(x,[g,p,w].concat(P))},this.spliceRow=function(g,p,w){for(var x,k=arguments.length,P=new Array(k>3?k-3:0),N=3;N<k;N++)P[N-3]=arguments[N];return(x=l).spliceRow.apply(x,[g,p,w].concat(P))},this.getSelected=function(){if(T.isSelected())return Yr(T.getSelectedRange(),function(g){var p=g.from,w=g.to;return[p.row,p.col,w.row,w.col]})},this.getSelectedLast=function(){var g=this.getSelected(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(T.isSelected())return Array.from(T.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){var p=this;if(!(!T.isSelected()||this.countRows()===0||this.countCols()===0)){var w=[];Ce(T.getSelectedRange(),function(x){var k=x.getTopStartCorner(),P=x.getBottomEndCorner();pt(k.row,P.row,function(N){pt(k.col,P.col,function(Z){p.getCellMeta(N,Z).readOnly||w.push([N,Z,null])})})}),w.length>0&&this.setDataAtCell(w,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var w=g();return this.resumeExecution(p),w},this.batch=function(g){this.suspendRender(),this.suspendExecution();var p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),p=g.width,w=g.height,x=a.rootElement.getBoundingClientRect(),k=x.width,P=x.height,N=k!==p||P!==w,Z=a.runHooks("beforeRefreshDimensions",{width:p,height:w},{width:k,height:P},N)===!1;Z||((N||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(k,P),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:w},{width:k,height:P},N))}},this.updateData=function(g,p){var w=this;Sk(g,function(x){l=x},function(x){l=x,a.columnIndexMapper.fitToLength(w.getInitialColumnCount()),a.rowIndexMapper.fitToLength(w.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:p,metaManager:y,firstRun:d})},this.loadData=function(g,p){Sk(g,function(w){l=w},function(){y.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),d&&(d=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:p,metaManager:y,firstRun:d})},this.getInitialColumnCount=function(){var g=m.columns,p=0;if(Array.isArray(g))p=g.length;else if(Xe(g))if(a.dataType==="array")for(var w=this.countSourceCols(),x=0;x<w;x+=1)g(x)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=l.colToPropCache.length);else if(Ie(m.dataSchema)){var k=l.getSchema();p=Array.isArray(k)?k.length:Cv(k)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,w,x){return Bt(g)?l.getAll():l.getRange(a._createCellCoords(g,p),a._createCellCoords(w,x),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,w,x){return l.getCopyableText(a._createCellCoords(g,p),a._createCellCoords(w,x))},this.getCopyableData=function(g,p){return l.getCopyable(g,l.colToProp(p))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=(d?a.loadData:a.updateData).bind(this),x=!1,k,P;if(Ie(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ie(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ie(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(k in g)k==="data"||(k==="language"?H(g.language):k==="className"?V("className",g.className):k==="tableClassName"&&a.table?(V("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Ye.getSingleton().isRegistered(k)||Ye.getSingleton().isDeprecated(k)?(Xe(g[k])||Array.isArray(g[k]))&&(g[k].initialHook=!0,a.addHook(k,g[k])):!p&&wn(g,k)&&(S[k]=g[k]));g.data===void 0&&m.data===void 0?w(null,"updateSettings"):g.data!==void 0?w(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),a.initIndexMappers());var N=a.countCols(),Z=m.columns;if(Z&&Xe(Z)&&(x=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),N>0)for(k=0,P=0;k<N;k++){if(Z){var U=x?Z(k):Z[P];U&&y.updateColumnMeta(P,U)}P+=1}Ie(g.cell)&&We(g.cell,function(b){a.setCellMetaObject(b.row,b.col,b)}),a.runHooks("afterCellMetaReset");var X=a.rootElement.style.height;X!==""&&(X=parseInt(a.rootElement.style.height,10));var ne=g.height;if(Xe(ne)&&(ne=ne()),p){var ie=a.rootElement.getAttribute("style");ie&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ne===null){var ge=a.rootElement.getAttribute("data-initialstyle");ge&&(ge.indexOf("height")>-1||ge.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ge):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ne!==void 0&&(a.rootElement.style.height=isNaN(ne)?"".concat(ne):"".concat(ne,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var be=g.width;Xe(be)&&(be=be()),a.rootElement.style.width=isNaN(be)?"".concat(be):"".concat(be,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),a.view&&!d&&(a.forceFullRender=!0,h.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!p&&a.view&&(X===""||ne===""||ne===void 0)&&X!==ne&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(m.getValue){if(Xe(m.getValue))return m.getValue.call(a);if(g)return a.getData()[g[0][0]][m.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,w,x,k){c.alter(g,p,w,x,k)},this.getCell=function(g,p){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=p,k=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return k===null||x===null?null:a.view.getCellAtCoords(a._createCellCoords(k,x),w)},this.getCoords=function(g){var p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;var w=p.row,x=p.col,k=w,P=x;return w>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(w)),x>=0&&(P=this.columnIndexMapper.getVisualFromRenderableIndex(x)),a._createCellCoords(k,P)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,p){return l.get(g,l.colToProp(p))},this.getDataAtRowProp=function(g,p){return l.get(g,p)},this.getDataAtCol=function(g){for(var p=[],w=l.getRange(a._createCellCoords(0,g),a._createCellCoords(m.data.length-1,g),l.DESTINATION_RENDERER),x=0;x<w.length;x+=1)for(var k=0;k<w[x].length;k+=1)p.push(w[x][k]);return p},this.getDataAtProp=function(g){for(var p=[],w=l.getRange(a._createCellCoords(0,l.propToCol(g)),a._createCellCoords(m.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER),x=0;x<w.length;x+=1)for(var k=0;k<w[x].length;k+=1)p.push(w[x][k]);return p},this.getSourceData=function(g,p,w,x){var k;return g===void 0?k=u.getData():k=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(w,x)),k},this.getSourceDataArray=function(g,p,w,x){var k;return g===void 0?k=u.getData(!0):k=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(w,x),!0),k},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,w,x){var k=j(g,p,w),P=this.hasHook("afterSetSourceDataAtCell"),N=[];P&&Ce(k,function(U){var X=Fr(U,3),ne=X[0],ie=X[1],ge=X[2];N.push([ne,ie,u.getAtCell(ne,ie),ge])}),Ce(k,function(U){var X=Fr(U,3),ne=X[0],ie=X[1],ge=X[2];u.setAtCell(ne,ie,ge)}),P&&this.runHooks("afterSetSourceDataAtCell",N,x),this.render();var Z=a.getActiveEditor();Z&&Ie(Z.refreshValue)&&Z.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){var p=l.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(g,p,w,x){var k=this,P=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,w,x],N=P[0],Z=P[1],U=P[2],X=P[3],ne=null,ie=null;U===void 0&&(U=N),X===void 0&&(X=Z);var ge="mixed";return pt(Math.max(Math.min(N,U),0),Math.max(N,U),function(be){var b=!0;return pt(Math.max(Math.min(Z,X),0),Math.max(Z,X),function(W){var B=k.getCellMeta(be,W);return ie=B.type,ne?b=ne===ie:ne=ie,b}),ge=b?ie:"mixed",b}),ge},this.removeCellMeta=function(g,p,w){var x=[this.toPhysicalRow(g),this.toPhysicalColumn(p)],k=x[0],P=x[1],N=y.getCellMetaKeyValue(k,P,w),Z=a.runHooks("beforeRemoveCellMeta",g,p,w,N);Z!==!1&&(y.removeCellMeta(k,P,w),a.runHooks("afterRemoveCellMeta",g,p,w,N)),N=null},this.spliceCellsMeta=function(g){for(var p=this,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=arguments.length,k=new Array(x>2?x-2:0),P=2;P<x;P++)k[P-2]=arguments[P];if(k.length>0&&!Array.isArray(k[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&y.removeRow(this.toPhysicalRow(g),w),k.length>0&&Ce(k.reverse(),function(N){y.createRow(p.toPhysicalRow(g)),Ce(N,function(Z,U){return p.setCellMetaObject(g,U,Z)})}),a.render()},this.setCellMetaObject=function(g,p,w){var x=this;Vt(w)==="object"&&We(w,function(k,P){x.setCellMeta(g,p,P,k)})},this.setCellMeta=function(g,p,w,x){var k=a.runHooks("beforeSetCellMeta",g,p,w,x);if(k!==!1){var P=g,N=p;g<this.countRows()&&(P=this.toPhysicalRow(g)),p<this.countCols()&&(N=this.toPhysicalColumn(p)),y.setCellMeta(P,N,w,x),a.runHooks("afterSetCellMeta",g,p,w,x)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,p){var w=this.toPhysicalRow(g),x=this.toPhysicalColumn(p);return w===null&&(w=g),x===null&&(x=p),y.getCellMeta(w,x,{visualRow:g,visualColumn:p})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).renderer:g.renderer;return typeof w=="string"?o2(w):Bt(w)?o2("text"):w},this.getCellEditor=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).editor:g.editor;return typeof w=="string"?PC(w):Bt(w)?PC("text"):w},this.getCellValidator=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).validator:g.validator;return typeof w=="string"?cY(w):w},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,w){var x=new F;g&&(x.onQueueEmpty=g);for(var k=a.countRows()-1;k>=0;){if(p!==void 0&&p.indexOf(k)===-1){k-=1;continue}for(var P=a.countCols()-1;P>=0;){if(w!==void 0&&w.indexOf(P)===-1){P-=1;continue}x.addValidatorToQueue(),a.validateCell(a.getDataAtCell(k,P),a.getCellMeta(k,P),function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),P-=1}k-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var p=m.rowHeaders,w=g;return w!==void 0&&(w=a.runHooks("modifyRowHeader",w)),w===void 0?(p=[],pt(a.countRows()-1,function(x){p.push(a.getRowHeader(x))})):Array.isArray(p)&&p[w]!==void 0?p=p[w]:Xe(p)?p=p(w):p&&typeof p!="string"&&typeof p!="number"&&(p=w+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var g=0,p=a.countCols();g<p;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,w=a.runHooks("modifyColHeader",g);if(w===void 0){for(var x=[],k=a.countCols(),P=0;P<k;P++)x.push(a.getColHeader(P));return x}var N=m.colHeaders,Z=function(ie){for(var ge=[],be=a.countCols(),b=0;b<be;b++)Xe(m.columns)&&m.columns(b)&&ge.push(b);return ge[ie]},U=a.toPhysicalColumn(w),X=Z(U);return m.colHeaders===!1?N=null:m.columns&&Xe(m.columns)&&m.columns(X)&&m.columns(X).title?N=m.columns(X).title:m.columns&&m.columns[U]&&m.columns[U].title?N=m.columns[U].title:Array.isArray(m.colHeaders)&&m.colHeaders[U]!==void 0?N=m.colHeaders[U]:Xe(m.colHeaders)?N=m.colHeaders(U):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(N=yee(w)),N=a.runHooks("modifyColumnHeaderValue",N,g,p),N},this._getColWidthFromSettings=function(g){var p;if(g>=0){var w=a.getCellMeta(0,g);p=w.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Vt(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g){var p=a._getColWidthFromSettings(g);return p=a.runHooks("modifyColWidth",p,g),p===void 0&&(p=oy.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(g){var p=m.rowHeights;if(p!=null){switch(Vt(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g){var p=a._getRowHeightFromSettings(g);return p=a.runHooks("modifyRowHeight",p,g),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var g=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return YC(a.countRows()-1,function(w){if(a.isEmptyRow(w))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return YC(a.countCols()-1,function(w){if(a.isEmptyCol(w))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return m.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return m.isEmptyCol.call(a,g)},this.selectCell=function(g,p,w,x){var k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Bt(g)||Bt(p)?!1:this.selectCells([[g,p,w,x]],k,P)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(o=!0);var x=T.selectCells(g);return x&&w&&a.listen(),o=!1,x},this.selectColumns=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return T.selectColumns(g,p)},this.selectRows=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return T.selectRows(g,p)},this.deselectCell=function(){T.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=g&&this.hasRowHeaders(),w=g&&this.hasColHeaders();o=!0,T.selectAll(p,w),o=!1};var z=function(p,w){return p.getNearestNotHiddenIndex(w,1,!0)};this.scrollViewportTo=function(g,p){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=!w,N=!x,Z=g,U=p;if(k){var X=Number.isInteger(g),ne=Number.isInteger(p),ie=X?z(this.rowIndexMapper,g):void 0,ge=ne?z(this.columnIndexMapper,p):void 0;if(ie===null||ge===null)return!1;Z=X?a.rowIndexMapper.getRenderableFromVisualIndex(ie):void 0,U=ne?a.columnIndexMapper.getRenderableFromVisualIndex(ge):void 0}var be=Number.isInteger(Z),b=Number.isInteger(U);return be&&b?a.view.scrollViewport(a._createCellCoords(Z,U),P,x,w,N):be&&b===!1?a.view.scrollViewportVertically(Z,P,w):b&&be===!1?a.view.scrollViewportHorizontally(U,x,N):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),By(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}lo(a.rootElement),s.destroy(),h&&h.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),_.getItems().forEach(function(p){var w=Fr(p,2),x=w[1];x.destroy()}),_.clear(),a.runHooks("afterDestroy")},!0),Ye.getSingleton().destroy(a),We(a,function(p,w,x){Xe(p)?x[w]=fe(w):w!=="guid"&&(x[w]=null)}),a.isDestroyed=!0,l&&l.destroy(),l=null,c=null,T=null,h=null,a=null};function fe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(g){var p=so(g);return p==="UndoRedo"?this.undoRedo:_.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,p){Ye.getSingleton().add(g,p,a)},this.hasHook=function(g){return Ye.getSingleton().has(g,a)||Ye.getSingleton().has(g)},this.addHookOnce=function(g,p){Ye.getSingleton().once(g,p,a)},this.removeHook=function(g,p){Ye.getSingleton().remove(g,p,a)},this.runHooks=function(g,p,w,x,k,P,N){return Ye.getSingleton().run(a,g,p,w,x,k,P,N)},this.getTranslatedPhrase=function(g,p){return pE(m.language,g,p)},this.toHTML=function(){return UC(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",UC(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=g;typeof w=="function"&&(w=setTimeout(w,p)),this.timeouts.push(w)},this._clearTimeouts=function(){Ce(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){Ce(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(g),a.view.render(),p&&T.isSelected()&&h.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var G=Tae({handleEvent:function(p){var w=a.isListening(),x=(p==null?void 0:p.key)!==void 0;return w&&x},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&G.releasePressedKeys()}),this.getShortcutManager=function(){return G};var ve=G.addContext("grid"),Q={runOnlyIf:function(){return Ie(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:Pae};G.setActiveContextName("grid"),ve.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),w=p[p.length-1].highlight,x=w.row,k=w.col,P=a.getDataAtCell(x,k),N=new Map,Z=0;Z<p.length;Z++)p[Z].forAll(function(U,X){if(U>=0&&X>=0&&(U!==x||X!==k)){var ne=a.getCellMeta(U,X),ie=ne.readOnly;ie||N.set("".concat(U,"x").concat(X),[U,X,P])}});a.setDataAtCell(Array.from(N.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){T.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){T.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),w=p.from,x=p.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);T.setRangeStart(w.clone()),T.setRangeEnd(a._createCellCoords(k,x.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){T.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){T.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),w=p.from,x=p.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);T.setRangeStart(w.clone()),T.setRangeEnd(a._createCellCoords(k,x.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){T.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast().highlight.row,x=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Zo(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(a._createCellCoords(w,x))}},{keys:[["ArrowLeft","Shift"]],callback:function(){T.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast(),x=w.from,k=w.to,P=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Zo(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(x.clone()),T.setRangeEnd(a._createCellCoords(k.row,P))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){T.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast().highlight.row,x=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Zo(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(a._createCellCoords(w,x))}},{keys:[["ArrowRight","Shift"]],callback:function(){T.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast(),x=w.from,k=w.to,P=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Zo(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(x.clone()),T.setRangeEnd(a._createCellCoords(k.row,P))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),w=a.getSelectedRangeLast().highlight.row,x=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);T.setRangeStart(a._createCellCoords(w,x))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),w=parseInt(a.getSettings().fixedColumnsStart,10),x=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),k=a.columnIndexMapper.getNearestNotHiddenIndex(w,1);T.setRangeStart(a._createCellCoords(x,k))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),w=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),x=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);T.setRangeStart(a._createCellCoords(w,x))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){T.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),w=p.to,x=Math.max(w.row-a.countVisibleRows(),0),k=a.rowIndexMapper.getNearestNotHiddenIndex(x,1);if(k!==null){var P=a._createCellCoords(k,w.col),N=w.row-a.view.getFirstFullyVisibleRow(),Z=Math.max(P.row-N,0);T.setRangeEnd(P),a.scrollViewportTo(Z)}}},{keys:[["PageDown"]],callback:function(){T.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),w=p.to,x=Math.min(w.row+a.countVisibleRows(),a.countRows()-1),k=a.rowIndexMapper.getNearestNotHiddenIndex(x,-1);if(k!==null){var P=a._createCellCoords(k,w.col),N=w.row-a.view.getFirstFullyVisibleRow(),Z=Math.min(P.row-N,a.countRows()-1);T.setRangeEnd(P),a.scrollViewportTo(Z)}}},{keys:[["Tab"]],callback:function(p){var w=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;T.transformStart(w.row,w.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var w=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;T.transformStart(-w.row,-w.col)}}],Q),n2().forEach(function(g){var p=ry(g);_.addItem(g,new p(n))}),Ye.getSingleton().run(a,"construct")}var $ae="hooksRefRegisterer",xk={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;Ce(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;We(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Zr(xk,"MIXIN_NAME",$ae,{writable:!1,enumerable:!1});const Mae=xk;function qo(e){"@babel/helpers - typeof";return qo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(e)}function Nae(e,t){return Fae(e)||Lae(e,t)||Hae(e,t)||Dae()}function Dae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hae(e,t){if(e){if(typeof e=="string")return Ik(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ik(e,t)}}function Ik(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Fae(e){if(Array.isArray(e))return e}function jae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mp(e,t)}function Mp(e,t){return Mp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Mp(e,t)}function Bae(e){var t=zae();return function(){var n=Nf(e),i;if(t){var o=Nf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Wae(this,i)}}function Wae(e,t){if(t&&(qo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vae(e)}function Vae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nf(e){return Nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nf(e)}function Pk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uae(n.key),n)}}function Mk(e,t,r){return t&&$k(e.prototype,t),r&&$k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uae(e){var t=Gae(e,"string");return qo(t)==="symbol"?t:String(t)}function Gae(e,t){if(qo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yae="base",bt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Np="baseEditor",Dp=function(){function e(t){Pk(this,e),this.hot=t,this.instance=t,this.state=bt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return Mk(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,a,s){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=s,this.state=bt.VIRGIN}},{key:"extend",value:function(){return function(r){jae(i,r);var n=Bae(i);function i(){return Pk(this,i),n.apply(this,arguments)}return Mk(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,a,s,l;if(n){var u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];o=c[0],a=c[1],s=c[2],l=c[3]}var h=this.hot.runHooks("modifyGetCellCoords",o,a);if(Array.isArray(h)){var d=Nae(h,2);o=d[0],a=d[1]}var f=this.hot.getShortcutManager(),v=f.getContext("editor"),y={runOnlyIf:function(){return Ie(i.hot.getSelected())},group:Np};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(o,a,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===bt.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,a)),this.state=bt.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:dm(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,a;if(i){var s=this._closeCallback;this._closeCallback=function(h){s&&s(h),i(h),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(Np),u.removeShortcutsByGroup(Fm),this.state===bt.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===bt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=bt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(h){o.state=bt.FINISHED,o.discardEditor(h)}):(this.state=bt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=bt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===bt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=bt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=bt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===bt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,o=i.wtOverlays,a=i.wtViewport,s=this.hot.rootWindow,l=Pt(n),u=ht(n),c=Pt(this.hot.rootElement),h=ht(this.hot.rootElement),d=o.topOverlay.holder,f=o.inlineStartOverlay.holder,v=d!==s?d.scrollTop:0,y=f!==s?f.scrollLeft:0,m=s.innerWidth-c.left-h,S=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,_=S.wtTable,O=_.name,R=["master","inline_start"].includes(O)?v:0,T=["master","top","bottom"].includes(O)?y:0,D=l.top===c.top?0:1,H=l.top-c.top-D-R,V=0;this.hot.isRtl()?V=s.innerWidth-l.left-u-m-1+T:V=l.left-c.left-1-T,["top","top_inline_start_corner"].includes(O)&&(H+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(O)&&(V+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var F=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),le=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),I=this.hot.rowIndexMapper.getRenderableIndexesLength(),j=I-this.hot.view._wt.getSetting("fixedRowsBottom");(F&&q<=0||q===j)&&(H+=1),le<=0&&(V+=1);var C=a.rowsRenderCalculator.startPosition,z=a.columnsRenderCalculator.startPosition,fe=Math.abs(o.inlineStartOverlay.getScrollPosition()),G=o.topOverlay.getScrollPosition(),ve=$t(this.hot.rootDocument),Q=n.offsetTop+C-G,g=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?g=_.getWidth()-n.offsetLeft:g=Math.abs(p),g+=z-fe-u}else g=n.offsetLeft+z-fe;var w=li(this.TD,this.hot.rootWindow),x=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",k=parseInt(w[x],10)>0?0:1,P=parseInt(w.borderTopWidth,10)>0?0:1,N=ht(n)+k,Z=Zt(n)+P,U=yz(d)?ve:0,X=pz(f)?ve:0,ne=this.hot.view.maximumVisibleElementWidth(g)-U+k,ie=Math.max(this.hot.view.maximumVisibleElementHeight(Q)-X+P,23);return{top:H,start:V,height:Z,maxHeight:ie,width:N,maxWidth:ne}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return Yae}}]),e}();it(Dp,Mae);function Kae(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(f,v,y){f.addEventListener(v,y,!1)},a=function(f,v,y){f.removeEventListener(v,y,!1)},s=function(f){var v,y;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",n.textContent!==void 0?n.textContent=t.value+f:n.data=t.value+f,i.style.position="absolute",i.style.fontSize=h(t).fontSize,i.style.fontFamily=h(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),v=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},l=function(){window.setTimeout(s,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(f.minHeight);isNaN(v)||(e.minHeight=v)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(f.maxHeight);isNaN(y)||(e.maxHeight=y)}if(f&&f.minWidth)if(f.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(f.minWidth);isNaN(m)||(e.minWidth=m)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var S=parseInt(f.maxWidth);isNaN(S)||(e.maxWidth=S)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(f,v,y){t=f,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(o(t,"change",s),o(t,"cut",l),o(t,"paste",l),o(t,"drop",l),o(t,"keydown",l),o(t,"focus",s),o(t,"compositionstart",l),o(t,"compositionupdate",l),o(t,"compositionend",l)),s()};function h(d){return d.currentStyle||document.defaultView.getComputedStyle(d)}return{init:function(f,v,y){c(f,v,y)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}function Nk(e,t){for(var r=dz(t),n=t.value.split(`
`),i=r,o=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(o+=n[a-1].length+1);var l=o+s.length;if(e==="home"?i=o:e==="end"&&(i=l),r<=l)break}lC(t,i)}function Xo(e){"@babel/helpers - typeof";return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}function Dk(e,t){return Qae(e)||Xae(e,t)||qae(e,t)||Zae()}function Zae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qae(e,t){if(e){if(typeof e=="string")return Hk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hk(e,t)}}function Hk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Qae(e){if(Array.isArray(e))return e}function Jae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tse(n.key),n)}}function ese(e,t,r){return t&&Lk(e.prototype,t),r&&Lk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tse(e){var t=rse(e,"string");return Xo(t)==="symbol"?t:String(t)}function rse(e,t){if(Xo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pl(){return typeof Reflect<"u"&&Reflect.get?Pl=Reflect.get.bind():Pl=function(t,r,n){var i=nse(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pl.apply(this,arguments)}function nse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gi(e),e!==null););return e}function ise(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hp(e,t)}function Hp(e,t){return Hp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hp(e,t)}function ose(e){var t=sse();return function(){var n=gi(e),i;if(t){var o=gi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ase(this,i)}}function ase(e,t){if(t&&(Xo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fk(e)}function Fk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gi(e){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gi(e)}var lse="ht_editor_visible",Df="ht_editor_hidden",jk="textEditor",use="text",cse=function(e){ise(r,e);var t=ose(r);function r(n){var i;return Jae(this,r),i=t.call(this,n),i.eventManager=new En(Fk(i)),i.autoResize=Kae(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return ese(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this.state;if(Pl(gi(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var h=u.allowInvalid,d=u.fragmentSelection;h&&(this.TEXTAREA.value=""),c!==bt.FINISHED&&this.hideEditableElement();var f=!d;f&&!Sn()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===bt.VIRGIN&&(this.TEXTAREA.value="",Pl(gi(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),lC(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ae(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Ae(this.TEXTAREA_PARENT,"handsontableInputHolder"),Je(this.TEXTAREA_PARENT,this.layerClass)&&qe(this.TEXTAREA_PARENT,this.layerClass),Ae(this.TEXTAREA_PARENT,Df),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(ZL()||KL())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",qe(this.TEXTAREA_PARENT,this.layerClass),Ae(this.TEXTAREA_PARENT,Df)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;pt(i.length-1,function(a){var s=i[a];if(Je(s,"handsontableEditor"))return o=!0,!1}),Je(this.TEXTAREA_PARENT,Df)&&qe(this.TEXTAREA_PARENT,Df),o?(this.layerClass=lse,Ae(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ae(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==bt.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),a=o.top,s=o.start,l=o.width,u=o.maxWidth,c=o.height,h=o.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var d=li(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=d.fontSize,this.TEXTAREA.style.fontFamily=d.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var f=li(this.TEXTAREA),v=parseInt(f.paddingLeft,10)+parseInt(f.paddingRight,10),y=parseInt(f.paddingTop,10)+parseInt(f.paddingBottom,10),m=l-v,S=c-y,_=u-v,O=h-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,_),minHeight:Math.min(S,O),maxWidth:_,maxHeight:O},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),MS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={runOnlyIf:function(){return Ie(i.hot.getSelected())},group:jk},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var h=i.hot.getSettings(),d=typeof h.tabMoves=="function"?h.tabMoves(c):h.tabMoves;i.hot.selection.transformStart(d.row,d.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var h=i.hot.getSettings(),d=typeof h.tabMoves=="function"?h.tabMoves(c):h.tabMoves;i.hot.selection.transformStart(-d.row,-d.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(c){return!i.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:Pc,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Pc,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Pc,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,h){var d=Dk(h,1),f=d[0];Nk(f,i.TEXTAREA)}},{keys:[["End"]],callback:function(c,h){var d=Dk(h,1),f=d[0];Nk(f,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(Fm),o.removeShortcutsByGroup(jk),o.removeShortcutsByGroup(Np)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[me.ARROW_UP,me.ARROW_RIGHT,me.ARROW_DOWN,me.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return use}}]),r}(Dp),fse="base";function Bk(e,t,r,n,i,o,a){var s=[],l=[];a.className&&Ae(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),qe(t,l),Ae(t,s)}Bk.RENDERER_TYPE=fse;var hse="text";function Wk(e,t,r,n,i,o,a){Bk.apply(this,[e,t,r,n,i,o,a]);var s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=dm(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){lo(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else ms(t,s)}Wk.RENDERER_TYPE=hse;var dse="text",vse={CELL_TYPE:dse,editor:cse,renderer:Wk};moe(vse),Cr.editors={BaseEditor:Dp};function Cr(e,t){var r=new Ak(e,t||{},jy);return r.init(),r}Cr.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Ak(e,t,jy)},Cr.DefaultSettings=sk(),Cr.hooks=Ye.getSingleton(),Cr.CellCoords=Nc,Cr.CellRange=sy,Cr.packageName="handsontable",Cr.buildDate="22/06/2023 12:51:08",Cr.version="13.0.0",Cr.languages={dictionaryKeys:Bre,getLanguageDictionary:yE,getLanguagesDictionaries:Kre,registerLanguageDictionary:mE,getTranslatedPhrase:pE};var mse=bu,yse=vC;mse("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},yse);function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function pse(e,t){return Sse(e)||wse(e,t)||bse(e,t)||gse()}function gse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bse(e,t){if(e){if(typeof e=="string")return Vk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vk(e,t)}}function Vk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Sse(e){if(Array.isArray(e))return e}function _se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ose(n.key),n)}}function Cse(e,t,r){return t&&zk(e.prototype,t),r&&zk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ose(e){var t=Tse(e,"string");return $l(t)==="symbol"?t:String(t)}function Tse(e,t){if($l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rse(e,t){Ese(e,t),t.add(e)}function Ese(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kse(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var Uk=new Map([["plugin",rY],["cell-type",ak],["editor",IC],["renderer",i2],["validator",a2]]),Ase="base",bi=new WeakMap,Lp=[],jr=null,Gk=new WeakSet,Hf=function(){function e(t){var r=this;_se(this,e),Rse(this,Gk),Zr(this,"hot",t,{writable:!1}),bi.set(this,{hooks:{}}),jr=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Cse(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(u){var c=u.split(":"),h=pse(c,2),d=h[0],f=h[1];if(!Uk.has(d))throw new Error('Unknown plugin dependency type "'.concat(d,'" was found.'));Uk.get(d)(f)||o.push(" - ".concat(f," (").concat(d,")"))}),o.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");Lp.push(a)}}jr||(jr=n2()),jr.indexOf("UndoRedo")>=0&&jr.splice(jr.indexOf("UndoRedo"),1),jr.indexOf(this.pluginName)>=0&&jr.splice(jr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=jr.length===0;if(s){if(Lp.length>0){var l=["".concat(Lp.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){bi.get(this).hooks[r]=bi.get(this).hooks[r]||[];var i=bi.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),bi.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;Ce(bi.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=bi.get(this).hooks;We(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){Ce(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=kse(this,Gk,xse).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),We(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Ase}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function xse(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function Ise(e,t){return Nse(e)||Mse(e,t)||$se(e,t)||Pse()}function Pse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $se(e,t){if(e){if(typeof e=="string")return Yk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yk(e,t)}}function Yk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Nse(e){if(Array.isArray(e))return e}function Dse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lse(n.key),n)}}function Hse(e,t,r){return t&&Kk(e.prototype,t),r&&Kk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lse(e){var t=Fse(e,"string");return Ml(t)==="symbol"?t:String(t)}function Fse(e,t){if(Ml(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jse=function(){function e(t){Dse(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Hse(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),Ce(this.rows,function(n){r(n.row,Zt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),Ce(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){Ce(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),a=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),o.appendChild(a)),this.samples.forEach(function(s){Ce(s.strings,function(l){var u=l.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var h=n.hot.getCellRenderer(c),d=i.createElement("td");d.setAttribute("ghost-table",1),h(n.hot,d,r,u,n.hot.colToProp(u),l.value,c),o.appendChild(d)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");o.push([-1,a]),i.appendChild(a)}this.samples.forEach(function(s){Ce(s.strings,function(l){var u=l.col,c=n.createElement("th");o.push([u,c]),i.appendChild(c)})}),this.table.tHead.appendChild(i),Ce(o,function(s){var l=Ise(s,2),u=l[0],c=l[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(a){Ce(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var c=n.hot.getCellRenderer(u),h=i.createElement("td"),d=i.createElement("tr");h.setAttribute("ghost-table",1),c(n.hot,h,l,r,n.hot.colToProp(r),s.value,u),d.appendChild(h),o.appendChild(d)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(a),this.isVertical()&&s.appendChild(u),o.appendChild(s),Ae(o,r),i.appendChild(o),{fragment:i,table:o,tHead:a,tBody:s,colGroup:l,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return Ae(o,a),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const Bse=jse;function Nl(e){"@babel/helpers - typeof";return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(e)}function Wse(e,t,r){return t=qk(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qk(n.key),n)}}function zse(e,t,r){return t&&Zk(e.prototype,t),r&&Zk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qk(e){var t=Use(e,"string");return Nl(t)==="symbol"?t:String(t)}function Use(e,t){if(Nl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gse=function(){function e(t){Vse(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return zse(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,a=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return pt(l,u,function(c){var h=o.generateSample(r,n,c);a.set(c,h)}),a}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return pt(n.from,n.to,function(u){var c=r==="row"?o.dataFactory(i,u):o.dataFactory(u,i),h=c.value,d=c.bundleSeed,f=typeof d=="string"&&d.length>0,v;f?v=d:hr(h)?v="".concat(Object.keys(h).length):Array.isArray(h)?v="".concat(h.length):v="".concat(dm(h).length),a.has(v)||a.set(v,{needed:o.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var m=l.indexOf(h)>-1;(!m||o.allowDuplicates||f)&&(y.strings.push(Wse({value:h},s,u)),l.push(h),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();function Qo(e){"@babel/helpers - typeof";return Qo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qo(e)}function Xk(e,t){return qse(e)||Zse(e,t)||Kse(e,t)||Yse()}function Yse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kse(e,t){if(e){if(typeof e=="string")return Qk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qk(e,t)}}function Qk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function qse(e){if(Array.isArray(e))return e}function Xse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jse(n.key),n)}}function Qse(e,t,r){return t&&Jk(e.prototype,t),r&&Jk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jse(e){var t=ele(e,"string");return Qo(t)==="symbol"?t:String(t)}function ele(e,t){if(Qo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wi(){return typeof Reflect<"u"&&Reflect.get?wi=Reflect.get.bind():wi=function(t,r,n){var i=tle(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wi.apply(this,arguments)}function tle(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sn(e),e!==null););return e}function rle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fp(e,t)}function Fp(e,t){return Fp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Fp(e,t)}function nle(e){var t=ole();return function(){var n=sn(e),i;if(t){var o=sn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ile(this,i)}}function ile(e,t){if(t&&(Qo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eA(e)}function eA(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ole(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sn(e)}Ye.getSingleton().register("modifyAutoColumnSizeSeed");var Dl="autoColumnSize",ale=10,jp=new WeakMap,sle="autoColumnSize",lle=function(e){rle(r,e);var t=nle(r);function r(n){var i;return Xse(this,r),i=t.call(this,n),jp.set(eA(i),{cachedColumnHeaders:[]}),i.ghostTable=new Bse(i.hot),i.samplesGenerator=new Gse(function(o,a){var s=i.hot.getCellMeta(o,a),l="";s.spanned||(l=i.hot.getDataAtCell(o,a));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new mf,i.hot.columnIndexMapper.registerMap(sle,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),i}return Qse(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Dl]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[Dl];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return i.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return i.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return i.onAfterInit()}),wi(sn(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),wi(sn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;wi(sn(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var o=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;pt(l.from,l.to,function(c){var h=i.hot.toPhysicalColumn(c);if(h===null&&(h=c),s||i.columnWidthsMap.getValueAtIndex(h)===null&&!i.hot._getColWidthFromSettings(h)){var d=i.samplesGenerator.generateColumnSamples(c,u);Ce(d,function(f){var v=Xk(f,2),y=v[0],m=v[1];return i.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(c,h){var d=i.hot.toPhysicalColumn(c);i.columnWidthsMap.setValueAtIndex(d,h)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function h(){if(!i.hot){yS(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=mS(h):(yS(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[Dl],o=i&&wn(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&wn(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[Dl],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return hr(i)&&(o=i.syncLimit,rz(o)?o=yG(a,o):o>>=0),Math.min(o,a)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=o;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),a&&typeof s=="number"&&(s=Math.max(s,oy.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=jp.get(this),a=o.cachedColumnHeaders,s=Zi(i,function(l,u,c){var h=a.length;return(h-1<c||a[c]!==u)&&l.push(c),h-1<c?a.push(u):a[c]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){Ce(o,function(a){i.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Qa(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,a=Yr(i,function(s){var l=Xk(s,2),u=l[1];return o.hot.toPhysicalColumn(o.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(i,o,a){var s=i;return a&&(this.calculateColumnsWidth(o,void 0,!0),s=this.getColumnWidth(o,void 0,!1)),s}},{key:"onAfterInit",value:function(){jp.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=Qa(i,function(s){var l;return Ie((l=s.address)===null||l===void 0?void 0:l.col)}),a=Yr(o,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),wi(sn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dl}},{key:"PLUGIN_PRIORITY",get:function(){return ale}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(Hf);function ule(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(sp)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function cle(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(cp,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function fle(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(up,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function hle(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(lp,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function dle(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(fp)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function vle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yle(n.key),n)}}function mle(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yle(e){var t=ple(e,"string");return Hl(t)==="symbol"?t:String(t)}function ple(e,t){if(Hl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gle=function(){function e(){vle(this,e),this.data={}}return mle(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function rA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wle(n.key),n)}}function ble(e,t,r){return t&&rA(e.prototype,t),r&&rA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wle(e){var t=Sle(e,"string");return Ll(t)==="symbol"?t:String(t)}function Sle(e,t){if(Ll(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Cle=ble(function e(){_le(this,e),this.clipboardData=new gle});function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}function Ole(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rle(n.key),n)}}function Tle(e,t,r){return t&&nA(e.prototype,t),r&&nA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rle(e){var t=Ele(e,"string");return Fl(t)==="symbol"?t:String(t)}function Ele(e,t){if(Fl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bp=function(){function e(t){Ole(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new En(this),this.listenersCount=new WeakSet,this.container=t}return Tle(e,[{key:"useSecondaryElement",value:function(){var r=xle(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),iA(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),iA(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Sn()||gz(this.mainElement)}}]),e}();it(Bp,Pn);var Lf=new WeakMap;function kle(e){var t=new Bp(e),r=Lf.get(e);return r=isNaN(r)?0:r,Lf.set(e,r+1),t}function Ale(e){e.eventManager.clear()}var Wp=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function iA(e,t,r){e.addEventListener(t,"copy",Wp("copy",r)),e.addEventListener(t,"cut",Wp("cut",r)),e.addEventListener(t,"paste",Wp("paste",r))}var Ff=new WeakMap;function xle(e){var t=Ff.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Ff.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function oA(e){if(e instanceof Bp){var t=Lf.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),Ale(e),t<=0){t=0;var r=Ff.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Ff.delete(e.container)),e.mainElement=null}Lf.set(e.container,t)}}function jl(e){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jl(e)}function Ile(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$le(n.key),n)}}function Ple(e,t,r){return t&&aA(e.prototype,t),r&&aA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $le(e){var t=Mle(e,"string");return jl(t)==="symbol"?t:String(t)}function Mle(e,t){if(jl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sA(e,t){lA(e,t),t.add(e)}function Jo(e,t,r){lA(e,t),t.set(e,r)}function lA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jf(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Mt(e,t){var r=uA(e,t,"get");return Nle(e,r)}function Nle(e,t){return t.get?t.get.call(e):t.value}function ea(e,t,r){var n=uA(e,t,"set");return Dle(e,n,r),r}function uA(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Dle(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Nn=new WeakMap,Vp=new WeakMap,Bl=new WeakMap,zp=new WeakMap,Up=new WeakMap,Wl=new WeakMap,Bf=new WeakSet,cA=new WeakSet,Hle=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,o=t.columnsLimit,a=t.countColumnHeaders;Ile(this,e),sA(this,cA),sA(this,Bf),Jo(this,Nn,{writable:!0,value:void 0}),Jo(this,Vp,{writable:!0,value:void 0}),Jo(this,Bl,{writable:!0,value:void 0}),Jo(this,zp,{writable:!0,value:void 0}),Jo(this,Up,{writable:!0,value:void 0}),Jo(this,Wl,{writable:!0,value:void 0}),ea(this,Vp,r),ea(this,Bl,n),ea(this,zp,i),ea(this,Up,o),ea(this,Wl,a)}return Ple(e,[{key:"setSelectedRange",value:function(r){ea(this,Nn,r)}},{key:"getCellsRange",value:function(){if(Mt(this,Vp).call(this)===0||Mt(this,Bl).call(this)===0)return null;var r=Mt(this,Nn).getTopStartCorner(),n=r.row,i=r.col,o=Mt(this,Nn).getBottomEndCorner(),a=o.row,s=o.col,l=jf(this,cA,Lle).call(this,n,a),u=jf(this,Bf,Gp).call(this,i,s),c=a!==l||s!==u;return{isRangeTrimmed:c,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(Mt(this,Bl).call(this)===0||Mt(this,Wl).call(this)===0)return null;var r=Mt(this,Nn).getTopStartCorner(),n=r.col,i=Mt(this,Nn).getBottomEndCorner(),o=i.col,a=jf(this,Bf,Gp).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(Mt(this,Bl).call(this)===0||Mt(this,Wl).call(this)===0)return null;var r=Mt(this,Nn).getTopStartCorner(),n=r.col,i=Mt(this,Nn).getBottomEndCorner(),o=i.col,a=jf(this,Bf,Gp).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-Mt(this,Wl).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function Gp(e,t){return Math.min(t,Math.max(e+Mt(this,Up).call(this)-1,e))}function Lle(e,t){return Math.min(t,Math.max(e+Mt(this,zp).call(this)-1,e))}function fA(e){var t=[],r=[];return Ce(e,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);pt(i,o,function(l){t.indexOf(l)===-1&&t.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);pt(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function Fle(e,t){return Vle(e)||Wle(e,t)||Ble(e,t)||jle()}function jle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ble(e,t){if(e){if(typeof e=="string")return hA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hA(e,t)}}function hA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Vle(e){if(Array.isArray(e))return e}function Si(e){"@babel/helpers - typeof";return Si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Si(e)}function zle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mA(n.key),n)}}function Ule(e,t,r){return t&&dA(e.prototype,t),r&&dA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _i(){return typeof Reflect<"u"&&Reflect.get?_i=Reflect.get.bind():_i=function(t,r,n){var i=Gle(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_i.apply(this,arguments)}function Gle(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ln(e),e!==null););return e}function Yle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yp(e,t)}function Yp(e,t){return Yp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Yp(e,t)}function Kle(e){var t=qle();return function(){var n=ln(e),i;if(t){var o=ln(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Zle(this,i)}}function Zle(e,t){if(t&&(Si(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nt(e)}function Nt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qle(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ln(e)}function Xle(e,t){vA(e,t),t.add(e)}function Ci(e,t,r){vA(e,t),t.set(e,r)}function vA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(e,t,r){return t=mA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mA(e){var t=Qle(e,"string");return Si(t)==="symbol"?t:String(t)}function Qle(e,t){if(Si(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Si(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jle(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function qt(e,t){var r=yA(e,t,"get");return eue(e,r)}function eue(e,t){return t.get?t.get.call(e):t.value}function un(e,t,r){var n=yA(e,t,"set");return tue(e,n,r),r}function yA(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function tue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Ye.getSingleton().register("afterCopyLimit"),Ye.getSingleton().register("modifyCopyableRange"),Ye.getSingleton().register("beforeCut"),Ye.getSingleton().register("afterCut"),Ye.getSingleton().register("beforePaste"),Ye.getSingleton().register("afterPaste"),Ye.getSingleton().register("beforeCopy"),Ye.getSingleton().register("afterCopy");var Wf="copyPaste",rue=80,nue=["fragmentSelection"],pA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Kp=new WeakMap,Zp=new WeakMap,qp=new WeakMap,ra=new WeakMap,Vf=new WeakMap,zf=new WeakMap,na=new WeakMap,gA=new WeakSet,iue=function(e){Yle(r,e);var t=Kle(r);function r(){var n;zle(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o)),Xle(Nt(n),gA),ta(Nt(n),"columnsLimit",1/0),ta(Nt(n),"rowsLimit",1/0),ta(Nt(n),"pasteMode","overwrite"),ta(Nt(n),"uiContainer",n.hot.rootDocument.body),Ci(Nt(n),Kp,{writable:!0,value:!1}),Ci(Nt(n),Zp,{writable:!0,value:!1}),Ci(Nt(n),qp,{writable:!0,value:!1}),Ci(Nt(n),ra,{writable:!0,value:"cells-only"}),Ci(Nt(n),Vf,{writable:!0,value:!1}),Ci(Nt(n),zf,{writable:!0,value:!1}),Ci(Nt(n),na,{writable:!0,value:new Hle({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),ta(Nt(n),"copyableRanges",[]),ta(Nt(n),"focusableElement",void 0),n}return Ule(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Wf]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o[Wf];if(Si(a)==="object"){var s,l;this.pasteMode=(s=a.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,un(this,Kp,!!a.copyColumnHeaders),un(this,Zp,!!a.copyColumnGroupHeaders),un(this,qp,!!a.copyColumnHeadersOnly),this.uiContainer=(l=a.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=kle(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),_i(ln(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),_i(ln(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&oA(this.focusableElement),_i(ln(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";un(this,ra,i),un(this,Vf,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){un(this,zf,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return _l(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,a=[],s=fA(i),l=s.rows,u=s.columns;return Ce(l,function(c){var h=[];Ce(u,function(d){c<0?h.push(o.hot.getColHeader(d,c)):h.push(o.hot.getCopyableData(c,d))}),a.push(h)}),a}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var a=new Cle;i&&a.clipboardData.setData("text/plain",i),o&&a.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){qt(this,na).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);qt(this,ra)==="column-headers-only"?o.set("headers",qt(this,na).getMostBottomColumnHeadersRange()):(qt(this,ra)==="with-column-headers"?o.set("headers",qt(this,na).getMostBottomColumnHeadersRange()):qt(this,ra)==="with-column-group-headers"&&o.set("headers",qt(this,na).getAllColumnHeadersRange()),o.set("cells",qt(this,na).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(h){return h!==null}).map(function(h){var d=h.startRow,f=h.startCol,v=h.endRow,y=h.endCol;return{startRow:d,startCol:f,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=o.get("cells");if(a!==null&&a.isRangeTrimmed){var s=a.startRow,l=a.startCol,u=a.endRow,c=a.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,c-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var a=i.length,s=i[0].length,l=[],u=o.getTopStartCorner(),c=u.row,h=u.col,d=o.getBottomEndCorner(),f=d.row,v=d.col,y=c,m=h,S=c,_=h;l.length<a||y<=f;){var O=this.hot.getCellMeta(y,h),R=O.skipRowOnPaste,T=O.visualRow;if(y=T+1,R!==!0){S=T,m=h;for(var D=[],H=l.length%a;D.length<s||m<=v;){var V=this.hot.getCellMeta(c,m),F=V.skipColumnOnPaste,q=V.visualCol;if(m=q+1,F!==!0){_=q;var le=D.length%s;D.push(i[H][le])}}l.push(D)}}return this.hot.populateFromArray(c,h,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,h,S,_]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!qt(this,Vf)||this.isEditorOpened())){this.setCopyableText(),un(this,Vf,!1);var o=this.getRangedData(this.copyableRanges),a=Jle(this,gA,oue).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a);if(s){var l=_l(o);if(i&&i.clipboardData){var u=GC(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[pA,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}un(this,ra,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!qt(this,zf)||this.isEditorOpened())){this.setCopyableText(),un(this,zf,!1);var o=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(a){var s=_l(o);if(i&&i.clipboardData){var l=GC(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[pA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var a=tC(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=uG(a,this.hot.rootDocument);o=s.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=roe(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var l=this.populateValues(o),u=Fle(l,4),c=u[0],h=u[1],d=u[2],f=u[3];this.hot.selectCell(c,h,Math.min(this.hot.countRows()-1,d),Math.min(this.hot.countCols()-1,f)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},ule(this)),qt(this,Kp)&&i.items.push(hle(this)),qt(this,Zp)&&i.items.push(fle(this)),qt(this,qp)&&i.items.push(cle(this)),i.items.push(dle(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&vz())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(oA(this.focusableElement),this.focusableElement=null),_i(ln(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Wf}},{key:"SETTING_KEYS",get:function(){return[Wf].concat(nue)}},{key:"PLUGIN_PRIORITY",get:function(){return rue}}]),r}(Hf);function oue(e){for(var t=fA(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function ia(e){"@babel/helpers - typeof";return ia=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ia(e)}function aue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lue(n.key),n)}}function sue(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lue(e){var t=uue(e,"string");return ia(t)==="symbol"?t:String(t)}function uue(e,t){if(ia(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ia(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oi(){return typeof Reflect<"u"&&Reflect.get?Oi=Reflect.get.bind():Oi=function(t,r,n){var i=cue(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Oi.apply(this,arguments)}function cue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cn(e),e!==null););return e}function fue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xp(e,t)}function Xp(e,t){return Xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Xp(e,t)}function hue(e){var t=vue();return function(){var n=cn(e),i;if(t){var o=cn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return due(this,i)}}function due(e,t){if(t&&(ia(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wA(e)}function wA(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cn(e){return cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cn(e)}var SA="dragToScroll",mue=100,yue=function(e){fue(r,e);var t=hue(r);function r(n){var i;return aue(this,r),i=t.call(this,n),i.eventManager=new En(wA(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return sue(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[SA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),Oi(cn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Oi(cn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Oi(cn(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var a=0,s=0;o<this.boundaries.top?s=o-this.boundaries.top:o>this.boundaries.bottom&&(s=o-this.boundaries.bottom),i<this.boundaries.left?a=i-this.boundaries.left:i>this.boundaries.right&&(a=i-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,a=o;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return i.onMouseMove(s)}),a=ym(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!xc(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(a,s){a<0?o.scrollLeft-=50:a>0&&(o.scrollLeft+=50),s<0?o.scrollTop-=20:s>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){Oi(cn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return SA}},{key:"PLUGIN_PRIORITY",get:function(){return mue}}]),r}(Hf);function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function pue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bue(n.key),n)}}function gue(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bue(e){var t=wue(e,"string");return Vl(t)==="symbol"?t:String(t)}function wue(e,t){if(Vl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qp=0,CA=1,OA=2,oa="px",Sue=function(){function e(t){pue(this,e),this.hot=t,this._element=null,this.state=Qp,this.inlineProperty=t.isRtl()?"right":"left"}return gue(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=OA}},{key:"build",value:function(){this.state===Qp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=CA)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Qp}},{key:"isAppended",value:function(){return this.state===OA}},{key:"isBuilt",value:function(){return this.state>=CA}},{key:"setPosition",value:function(r,n){kn(r)&&(this._element.style.top=r+oa),kn(n)&&(this._element.style[this.inlineProperty]=n+oa)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){kn(r)&&(this._element.style.width=r+oa),kn(n)&&(this._element.style.height=n+oa)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){kn(r)&&(this._element.style.marginTop=r+oa),kn(n)&&(this._element.style["margin".concat(so(this.inlineProperty))]=n+oa)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(so(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const TA=Sue;function aa(e){"@babel/helpers - typeof";return aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aa(e)}function _ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oue(n.key),n)}}function Cue(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oue(e){var t=Tue(e,"string");return aa(t)==="symbol"?t:String(t)}function Tue(e,t){if(aa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uf(){return typeof Reflect<"u"&&Reflect.get?Uf=Reflect.get.bind():Uf=function(t,r,n){var i=Rue(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Uf.apply(this,arguments)}function Rue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sa(e),e!==null););return e}function Eue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jp(e,t)}function Jp(e,t){return Jp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jp(e,t)}function kue(e){var t=Iue();return function(){var n=sa(e),i;if(t){var o=sa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Aue(this,i)}}function Aue(e,t){if(t&&(aa(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xue(e)}function xue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sa(e){return sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sa(e)}var Pue="ht__manualColumnMove--backlight",$ue=function(e){Eue(r,e);var t=kue(r);function r(){return _ue(this,r),t.apply(this,arguments)}return Cue(r,[{key:"build",value:function(){Uf(sa(r.prototype),"build",this).call(this),Ae(this._element,Pue)}}]),r}(TA);function la(e){"@babel/helpers - typeof";return la=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},la(e)}function Mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Due(n.key),n)}}function Nue(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Due(e){var t=Hue(e,"string");return la(t)==="symbol"?t:String(t)}function Hue(e,t){if(la(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(la(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gf(){return typeof Reflect<"u"&&Reflect.get?Gf=Reflect.get.bind():Gf=function(t,r,n){var i=Lue(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gf.apply(this,arguments)}function Lue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ua(e),e!==null););return e}function Fue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eg(e,t)}function eg(e,t){return eg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eg(e,t)}function jue(e){var t=Vue();return function(){var n=ua(e),i;if(t){var o=ua(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Bue(this,i)}}function Bue(e,t){if(t&&(la(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wue(e)}function Wue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ua(e){return ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ua(e)}var zue="ht__manualColumnMove--guideline",Uue=function(e){Fue(r,e);var t=jue(r);function r(){return Mue(this,r),t.apply(this,arguments)}return Nue(r,[{key:"build",value:function(){Gf(ua(r.prototype),"build",this).call(this),Ae(this._element,zue)}}]),r}(TA);function ca(e){"@babel/helpers - typeof";return ca=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ca(e)}function Gue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kue(n.key),n)}}function Yue(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kue(e){var t=Zue(e,"string");return ca(t)==="symbol"?t:String(t)}function Zue(e,t){if(ca(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ca(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ti(){return typeof Reflect<"u"&&Reflect.get?Ti=Reflect.get.bind():Ti=function(t,r,n){var i=que(t,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ti.apply(this,arguments)}function que(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fn(e),e!==null););return e}function Xue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tg(e,t)}function tg(e,t){return tg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tg(e,t)}function Que(e){var t=ece();return function(){var n=fn(e),i;if(t){var o=fn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Jue(this,i)}}function Jue(e,t){if(t&&(ca(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rg(e)}function rg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ece(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fn(e){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fn(e)}Ye.getSingleton().register("beforeColumnMove"),Ye.getSingleton().register("afterColumnMove");var ng="manualColumnMove",tce=120,Dn=new WeakMap,AA="ht__manualColumnMove",Yf="show-ui",ig="on-moving--columns",og="after-selection--columns",rce=function(e){Xue(r,e);var t=Que(r);function r(n){var i;return Gue(this,r),i=t.call(this,n),Dn.set(rg(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new En(rg(i)),i.backlight=new $ue(n),i.guideline=new Uue(n),i}return Yue(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ng]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ae(this.hot.rootElement,AA),Ti(fn(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Ti(fn(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qe(this.hot.rootElement,AA),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Ti(fn(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var a=Dn.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeColumnMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,o);var c=l&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,s,l,c),c}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var a=this.countFinalIndex(i,o),s=Dn.get(this);return s.cachedDropIndex=o,this.moveColumns(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(h){return h<0}),c=i.some(function(h){return h>=a});return!(s||l||u||c)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=Zi(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getColumnsWidth",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=0,l=i;l<=o;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[ng];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var a=[];return pt(i,o,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var i=Dn.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),c=a.hider.offsetWidth,h=a.TBODY.offsetLeft,d=this.backlight.getOffset().start,f=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,S=ht(this.hot.rootElement),_=m.innerWidth-i.rootElementOffset-S;y=m.innerWidth-i.target.eventPageX-_-(s.scrollX===void 0?l:0)}else y=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=v,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+u<=y){var O=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=O+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var R=y,T=u;y+f+d>=c?R=c-f-d:y+d<h+v&&(R=h+v+Math.abs(d)),u>=c-1?T=c-1:T===0?T=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(T-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,R),this.guideline.setPosition(null,T)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),h=Dn.get(this),d=Je(i.target,"sortAction");if(!c||!u||h.pressed||i.button!==0||d){h.pressed=!1,h.columnsToMove.length=0,qe(this.hot.rootElement,[ig,Yf]);return}var f=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();f&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var y=c.from,m=c.to,S=Math.min(y.col,m.col),_=Math.max(y.col,m.col);if(o.row<0&&o.col>=S&&o.col<=_){s.column=!0,h.pressed=!0,h.target.eventPageX=i.pageX,h.target.eventOffsetX=i.offsetX,h.hoveredColumn=o.col,h.target.TD=a,h.target.col=o.col,h.columnsToMove=this.prepareColumnsToMoving(S,_),h.hasRowHeaders=!!this.hot.getSettings().rowHeaders,h.countCols=this.hot.countCols(),h.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,h.rootElementOffset=Pt(this.hot.rootElement).left;var O=h.hasRowHeaders?-1:0,R=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,T=o.col<h.fixedColumnsStart,D=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),H=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),V=this.getColumnsWidth(S,o.col-1)+H,F=this.getColumnsWidth(O,S-1)+(T?D:0)+V;this.backlight.setPosition(R,F),this.backlight.setSize(this.getColumnsWidth(S,_),l.hider.offsetHeight-R),this.backlight.setOffset(null,-V),Ae(this.hot.rootElement,ig)}else qe(this.hot.rootElement,og),h.pressed=!1,h.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Dn.get(this);if(o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=Dn.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(o.col)>-1?qe(this.hot.rootElement,Yf):Ae(this.hot.rootElement,Yf),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=o.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=Dn.get(this),o=i.target.col,a=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,qe(this.hot.rootElement,[ig,Yf,og]),this.hot.selection.isSelectedByColumnHeader()&&Ae(this.hot.rootElement,og),!(a<1||o===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(l),h=c+a-1;this.hot.selectColumns(c,h)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,a=i.holder.scrollTop,s=o+a;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Ti(fn(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ng}},{key:"PLUGIN_PRIORITY",get:function(){return tce}}]),r}(Hf);const nce=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" slot="app-icon">
	<path d="M453-280h60v-240h-60v240Zm26.982-314q14.018 0 23.518-9.2T513-626q0-14.45-9.482-24.225-9.483-9.775-23.5-9.775-14.018 0-23.518 9.775T447-626q0 13.6 9.482 22.8 9.483 9.2 23.5 9.2Zm.284 514q-82.734 0-155.5-31.5t-127.266-86q-54.5-54.5-86-127.341Q80-397.681 80-480.5q0-82.819 31.5-155.659Q143-709 197.5-763t127.341-85.5Q397.681-880 480.5-880q82.819 0 155.659 31.5Q709-817 763-763t85.5 127Q880-563 880-480.266q0 82.734-31.5 155.5T763-197.684q-54 54.316-127 86Q563-80 480.266-80Zm.234-60Q622-140 721-239.5t99-241Q820-622 721.188-721 622.375-820 480-820q-141 0-240.5 98.812Q140-622.375 140-480q0 141 99.5 240.5t241 99.5Zm-.5-340Z" />
</svg>
`;function Kf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xA={exports:{}};/*!

	JSZip v3.9.1 - A JavaScript class for generating and reading zip files
	<http://stuartk.com/jszip>

	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

	JSZip uses the library pako released under the MIT license :
	https://github.com/nodeca/pako/blob/master/LICENSE
	*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,o){function a(u,c){if(!i[u]){if(!n[u]){var h=typeof Kf=="function"&&Kf;if(!c&&h)return h(u,!0);if(s)return s(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};n[u][0].call(f.exports,function(v){var y=n[u][1][v];return a(y||v)},f,f.exports,r,n,i,o)}return i[u].exports}for(var s=typeof Kf=="function"&&Kf,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(r,n,i){var o=r("./utils"),a=r("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u,c,h,d,f,v,y,m=[],S=0,_=l.length,O=_,R=o.getTypeOf(l)!=="string";S<l.length;)O=_-S,h=R?(u=l[S++],c=S<_?l[S++]:0,S<_?l[S++]:0):(u=l.charCodeAt(S++),c=S<_?l.charCodeAt(S++):0,S<_?l.charCodeAt(S++):0),d=u>>2,f=(3&u)<<4|c>>4,v=1<O?(15&c)<<2|h>>6:64,y=2<O?63&h:64,m.push(s.charAt(d)+s.charAt(f)+s.charAt(v)+s.charAt(y));return m.join("")},i.decode=function(l){var u,c,h,d,f,v,y=0,m=0,S="data:";if(l.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var _,O=3*(l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&O--,l.charAt(l.length-2)===s.charAt(64)&&O--,O%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|O):new Array(0|O);y<l.length;)u=s.indexOf(l.charAt(y++))<<2|(d=s.indexOf(l.charAt(y++)))>>4,c=(15&d)<<4|(f=s.indexOf(l.charAt(y++)))>>2,h=(3&f)<<6|(v=s.indexOf(l.charAt(y++))),_[m++]=u,f!==64&&(_[m++]=c),v!==64&&(_[m++]=h);return _}},{"./support":30,"./utils":32}],2:[function(r,n,i){var o=r("./external"),a=r("./stream/DataWorker"),s=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function u(c,h,d,f,v){this.compressedSize=c,this.uncompressedSize=h,this.crc32=d,this.compression=f,this.compressedContent=v}u.prototype={getContentWorker:function(){var c=new a(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,h,d){return c.pipe(new s).pipe(new l("uncompressedSize")).pipe(h.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var o=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(a){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var o=r("./utils"),a=function(){for(var s,l=[],u=0;u<256;u++){s=u;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;l[u]=s}return l}();n.exports=function(s,l){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(u,c,h,d){var f=a,v=d+h;u^=-1;for(var y=d;y<v;y++)u=u>>>8^f[255&(u^c[y])];return-1^u}(0|l,s,s.length,0):function(u,c,h,d){var f=a,v=d+h;u^=-1;for(var y=d;y<v;y++)u=u>>>8^f[255&(u^c.charCodeAt(y))];return-1^u}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var o=null;o=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:o}},{lie:37}],7:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=r("pako"),s=r("./utils"),l=r("./stream/GenericWorker"),u=o?"uint8array":"array";function c(h,d){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=d,this.meta={}}i.magic="\b\0",s.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(d){h.push({data:d,meta:h.meta})}},i.compressWorker=function(h){return new c("Deflate",h)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function o(f,v){var y,m="";for(y=0;y<v;y++)m+=String.fromCharCode(255&f),f>>>=8;return m}function a(f,v,y,m,S,_){var O,R,T=f.file,D=f.compression,H=_!==u.utf8encode,V=s.transformTo("string",_(T.name)),F=s.transformTo("string",u.utf8encode(T.name)),q=T.comment,le=s.transformTo("string",_(q)),I=s.transformTo("string",u.utf8encode(q)),j=F.length!==T.name.length,C=I.length!==q.length,z="",fe="",G="",ve=T.dir,Q=T.date,g={crc32:0,compressedSize:0,uncompressedSize:0};v&&!y||(g.crc32=f.crc32,g.compressedSize=f.compressedSize,g.uncompressedSize=f.uncompressedSize);var p=0;v&&(p|=8),H||!j&&!C||(p|=2048);var w=0,x=0;ve&&(w|=16),S==="UNIX"?(x=798,w|=function(P,N){var Z=P;return P||(Z=N?16893:33204),(65535&Z)<<16}(T.unixPermissions,ve)):(x=20,w|=function(P){return 63&(P||0)}(T.dosPermissions)),O=Q.getUTCHours(),O<<=6,O|=Q.getUTCMinutes(),O<<=5,O|=Q.getUTCSeconds()/2,R=Q.getUTCFullYear()-1980,R<<=4,R|=Q.getUTCMonth()+1,R<<=5,R|=Q.getUTCDate(),j&&(fe=o(1,1)+o(c(V),4)+F,z+="up"+o(fe.length,2)+fe),C&&(G=o(1,1)+o(c(le),4)+I,z+="uc"+o(G.length,2)+G);var k="";return k+=`
\0`,k+=o(p,2),k+=D.magic,k+=o(O,2),k+=o(R,2),k+=o(g.crc32,4),k+=o(g.compressedSize,4),k+=o(g.uncompressedSize,4),k+=o(V.length,2),k+=o(z.length,2),{fileRecord:h.LOCAL_FILE_HEADER+k+V+z,dirRecord:h.CENTRAL_FILE_HEADER+o(x,2)+k+o(le.length,2)+"\0\0\0\0"+o(w,4)+o(m,4)+V+z+le}}var s=r("../utils"),l=r("../stream/GenericWorker"),u=r("../utf8"),c=r("../crc32"),h=r("../signature");function d(f,v,y,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=y,this.encodeFileName=m,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,l),d.prototype.push=function(f){var v=f.meta.percent||0,y=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:y?(v+100*(y-m-1))/y:100}}))},d.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var v=this.streamFiles&&!f.file.dir;if(v){var y=a(f,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(f){this.accumulate=!1;var v=this.streamFiles&&!f.file.dir,y=a(f,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),v)this.push({data:function(m){return h.DATA_DESCRIPTOR+o(m.crc32,4)+o(m.compressedSize,4)+o(m.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var f=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var y=this.bytesWritten-f,m=function(S,_,O,R,T){var D=s.transformTo("string",T(R));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(S,2)+o(S,2)+o(_,4)+o(O,4)+o(D.length,2)+D}(this.dirRecords.length,y,f,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(f){this._sources.push(f);var v=this;return f.on("data",function(y){v.processChunk(y)}),f.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),f.on("error",function(y){v.error(y)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(f){var v=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var y=0;y<v.length;y++)try{v[y].error(f)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,v=0;v<f.length;v++)f[v].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var o=r("../compressions"),a=r("./ZipFileWorker");i.generateWorker=function(s,l,u){var c=new a(l.streamFiles,u,l.platform,l.encodeFileName),h=0;try{s.forEach(function(d,f){h++;var v=function(_,O){var R=_||O,T=o[R];if(!T)throw new Error(R+" is not a valid compression method !");return T}(f.options.compression,l.compression),y=f.options.compressionOptions||l.compressionOptions||{},m=f.dir,S=f.date;f._compressWorker(v,y).withStreamInfo("file",{name:d,dir:m,date:S,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(c)}),c.entriesCount=h}catch(d){c.error(d)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new o;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.9.1",o.loadAsync=function(a,s){return new o().loadAsync(a,s)},o.external=r("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var o=r("./utils"),a=r("./external"),s=r("./utf8"),l=r("./zipEntries"),u=r("./stream/Crc32Probe"),c=r("./nodejsUtils");function h(d){return new a.Promise(function(f,v){var y=d.decompressed.getContentWorker().pipe(new u);y.on("error",function(m){v(m)}).on("end",function(){y.streamInfo.crc32!==d.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}n.exports=function(d,f){var v=this;return f=o.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(y){var m=new l(f);return m.load(y),m}).then(function(y){var m=[a.Promise.resolve(y)],S=y.files;if(f.checkCRC32)for(var _=0;_<S.length;_++)m.push(h(S[_]));return a.Promise.all(m)}).then(function(y){for(var m=y.shift(),S=m.files,_=0;_<S.length;_++){var O=S[_],R=O.fileNameStr,T=o.resolve(O.fileNameStr);v.file(T,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:f.createFolders}),O.dir||(v.file(T).unsafeOriginalName=R)}return m.zipComment.length&&(v.comment=m.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var o=r("../utils"),a=r("../stream/GenericWorker");function s(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}o.inherits(s,a),s.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var o=r("readable-stream").Readable;function a(s,l,u){o.call(this,l),this._helper=s;var c=this;s.on("data",function(h,d){c.push(h)||c._helper.pause(),u&&u(d)}).on("error",function(h){c.emit("error",h)}).on("end",function(){c.push(null)})}r("../utils").inherits(a,o),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,a);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,a)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var a=new Buffer(o);return a.fill(0),a},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,n,i){function o(T,D,H){var V,F=s.getTypeOf(D),q=s.extend(H||{},c);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(T=S(T)),q.createFolders&&(V=m(T))&&_.call(this,V,!0);var le=F==="string"&&q.binary===!1&&q.base64===!1;H&&H.binary!==void 0||(q.binary=!le),(D instanceof h&&D.uncompressedSize===0||q.dir||!D||D.length===0)&&(q.base64=!1,q.binary=!0,D="",q.compression="STORE",F="string");var I=null;I=D instanceof h||D instanceof l?D:v.isNode&&v.isStream(D)?new y(T,D):s.prepareContent(T,D,q.binary,q.optimizedBinaryString,q.base64);var j=new d(T,I,q);this.files[T]=j}var a=r("./utf8"),s=r("./utils"),l=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),c=r("./defaults"),h=r("./compressedObject"),d=r("./zipObject"),f=r("./generate"),v=r("./nodejsUtils"),y=r("./nodejs/NodejsStreamInputAdapter"),m=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var D=T.lastIndexOf("/");return 0<D?T.substring(0,D):""},S=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},_=function(T,D){return D=D!==void 0?D:c.createFolders,T=S(T),this.files[T]||o.call(this,T,null,{dir:!0,createFolders:D}),this.files[T]};function O(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var R={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var D,H,V;for(D in this.files)V=this.files[D],(H=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&T(H,V)},filter:function(T){var D=[];return this.forEach(function(H,V){T(H,V)&&D.push(V)}),D},file:function(T,D,H){if(arguments.length!==1)return T=this.root+T,o.call(this,T,D,H),this;if(O(T)){var V=T;return this.filter(function(q,le){return!le.dir&&V.test(q)})}var F=this.files[this.root+T];return F&&!F.dir?F:null},folder:function(T){if(!T)return this;if(O(T))return this.filter(function(F,q){return q.dir&&T.test(F)});var D=this.root+T,H=_.call(this,D),V=this.clone();return V.root=H.name,V},remove:function(T){T=this.root+T;var D=this.files[T];if(D||(T.slice(-1)!=="/"&&(T+="/"),D=this.files[T]),D&&!D.dir)delete this.files[T];else for(var H=this.filter(function(F,q){return q.name.slice(0,T.length)===T}),V=0;V<H.length;V++)delete this.files[H[V].name];return this},generate:function(T){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var D,H={};try{if((H=s.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=H.type.toLowerCase(),H.compression=H.compression.toUpperCase(),H.type==="binarystring"&&(H.type="string"),!H.type)throw new Error("No output type specified.");s.checkSupport(H.type),H.platform!=="darwin"&&H.platform!=="freebsd"&&H.platform!=="linux"&&H.platform!=="sunos"||(H.platform="UNIX"),H.platform==="win32"&&(H.platform="DOS");var V=H.comment||this.comment||"";D=f.generateWorker(this,H,V)}catch(F){(D=new l("error")).error(F)}return new u(D,H.type||"string",H.mimeType)},generateAsync:function(T,D){return this.generateInternalStream(T).accumulate(D)},generateNodeStream:function(T,D){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(D)}};n.exports=R},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var o=r("./DataReader");function a(s){o.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}r("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),h=s.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===u&&this.data[d+2]===c&&this.data[d+3]===h)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),h=s.charCodeAt(3),d=this.readData(4);return l===d[0]&&u===d[1]&&c===d[2]&&h===d[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var o=r("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(s){},readInt:function(s){var l,u=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=s,u},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(s){},lastIndexOfSignature:function(s){},readAndCheckSignature:function(s){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=a},{"../utils":32}],19:[function(r,n,i){var o=r("./Uint8ArrayReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var o=r("./DataReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var o=r("./ArrayReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var o=r("../utils"),a=r("../support"),s=r("./ArrayReader"),l=r("./StringReader"),u=r("./NodeBufferReader"),c=r("./Uint8ArrayReader");n.exports=function(h){var d=o.getTypeOf(h);return o.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new u(h):a.uint8array?new c(o.transformTo("uint8array",h)):new s(o.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var o=r("./GenericWorker"),a=r("../utils");function s(l){o.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,o),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var o=r("./GenericWorker"),a=r("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(s,o),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var o=r("../utils"),a=r("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(s,a),s.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var o=r("../utils"),a=r("./GenericWorker");function s(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=o.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}o.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function o(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=o},{}],29:[function(r,n,i){var o=r("../utils"),a=r("./ConvertWorker"),s=r("./GenericWorker"),l=r("../base64"),u=r("../support"),c=r("../external"),h=null;if(u.nodestream)try{h=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(v,y){return new c.Promise(function(m,S){var _=[],O=v._internalType,R=v._outputType,T=v._mimeType;v.on("data",function(D,H){_.push(D),y&&y(H)}).on("error",function(D){_=[],S(D)}).on("end",function(){try{var D=function(H,V,F){switch(H){case"blob":return o.newBlob(o.transformTo("arraybuffer",V),F);case"base64":return l.encode(V);default:return o.transformTo(H,V)}}(R,function(H,V){var F,q=0,le=null,I=0;for(F=0;F<V.length;F++)I+=V[F].length;switch(H){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(le=new Uint8Array(I),F=0;F<V.length;F++)le.set(V[F],q),q+=V[F].length;return le;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+H+"'")}}(O,_),T);m(D)}catch(H){S(H)}_=[]}).resume()})}function f(v,y,m){var S=y;switch(y){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=y,this._mimeType=m,o.checkSupport(S),this._worker=v.pipe(new a(S)),v.lock()}catch(_){this._worker=new s("error"),this._worker.error(_)}}f.prototype={accumulate:function(v){return d(this,v)},on:function(v,y){var m=this;return v==="data"?this._worker.on(v,function(S){y.call(m,S.data,S.meta)}):this._worker.on(v,function(){o.delay(y,arguments,m)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(o),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var o=r("./utils"),a=r("./support"),s=r("./nodejsUtils"),l=r("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}i.utf8encode=function(f){return a.nodebuffer?s.newBufferFrom(f,"utf-8"):function(v){var y,m,S,_,O,R=v.length,T=0;for(_=0;_<R;_++)(64512&(m=v.charCodeAt(_)))==55296&&_+1<R&&(64512&(S=v.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(S-56320),_++),T+=m<128?1:m<2048?2:m<65536?3:4;for(y=a.uint8array?new Uint8Array(T):new Array(T),_=O=0;O<T;_++)(64512&(m=v.charCodeAt(_)))==55296&&_+1<R&&(64512&(S=v.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(S-56320),_++),m<128?y[O++]=m:(m<2048?y[O++]=192|m>>>6:(m<65536?y[O++]=224|m>>>12:(y[O++]=240|m>>>18,y[O++]=128|m>>>12&63),y[O++]=128|m>>>6&63),y[O++]=128|63&m);return y}(f)},i.utf8decode=function(f){return a.nodebuffer?o.transformTo("nodebuffer",f).toString("utf-8"):function(v){var y,m,S,_,O=v.length,R=new Array(2*O);for(y=m=0;y<O;)if((S=v[y++])<128)R[m++]=S;else if(4<(_=u[S]))R[m++]=65533,y+=_-1;else{for(S&=_===2?31:_===3?15:7;1<_&&y<O;)S=S<<6|63&v[y++],_--;1<_?R[m++]=65533:S<65536?R[m++]=S:(S-=65536,R[m++]=55296|S>>10&1023,R[m++]=56320|1023&S)}return R.length!==m&&(R.subarray?R=R.subarray(0,m):R.length=m),o.applyFromCharCode(R)}(f=o.transformTo(a.uint8array?"uint8array":"array",f))},o.inherits(h,l),h.prototype.processChunk=function(f){var v=o.transformTo(a.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var y=v;(v=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),v.set(y,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var m=function(_,O){var R;for((O=O||_.length)>_.length&&(O=_.length),R=O-1;0<=R&&(192&_[R])==128;)R--;return R<0||R===0?O:R+u[_[R]]>O?R:O}(v),S=v;m!==v.length&&(a.uint8array?(S=v.subarray(0,m),this.leftOver=v.subarray(m,v.length)):(S=v.slice(0,m),this.leftOver=v.slice(m,v.length))),this.push({data:i.utf8decode(S),meta:f.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,o.inherits(d,l),d.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var o=r("./support"),a=r("./base64"),s=r("./nodejsUtils"),l=r("set-immediate-shim"),u=r("./external");function c(m){return m}function h(m,S){for(var _=0;_<m.length;++_)S[_]=255&m.charCodeAt(_);return S}i.newBlob=function(m,S){i.checkSupport("blob");try{return new Blob([m],{type:S})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(m),_.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(m,S,_){var O=[],R=0,T=m.length;if(T<=_)return String.fromCharCode.apply(null,m);for(;R<T;)S==="array"||S==="nodebuffer"?O.push(String.fromCharCode.apply(null,m.slice(R,Math.min(R+_,T)))):O.push(String.fromCharCode.apply(null,m.subarray(R,Math.min(R+_,T)))),R+=_;return O.join("")},stringifyByChar:function(m){for(var S="",_=0;_<m.length;_++)S+=String.fromCharCode(m[_]);return S},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function f(m){var S=65536,_=i.getTypeOf(m),O=!0;if(_==="uint8array"?O=d.applyCanBeUsed.uint8array:_==="nodebuffer"&&(O=d.applyCanBeUsed.nodebuffer),O)for(;1<S;)try{return d.stringifyByChunk(m,_,S)}catch{S=Math.floor(S/2)}return d.stringifyByChar(m)}function v(m,S){for(var _=0;_<m.length;_++)S[_]=m[_];return S}i.applyFromCharCode=f;var y={};y.string={string:c,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return y.string.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:function(m){return h(m,s.allocBuffer(m.length))}},y.array={string:f,array:c,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return s.newBufferFrom(m)}},y.arraybuffer={string:function(m){return f(new Uint8Array(m))},array:function(m){return v(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:c,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return s.newBufferFrom(new Uint8Array(m))}},y.uint8array={string:f,array:function(m){return v(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:c,nodebuffer:function(m){return s.newBufferFrom(m)}},y.nodebuffer={string:f,array:function(m){return v(m,new Array(m.length))},arraybuffer:function(m){return y.nodebuffer.uint8array(m).buffer},uint8array:function(m){return v(m,new Uint8Array(m.length))},nodebuffer:c},i.transformTo=function(m,S){if(S=S||"",!m)return S;i.checkSupport(m);var _=i.getTypeOf(S);return y[_][m](S)},i.resolve=function(m){for(var S=m.split("/"),_=[],O=0;O<S.length;O++){var R=S[O];R==="."||R===""&&O!==0&&O!==S.length-1||(R===".."?_.pop():_.push(R))}return _.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(m)?"nodebuffer":o.uint8array&&m instanceof Uint8Array?"uint8array":o.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!o[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var S,_,O="";for(_=0;_<(m||"").length;_++)O+="\\x"+((S=m.charCodeAt(_))<16?"0":"")+S.toString(16).toUpperCase();return O},i.delay=function(m,S,_){l(function(){m.apply(_||null,S||[])})},i.inherits=function(m,S){function _(){}_.prototype=S.prototype,m.prototype=new _},i.extend=function(){var m,S,_={};for(m=0;m<arguments.length;m++)for(S in arguments[m])arguments[m].hasOwnProperty(S)&&_[S]===void 0&&(_[S]=arguments[m][S]);return _},i.prepareContent=function(m,S,_,O,R){return u.Promise.resolve(S).then(function(T){return o.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new u.Promise(function(D,H){var V=new FileReader;V.onload=function(F){D(F.target.result)},V.onerror=function(F){H(F.target.error)},V.readAsArrayBuffer(T)}):T}).then(function(T){var D=i.getTypeOf(T);return D?(D==="arraybuffer"?T=i.transformTo("uint8array",T):D==="string"&&(R?T=a.decode(T):_&&O!==!0&&(T=function(H){return h(H,o.uint8array?new Uint8Array(H.length):new Array(H.length))}(T))),T):u.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(r,n,i){var o=r("./reader/readerFor"),a=r("./utils"),s=r("./signature"),l=r("./zipEntry"),u=(r("./utf8"),r("./support"));function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(h)+")")}},isSignature:function(h,d){var f=this.reader.index;this.reader.setIndex(h);var v=this.reader.readString(4)===d;return this.reader.setIndex(f),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",f=a.transformTo(d,h);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,d,f,v=this.zip64EndOfCentralSize-44;0<v;)h=this.reader.readInt(2),d=this.reader.readInt(4),f=this.reader.readData(d),this.zip64ExtensibleData[h]={id:h,length:d,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,d;for(h=0;h<this.files.length;h++)d=this.files[h],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var d=h;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var v=d-f;if(0<v)this.isSignature(d,s.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(h){this.reader=o(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var o=r("./reader/readerFor"),a=r("./utils"),s=r("./compressedObject"),l=r("./crc32"),u=r("./utf8"),c=r("./compressions"),h=r("./support");function d(f,v){this.options=f,this.loadOptions=v}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var v,y;if(f.skip(22),this.fileNameLength=f.readInt(2),y=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(m){for(var S in c)if(c.hasOwnProperty(S)&&c[S].magic===m)return c[S];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,v,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var v=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(v),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(f){if(this.extraFields[1]){var v=o(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(f){var v,y,m,S=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<S;)v=f.readInt(2),y=f.readInt(2),m=f.readData(y),this.extraFields[v]={id:v,length:y,value:m};f.setIndex(S)},handleUTF8:function(){var f=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var y=a.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var S=a.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var v=o(f.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var v=o(f.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(f.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function o(v,y,m){this.name=v,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=y,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var a=r("./stream/StreamHelper"),s=r("./stream/DataWorker"),l=r("./utf8"),u=r("./compressedObject"),c=r("./stream/GenericWorker");o.prototype={internalStream:function(v){var y=null,m="string";try{if(!v)throw new Error("No output type specified.");var S=(m=v.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),y=this._decompressWorker();var _=!this._dataBinary;_&&!S&&(y=y.pipe(new l.Utf8EncodeWorker)),!_&&S&&(y=y.pipe(new l.Utf8DecodeWorker))}catch(O){(y=new c("error")).error(O)}return new a(y,m,"")},async:function(v,y){return this.internalStream(v).accumulate(y)},nodeStream:function(v,y){return this.internalStream(v||"nodebuffer").toNodejsStream(y)},_compressWorker:function(v,y){if(this._data instanceof u&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(m,v,y)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)o.prototype[h[f]]=d;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(o){var a,s,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var u=0,c=new l(v),h=o.document.createTextNode("");c.observe(h,{characterData:!0}),a=function(){h.data=u=++u%2}}else if(o.setImmediate||o.MessageChannel===void 0)a="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var y=o.document.createElement("script");y.onreadystatechange=function(){v(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},o.document.documentElement.appendChild(y)}:function(){setTimeout(v,0)};else{var d=new o.MessageChannel;d.port1.onmessage=v,a=function(){d.port2.postMessage(0)}}var f=[];function v(){var y,m;s=!0;for(var S=f.length;S;){for(m=f,f=[],y=-1;++y<S;)m[y]();S=f.length}s=!1}n.exports=function(y){f.push(y)!==1||s||a()}}).call(this,typeof jn<"u"?jn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var o=r("immediate");function a(){}var s={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function h(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,S!==a&&y(this,S)}function d(S,_,O){this.promise=S,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}function f(S,_,O){o(function(){var R;try{R=_(O)}catch(T){return s.reject(S,T)}R===S?s.reject(S,new TypeError("Cannot resolve promise with itself")):s.resolve(S,R)})}function v(S){var _=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof _=="function")return function(){_.apply(S,arguments)}}function y(S,_){var O=!1;function R(H){O||(O=!0,s.reject(S,H))}function T(H){O||(O=!0,s.resolve(S,H))}var D=m(function(){_(T,R)});D.status==="error"&&R(D.value)}function m(S,_){var O={};try{O.value=S(_),O.status="success"}catch(R){O.status="error",O.value=R}return O}(n.exports=h).prototype.finally=function(S){if(typeof S!="function")return this;var _=this.constructor;return this.then(function(O){return _.resolve(S()).then(function(){return O})},function(O){return _.resolve(S()).then(function(){throw O})})},h.prototype.catch=function(S){return this.then(null,S)},h.prototype.then=function(S,_){if(typeof S!="function"&&this.state===u||typeof _!="function"&&this.state===l)return this;var O=new this.constructor(a);return this.state!==c?f(O,this.state===u?S:_,this.outcome):this.queue.push(new d(O,S,_)),O},d.prototype.callFulfilled=function(S){s.resolve(this.promise,S)},d.prototype.otherCallFulfilled=function(S){f(this.promise,this.onFulfilled,S)},d.prototype.callRejected=function(S){s.reject(this.promise,S)},d.prototype.otherCallRejected=function(S){f(this.promise,this.onRejected,S)},s.resolve=function(S,_){var O=m(v,_);if(O.status==="error")return s.reject(S,O.value);var R=O.value;if(R)y(S,R);else{S.state=u,S.outcome=_;for(var T=-1,D=S.queue.length;++T<D;)S.queue[T].callFulfilled(_)}return S},s.reject=function(S,_){S.state=l,S.outcome=_;for(var O=-1,R=S.queue.length;++O<R;)S.queue[O].callRejected(_);return S},h.resolve=function(S){return S instanceof this?S:s.resolve(new this(a),S)},h.reject=function(S){var _=new this(a);return s.reject(_,S)},h.all=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=S.length,R=!1;if(!O)return this.resolve([]);for(var T=new Array(O),D=0,H=-1,V=new this(a);++H<O;)F(S[H],H);return V;function F(q,le){_.resolve(q).then(function(I){T[le]=I,++D!==O||R||(R=!0,s.resolve(V,T))},function(I){R||(R=!0,s.reject(V,I))})}},h.race=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=S.length,R=!1;if(!O)return this.resolve([]);for(var T=-1,D=new this(a);++T<O;)H=S[T],_.resolve(H).then(function(V){R||(R=!0,s.resolve(D,V))},function(V){R||(R=!0,s.reject(D,V))});var H;return D}},{immediate:36}],38:[function(r,n,i){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var o=r("./zlib/deflate"),a=r("./utils/common"),s=r("./utils/strings"),l=r("./zlib/messages"),u=r("./zlib/zstream"),c=Object.prototype.toString,h=0,d=-1,f=0,v=8;function y(S){if(!(this instanceof y))return new y(S);this.options=a.assign({level:d,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},S||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var O=o.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(O!==h)throw new Error(l[O]);if(_.header&&o.deflateSetHeader(this.strm,_.header),_.dictionary){var R;if(R=typeof _.dictionary=="string"?s.string2buf(_.dictionary):c.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(O=o.deflateSetDictionary(this.strm,R))!==h)throw new Error(l[O]);this._dict_set=!0}}function m(S,_){var O=new y(_);if(O.push(S,!0),O.err)throw O.msg||l[O.err];return O.result}y.prototype.push=function(S,_){var O,R,T=this.strm,D=this.options.chunkSize;if(this.ended)return!1;R=_===~~_?_:_===!0?4:0,typeof S=="string"?T.input=s.string2buf(S):c.call(S)==="[object ArrayBuffer]"?T.input=new Uint8Array(S):T.input=S,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new a.Buf8(D),T.next_out=0,T.avail_out=D),(O=o.deflate(T,R))!==1&&O!==h)return this.onEnd(O),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||R!==4&&R!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(T.output,T.next_out))):this.onData(a.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&O!==1);return R===4?(O=o.deflateEnd(this.strm),this.onEnd(O),this.ended=!0,O===h):R!==2||(this.onEnd(h),!(T.avail_out=0))},y.prototype.onData=function(S){this.chunks.push(S)},y.prototype.onEnd=function(S){S===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},i.Deflate=y,i.deflate=m,i.deflateRaw=function(S,_){return(_=_||{}).raw=!0,m(S,_)},i.gzip=function(S,_){return(_=_||{}).gzip=!0,m(S,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var o=r("./zlib/inflate"),a=r("./utils/common"),s=r("./utils/strings"),l=r("./zlib/constants"),u=r("./zlib/messages"),c=r("./zlib/zstream"),h=r("./zlib/gzheader"),d=Object.prototype.toString;function f(y){if(!(this instanceof f))return new f(y);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},y||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||y&&y.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=o.inflateInit2(this.strm,m.windowBits);if(S!==l.Z_OK)throw new Error(u[S]);this.header=new h,o.inflateGetHeader(this.strm,this.header)}function v(y,m){var S=new f(m);if(S.push(y,!0),S.err)throw S.msg||u[S.err];return S.result}f.prototype.push=function(y,m){var S,_,O,R,T,D,H=this.strm,V=this.options.chunkSize,F=this.options.dictionary,q=!1;if(this.ended)return!1;_=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof y=="string"?H.input=s.binstring2buf(y):d.call(y)==="[object ArrayBuffer]"?H.input=new Uint8Array(y):H.input=y,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new a.Buf8(V),H.next_out=0,H.avail_out=V),(S=o.inflate(H,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&F&&(D=typeof F=="string"?s.string2buf(F):d.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,S=o.inflateSetDictionary(this.strm,D)),S===l.Z_BUF_ERROR&&q===!0&&(S=l.Z_OK,q=!1),S!==l.Z_STREAM_END&&S!==l.Z_OK)return this.onEnd(S),!(this.ended=!0);H.next_out&&(H.avail_out!==0&&S!==l.Z_STREAM_END&&(H.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(O=s.utf8border(H.output,H.next_out),R=H.next_out-O,T=s.buf2string(H.output,O),H.next_out=R,H.avail_out=V-R,R&&a.arraySet(H.output,H.output,O,R,0),this.onData(T)):this.onData(a.shrinkBuf(H.output,H.next_out)))),H.avail_in===0&&H.avail_out===0&&(q=!0)}while((0<H.avail_in||H.avail_out===0)&&S!==l.Z_STREAM_END);return S===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(S=o.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(H.avail_out=0))},f.prototype.onData=function(y){this.chunks.push(y)},f.prototype.onEnd=function(y){y===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Inflate=f,i.inflate=v,i.inflateRaw=function(y,m){return(m=m||{}).raw=!0,v(y,m)},i.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,h,d){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+h),d);else for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){var u,c,h,d,f,v;for(u=h=0,c=l.length;u<c;u++)h+=l[u].length;for(v=new Uint8Array(h),u=d=0,c=l.length;u<c;u++)f=l[u],v.set(f,d),d+=f.length;return v}},s={arraySet:function(l,u,c,h,d){for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(o)},{}],42:[function(r,n,i){var o=r("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new o.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(h,d){if(d<65537&&(h.subarray&&s||!h.subarray&&a))return String.fromCharCode.apply(null,o.shrinkBuf(h,d));for(var f="",v=0;v<d;v++)f+=String.fromCharCode(h[v]);return f}l[254]=l[254]=1,i.string2buf=function(h){var d,f,v,y,m,S=h.length,_=0;for(y=0;y<S;y++)(64512&(f=h.charCodeAt(y)))==55296&&y+1<S&&(64512&(v=h.charCodeAt(y+1)))==56320&&(f=65536+(f-55296<<10)+(v-56320),y++),_+=f<128?1:f<2048?2:f<65536?3:4;for(d=new o.Buf8(_),y=m=0;m<_;y++)(64512&(f=h.charCodeAt(y)))==55296&&y+1<S&&(64512&(v=h.charCodeAt(y+1)))==56320&&(f=65536+(f-55296<<10)+(v-56320),y++),f<128?d[m++]=f:(f<2048?d[m++]=192|f>>>6:(f<65536?d[m++]=224|f>>>12:(d[m++]=240|f>>>18,d[m++]=128|f>>>12&63),d[m++]=128|f>>>6&63),d[m++]=128|63&f);return d},i.buf2binstring=function(h){return c(h,h.length)},i.binstring2buf=function(h){for(var d=new o.Buf8(h.length),f=0,v=d.length;f<v;f++)d[f]=h.charCodeAt(f);return d},i.buf2string=function(h,d){var f,v,y,m,S=d||h.length,_=new Array(2*S);for(f=v=0;f<S;)if((y=h[f++])<128)_[v++]=y;else if(4<(m=l[y]))_[v++]=65533,f+=m-1;else{for(y&=m===2?31:m===3?15:7;1<m&&f<S;)y=y<<6|63&h[f++],m--;1<m?_[v++]=65533:y<65536?_[v++]=y:(y-=65536,_[v++]=55296|y>>10&1023,_[v++]=56320|1023&y)}return c(_,v)},i.utf8border=function(h,d){var f;for((d=d||h.length)>h.length&&(d=h.length),f=d-1;0<=f&&(192&h[f])==128;)f--;return f<0||f===0?d:f+l[h[f]]>d?f:d}},{"./common":41}],43:[function(r,n,i){n.exports=function(o,a,s,l){for(var u=65535&o|0,c=o>>>16&65535|0,h=0;s!==0;){for(s-=h=2e3<s?2e3:s;c=c+(u=u+a[l++]|0)|0,--h;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var o=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();n.exports=function(a,s,l,u){var c=o,h=u+l;a^=-1;for(var d=u;d<h;d++)a=a>>>8^c[255&(a^s[d])];return-1^a}},{}],46:[function(r,n,i){var o,a=r("../utils/common"),s=r("./trees"),l=r("./adler32"),u=r("./crc32"),c=r("./messages"),h=0,d=4,f=0,v=-2,y=-1,m=4,S=2,_=8,O=9,R=286,T=30,D=19,H=2*R+1,V=15,F=3,q=258,le=q+F+1,I=42,j=113,C=1,z=2,fe=3,G=4;function ve(b,W){return b.msg=c[W],W}function Q(b){return(b<<1)-(4<b?9:0)}function g(b){for(var W=b.length;0<=--W;)b[W]=0}function p(b){var W=b.state,B=W.pending;B>b.avail_out&&(B=b.avail_out),B!==0&&(a.arraySet(b.output,W.pending_buf,W.pending_out,B,b.next_out),b.next_out+=B,W.pending_out+=B,b.total_out+=B,b.avail_out-=B,W.pending-=B,W.pending===0&&(W.pending_out=0))}function w(b,W){s._tr_flush_block(b,0<=b.block_start?b.block_start:-1,b.strstart-b.block_start,W),b.block_start=b.strstart,p(b.strm)}function x(b,W){b.pending_buf[b.pending++]=W}function k(b,W){b.pending_buf[b.pending++]=W>>>8&255,b.pending_buf[b.pending++]=255&W}function P(b,W){var B,A,E=b.max_chain_length,$=b.strstart,Y=b.prev_length,K=b.nice_match,L=b.strstart>b.w_size-le?b.strstart-(b.w_size-le):0,J=b.window,oe=b.w_mask,ee=b.prev,de=b.strstart+q,Pe=J[$+Y-1],Se=J[$+Y];b.prev_length>=b.good_match&&(E>>=2),K>b.lookahead&&(K=b.lookahead);do if(J[(B=W)+Y]===Se&&J[B+Y-1]===Pe&&J[B]===J[$]&&J[++B]===J[$+1]){$+=2,B++;do;while(J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&J[++$]===J[++B]&&$<de);if(A=q-(de-$),$=de-q,Y<A){if(b.match_start=W,K<=(Y=A))break;Pe=J[$+Y-1],Se=J[$+Y]}}while((W=ee[W&oe])>L&&--E!=0);return Y<=b.lookahead?Y:b.lookahead}function N(b){var W,B,A,E,$,Y,K,L,J,oe,ee=b.w_size;do{if(E=b.window_size-b.lookahead-b.strstart,b.strstart>=ee+(ee-le)){for(a.arraySet(b.window,b.window,ee,ee,0),b.match_start-=ee,b.strstart-=ee,b.block_start-=ee,W=B=b.hash_size;A=b.head[--W],b.head[W]=ee<=A?A-ee:0,--B;);for(W=B=ee;A=b.prev[--W],b.prev[W]=ee<=A?A-ee:0,--B;);E+=ee}if(b.strm.avail_in===0)break;if(Y=b.strm,K=b.window,L=b.strstart+b.lookahead,J=E,oe=void 0,oe=Y.avail_in,J<oe&&(oe=J),B=oe===0?0:(Y.avail_in-=oe,a.arraySet(K,Y.input,Y.next_in,oe,L),Y.state.wrap===1?Y.adler=l(Y.adler,K,oe,L):Y.state.wrap===2&&(Y.adler=u(Y.adler,K,oe,L)),Y.next_in+=oe,Y.total_in+=oe,oe),b.lookahead+=B,b.lookahead+b.insert>=F)for($=b.strstart-b.insert,b.ins_h=b.window[$],b.ins_h=(b.ins_h<<b.hash_shift^b.window[$+1])&b.hash_mask;b.insert&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[$+F-1])&b.hash_mask,b.prev[$&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=$,$++,b.insert--,!(b.lookahead+b.insert<F)););}while(b.lookahead<le&&b.strm.avail_in!==0)}function Z(b,W){for(var B,A;;){if(b.lookahead<le){if(N(b),b.lookahead<le&&W===h)return C;if(b.lookahead===0)break}if(B=0,b.lookahead>=F&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+F-1])&b.hash_mask,B=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),B!==0&&b.strstart-B<=b.w_size-le&&(b.match_length=P(b,B)),b.match_length>=F)if(A=s._tr_tally(b,b.strstart-b.match_start,b.match_length-F),b.lookahead-=b.match_length,b.match_length<=b.max_lazy_match&&b.lookahead>=F){for(b.match_length--;b.strstart++,b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+F-1])&b.hash_mask,B=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart,--b.match_length!=0;);b.strstart++}else b.strstart+=b.match_length,b.match_length=0,b.ins_h=b.window[b.strstart],b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+1])&b.hash_mask;else A=s._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++;if(A&&(w(b,!1),b.strm.avail_out===0))return C}return b.insert=b.strstart<F-1?b.strstart:F-1,W===d?(w(b,!0),b.strm.avail_out===0?fe:G):b.last_lit&&(w(b,!1),b.strm.avail_out===0)?C:z}function U(b,W){for(var B,A,E;;){if(b.lookahead<le){if(N(b),b.lookahead<le&&W===h)return C;if(b.lookahead===0)break}if(B=0,b.lookahead>=F&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+F-1])&b.hash_mask,B=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),b.prev_length=b.match_length,b.prev_match=b.match_start,b.match_length=F-1,B!==0&&b.prev_length<b.max_lazy_match&&b.strstart-B<=b.w_size-le&&(b.match_length=P(b,B),b.match_length<=5&&(b.strategy===1||b.match_length===F&&4096<b.strstart-b.match_start)&&(b.match_length=F-1)),b.prev_length>=F&&b.match_length<=b.prev_length){for(E=b.strstart+b.lookahead-F,A=s._tr_tally(b,b.strstart-1-b.prev_match,b.prev_length-F),b.lookahead-=b.prev_length-1,b.prev_length-=2;++b.strstart<=E&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+F-1])&b.hash_mask,B=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),--b.prev_length!=0;);if(b.match_available=0,b.match_length=F-1,b.strstart++,A&&(w(b,!1),b.strm.avail_out===0))return C}else if(b.match_available){if((A=s._tr_tally(b,0,b.window[b.strstart-1]))&&w(b,!1),b.strstart++,b.lookahead--,b.strm.avail_out===0)return C}else b.match_available=1,b.strstart++,b.lookahead--}return b.match_available&&(A=s._tr_tally(b,0,b.window[b.strstart-1]),b.match_available=0),b.insert=b.strstart<F-1?b.strstart:F-1,W===d?(w(b,!0),b.strm.avail_out===0?fe:G):b.last_lit&&(w(b,!1),b.strm.avail_out===0)?C:z}function X(b,W,B,A,E){this.good_length=b,this.max_lazy=W,this.nice_length=B,this.max_chain=A,this.func=E}function ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*H),this.dyn_dtree=new a.Buf16(2*(2*T+1)),this.bl_tree=new a.Buf16(2*(2*D+1)),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(V+1),this.heap=new a.Buf16(2*R+1),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*R+1),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(b){var W;return b&&b.state?(b.total_in=b.total_out=0,b.data_type=S,(W=b.state).pending=0,W.pending_out=0,W.wrap<0&&(W.wrap=-W.wrap),W.status=W.wrap?I:j,b.adler=W.wrap===2?0:1,W.last_flush=h,s._tr_init(W),f):ve(b,v)}function ge(b){var W=ie(b);return W===f&&function(B){B.window_size=2*B.w_size,g(B.head),B.max_lazy_match=o[B.level].max_lazy,B.good_match=o[B.level].good_length,B.nice_match=o[B.level].nice_length,B.max_chain_length=o[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=F-1,B.match_available=0,B.ins_h=0}(b.state),W}function be(b,W,B,A,E,$){if(!b)return v;var Y=1;if(W===y&&(W=6),A<0?(Y=0,A=-A):15<A&&(Y=2,A-=16),E<1||O<E||B!==_||A<8||15<A||W<0||9<W||$<0||m<$)return ve(b,v);A===8&&(A=9);var K=new ne;return(b.state=K).strm=b,K.wrap=Y,K.gzhead=null,K.w_bits=A,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=E+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+F-1)/F),K.window=new a.Buf8(2*K.w_size),K.head=new a.Buf16(K.hash_size),K.prev=new a.Buf16(K.w_size),K.lit_bufsize=1<<E+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new a.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=W,K.strategy=$,K.method=B,ge(b)}o=[new X(0,0,0,0,function(b,W){var B=65535;for(B>b.pending_buf_size-5&&(B=b.pending_buf_size-5);;){if(b.lookahead<=1){if(N(b),b.lookahead===0&&W===h)return C;if(b.lookahead===0)break}b.strstart+=b.lookahead,b.lookahead=0;var A=b.block_start+B;if((b.strstart===0||b.strstart>=A)&&(b.lookahead=b.strstart-A,b.strstart=A,w(b,!1),b.strm.avail_out===0)||b.strstart-b.block_start>=b.w_size-le&&(w(b,!1),b.strm.avail_out===0))return C}return b.insert=0,W===d?(w(b,!0),b.strm.avail_out===0?fe:G):(b.strstart>b.block_start&&(w(b,!1),b.strm.avail_out),C)}),new X(4,4,8,4,Z),new X(4,5,16,8,Z),new X(4,6,32,32,Z),new X(4,4,16,16,U),new X(8,16,32,32,U),new X(8,16,128,128,U),new X(8,32,128,256,U),new X(32,128,258,1024,U),new X(32,258,258,4096,U)],i.deflateInit=function(b,W){return be(b,W,_,15,8,0)},i.deflateInit2=be,i.deflateReset=ge,i.deflateResetKeep=ie,i.deflateSetHeader=function(b,W){return b&&b.state?b.state.wrap!==2?v:(b.state.gzhead=W,f):v},i.deflate=function(b,W){var B,A,E,$;if(!b||!b.state||5<W||W<0)return b?ve(b,v):v;if(A=b.state,!b.output||!b.input&&b.avail_in!==0||A.status===666&&W!==d)return ve(b,b.avail_out===0?-5:v);if(A.strm=b,B=A.last_flush,A.last_flush=W,A.status===I)if(A.wrap===2)b.adler=0,x(A,31),x(A,139),x(A,8),A.gzhead?(x(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),x(A,255&A.gzhead.time),x(A,A.gzhead.time>>8&255),x(A,A.gzhead.time>>16&255),x(A,A.gzhead.time>>24&255),x(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),x(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(x(A,255&A.gzhead.extra.length),x(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(b.adler=u(b.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(x(A,0),x(A,0),x(A,0),x(A,0),x(A,0),x(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),x(A,3),A.status=j);else{var Y=_+(A.w_bits-8<<4)<<8;Y|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(Y|=32),Y+=31-Y%31,A.status=j,k(A,Y),A.strstart!==0&&(k(A,b.adler>>>16),k(A,65535&b.adler)),b.adler=1}if(A.status===69)if(A.gzhead.extra){for(E=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),p(b),E=A.pending,A.pending!==A.pending_buf_size));)x(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),p(b),E=A.pending,A.pending===A.pending_buf_size)){$=1;break}$=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,x(A,$)}while($!==0);A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),$===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),p(b),E=A.pending,A.pending===A.pending_buf_size)){$=1;break}$=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,x(A,$)}while($!==0);A.gzhead.hcrc&&A.pending>E&&(b.adler=u(b.adler,A.pending_buf,A.pending-E,E)),$===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&p(b),A.pending+2<=A.pending_buf_size&&(x(A,255&b.adler),x(A,b.adler>>8&255),b.adler=0,A.status=j)):A.status=j),A.pending!==0){if(p(b),b.avail_out===0)return A.last_flush=-1,f}else if(b.avail_in===0&&Q(W)<=Q(B)&&W!==d)return ve(b,-5);if(A.status===666&&b.avail_in!==0)return ve(b,-5);if(b.avail_in!==0||A.lookahead!==0||W!==h&&A.status!==666){var K=A.strategy===2?function(L,J){for(var oe;;){if(L.lookahead===0&&(N(L),L.lookahead===0)){if(J===h)return C;break}if(L.match_length=0,oe=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,oe&&(w(L,!1),L.strm.avail_out===0))return C}return L.insert=0,J===d?(w(L,!0),L.strm.avail_out===0?fe:G):L.last_lit&&(w(L,!1),L.strm.avail_out===0)?C:z}(A,W):A.strategy===3?function(L,J){for(var oe,ee,de,Pe,Se=L.window;;){if(L.lookahead<=q){if(N(L),L.lookahead<=q&&J===h)return C;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=F&&0<L.strstart&&(ee=Se[de=L.strstart-1])===Se[++de]&&ee===Se[++de]&&ee===Se[++de]){Pe=L.strstart+q;do;while(ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&ee===Se[++de]&&de<Pe);L.match_length=q-(Pe-de),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=F?(oe=s._tr_tally(L,1,L.match_length-F),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(oe=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),oe&&(w(L,!1),L.strm.avail_out===0))return C}return L.insert=0,J===d?(w(L,!0),L.strm.avail_out===0?fe:G):L.last_lit&&(w(L,!1),L.strm.avail_out===0)?C:z}(A,W):o[A.level].func(A,W);if(K!==fe&&K!==G||(A.status=666),K===C||K===fe)return b.avail_out===0&&(A.last_flush=-1),f;if(K===z&&(W===1?s._tr_align(A):W!==5&&(s._tr_stored_block(A,0,0,!1),W===3&&(g(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),p(b),b.avail_out===0))return A.last_flush=-1,f}return W!==d?f:A.wrap<=0?1:(A.wrap===2?(x(A,255&b.adler),x(A,b.adler>>8&255),x(A,b.adler>>16&255),x(A,b.adler>>24&255),x(A,255&b.total_in),x(A,b.total_in>>8&255),x(A,b.total_in>>16&255),x(A,b.total_in>>24&255)):(k(A,b.adler>>>16),k(A,65535&b.adler)),p(b),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?f:1)},i.deflateEnd=function(b){var W;return b&&b.state?(W=b.state.status)!==I&&W!==69&&W!==73&&W!==91&&W!==103&&W!==j&&W!==666?ve(b,v):(b.state=null,W===j?ve(b,-3):f):v},i.deflateSetDictionary=function(b,W){var B,A,E,$,Y,K,L,J,oe=W.length;if(!b||!b.state||($=(B=b.state).wrap)===2||$===1&&B.status!==I||B.lookahead)return v;for($===1&&(b.adler=l(b.adler,W,oe,0)),B.wrap=0,oe>=B.w_size&&($===0&&(g(B.head),B.strstart=0,B.block_start=0,B.insert=0),J=new a.Buf8(B.w_size),a.arraySet(J,W,oe-B.w_size,B.w_size,0),W=J,oe=B.w_size),Y=b.avail_in,K=b.next_in,L=b.input,b.avail_in=oe,b.next_in=0,b.input=W,N(B);B.lookahead>=F;){for(A=B.strstart,E=B.lookahead-(F-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[A+F-1])&B.hash_mask,B.prev[A&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=A,A++,--E;);B.strstart=A,B.lookahead=F-1,N(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=F-1,B.match_available=0,b.next_in=K,b.input=L,b.avail_in=Y,B.wrap=$,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(o,a){var s,l,u,c,h,d,f,v,y,m,S,_,O,R,T,D,H,V,F,q,le,I,j,C,z;s=o.state,l=o.next_in,C=o.input,u=l+(o.avail_in-5),c=o.next_out,z=o.output,h=c-(a-o.avail_out),d=c+(o.avail_out-257),f=s.dmax,v=s.wsize,y=s.whave,m=s.wnext,S=s.window,_=s.hold,O=s.bits,R=s.lencode,T=s.distcode,D=(1<<s.lenbits)-1,H=(1<<s.distbits)-1;e:do{O<15&&(_+=C[l++]<<O,O+=8,_+=C[l++]<<O,O+=8),V=R[_&D];t:for(;;){if(_>>>=F=V>>>24,O-=F,(F=V>>>16&255)===0)z[c++]=65535&V;else{if(!(16&F)){if(!(64&F)){V=R[(65535&V)+(_&(1<<F)-1)];continue t}if(32&F){s.mode=12;break e}o.msg="invalid literal/length code",s.mode=30;break e}q=65535&V,(F&=15)&&(O<F&&(_+=C[l++]<<O,O+=8),q+=_&(1<<F)-1,_>>>=F,O-=F),O<15&&(_+=C[l++]<<O,O+=8,_+=C[l++]<<O,O+=8),V=T[_&H];r:for(;;){if(_>>>=F=V>>>24,O-=F,!(16&(F=V>>>16&255))){if(!(64&F)){V=T[(65535&V)+(_&(1<<F)-1)];continue r}o.msg="invalid distance code",s.mode=30;break e}if(le=65535&V,O<(F&=15)&&(_+=C[l++]<<O,(O+=8)<F&&(_+=C[l++]<<O,O+=8)),f<(le+=_&(1<<F)-1)){o.msg="invalid distance too far back",s.mode=30;break e}if(_>>>=F,O-=F,(F=c-h)<le){if(y<(F=le-F)&&s.sane){o.msg="invalid distance too far back",s.mode=30;break e}if(j=S,(I=0)===m){if(I+=v-F,F<q){for(q-=F;z[c++]=S[I++],--F;);I=c-le,j=z}}else if(m<F){if(I+=v+m-F,(F-=m)<q){for(q-=F;z[c++]=S[I++],--F;);if(I=0,m<q){for(q-=F=m;z[c++]=S[I++],--F;);I=c-le,j=z}}}else if(I+=m-F,F<q){for(q-=F;z[c++]=S[I++],--F;);I=c-le,j=z}for(;2<q;)z[c++]=j[I++],z[c++]=j[I++],z[c++]=j[I++],q-=3;q&&(z[c++]=j[I++],1<q&&(z[c++]=j[I++]))}else{for(I=c-le;z[c++]=z[I++],z[c++]=z[I++],z[c++]=z[I++],2<(q-=3););q&&(z[c++]=z[I++],1<q&&(z[c++]=z[I++]))}break}}break}}while(l<u&&c<d);l-=q=O>>3,_&=(1<<(O-=q<<3))-1,o.next_in=l,o.next_out=c,o.avail_in=l<u?u-l+5:5-(l-u),o.avail_out=c<d?d-c+257:257-(c-d),s.hold=_,s.bits=O}},{}],49:[function(r,n,i){var o=r("../utils/common"),a=r("./adler32"),s=r("./crc32"),l=r("./inffast"),u=r("./inftrees"),c=1,h=2,d=0,f=-2,v=1,y=852,m=592;function S(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function O(I){var j;return I&&I.state?(j=I.state,I.total_in=I.total_out=j.total=0,I.msg="",j.wrap&&(I.adler=1&j.wrap),j.mode=v,j.last=0,j.havedict=0,j.dmax=32768,j.head=null,j.hold=0,j.bits=0,j.lencode=j.lendyn=new o.Buf32(y),j.distcode=j.distdyn=new o.Buf32(m),j.sane=1,j.back=-1,d):f}function R(I){var j;return I&&I.state?((j=I.state).wsize=0,j.whave=0,j.wnext=0,O(I)):f}function T(I,j){var C,z;return I&&I.state?(z=I.state,j<0?(C=0,j=-j):(C=1+(j>>4),j<48&&(j&=15)),j&&(j<8||15<j)?f:(z.window!==null&&z.wbits!==j&&(z.window=null),z.wrap=C,z.wbits=j,R(I))):f}function D(I,j){var C,z;return I?(z=new _,(I.state=z).window=null,(C=T(I,j))!==d&&(I.state=null),C):f}var H,V,F=!0;function q(I){if(F){var j;for(H=new o.Buf32(512),V=new o.Buf32(32),j=0;j<144;)I.lens[j++]=8;for(;j<256;)I.lens[j++]=9;for(;j<280;)I.lens[j++]=7;for(;j<288;)I.lens[j++]=8;for(u(c,I.lens,0,288,H,0,I.work,{bits:9}),j=0;j<32;)I.lens[j++]=5;u(h,I.lens,0,32,V,0,I.work,{bits:5}),F=!1}I.lencode=H,I.lenbits=9,I.distcode=V,I.distbits=5}function le(I,j,C,z){var fe,G=I.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new o.Buf8(G.wsize)),z>=G.wsize?(o.arraySet(G.window,j,C-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(z<(fe=G.wsize-G.wnext)&&(fe=z),o.arraySet(G.window,j,C-z,fe,G.wnext),(z-=fe)?(o.arraySet(G.window,j,C-z,z,0),G.wnext=z,G.whave=G.wsize):(G.wnext+=fe,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=fe))),0}i.inflateReset=R,i.inflateReset2=T,i.inflateResetKeep=O,i.inflateInit=function(I){return D(I,15)},i.inflateInit2=D,i.inflate=function(I,j){var C,z,fe,G,ve,Q,g,p,w,x,k,P,N,Z,U,X,ne,ie,ge,be,b,W,B,A,E=0,$=new o.Buf8(4),Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return f;(C=I.state).mode===12&&(C.mode=13),ve=I.next_out,fe=I.output,g=I.avail_out,G=I.next_in,z=I.input,Q=I.avail_in,p=C.hold,w=C.bits,x=Q,k=g,W=d;e:for(;;)switch(C.mode){case v:if(C.wrap===0){C.mode=13;break}for(;w<16;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(2&C.wrap&&p===35615){$[C.check=0]=255&p,$[1]=p>>>8&255,C.check=s(C.check,$,2,0),w=p=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&p)<<8)+(p>>8))%31){I.msg="incorrect header check",C.mode=30;break}if((15&p)!=8){I.msg="unknown compression method",C.mode=30;break}if(w-=4,b=8+(15&(p>>>=4)),C.wbits===0)C.wbits=b;else if(b>C.wbits){I.msg="invalid window size",C.mode=30;break}C.dmax=1<<b,I.adler=C.check=1,C.mode=512&p?10:12,w=p=0;break;case 2:for(;w<16;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(C.flags=p,(255&C.flags)!=8){I.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){I.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=p>>8&1),512&C.flags&&($[0]=255&p,$[1]=p>>>8&255,C.check=s(C.check,$,2,0)),w=p=0,C.mode=3;case 3:for(;w<32;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.head&&(C.head.time=p),512&C.flags&&($[0]=255&p,$[1]=p>>>8&255,$[2]=p>>>16&255,$[3]=p>>>24&255,C.check=s(C.check,$,4,0)),w=p=0,C.mode=4;case 4:for(;w<16;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.head&&(C.head.xflags=255&p,C.head.os=p>>8),512&C.flags&&($[0]=255&p,$[1]=p>>>8&255,C.check=s(C.check,$,2,0)),w=p=0,C.mode=5;case 5:if(1024&C.flags){for(;w<16;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.length=p,C.head&&(C.head.extra_len=p),512&C.flags&&($[0]=255&p,$[1]=p>>>8&255,C.check=s(C.check,$,2,0)),w=p=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(Q<(P=C.length)&&(P=Q),P&&(C.head&&(b=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),o.arraySet(C.head.extra,z,G,P,b)),512&C.flags&&(C.check=s(C.check,z,P,G)),Q-=P,G+=P,C.length-=P),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(Q===0)break e;for(P=0;b=z[G+P++],C.head&&b&&C.length<65536&&(C.head.name+=String.fromCharCode(b)),b&&P<Q;);if(512&C.flags&&(C.check=s(C.check,z,P,G)),Q-=P,G+=P,b)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(Q===0)break e;for(P=0;b=z[G+P++],C.head&&b&&C.length<65536&&(C.head.comment+=String.fromCharCode(b)),b&&P<Q;);if(512&C.flags&&(C.check=s(C.check,z,P,G)),Q-=P,G+=P,b)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;w<16;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(p!==(65535&C.check)){I.msg="header crc mismatch",C.mode=30;break}w=p=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),I.adler=C.check=0,C.mode=12;break;case 10:for(;w<32;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}I.adler=C.check=S(p),w=p=0,C.mode=11;case 11:if(C.havedict===0)return I.next_out=ve,I.avail_out=g,I.next_in=G,I.avail_in=Q,C.hold=p,C.bits=w,2;I.adler=C.check=1,C.mode=12;case 12:if(j===5||j===6)break e;case 13:if(C.last){p>>>=7&w,w-=7&w,C.mode=27;break}for(;w<3;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}switch(C.last=1&p,w-=1,3&(p>>>=1)){case 0:C.mode=14;break;case 1:if(q(C),C.mode=20,j!==6)break;p>>>=2,w-=2;break e;case 2:C.mode=17;break;case 3:I.msg="invalid block type",C.mode=30}p>>>=2,w-=2;break;case 14:for(p>>>=7&w,w-=7&w;w<32;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if((65535&p)!=(p>>>16^65535)){I.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&p,w=p=0,C.mode=15,j===6)break e;case 15:C.mode=16;case 16:if(P=C.length){if(Q<P&&(P=Q),g<P&&(P=g),P===0)break e;o.arraySet(fe,z,G,P,ve),Q-=P,G+=P,g-=P,ve+=P,C.length-=P;break}C.mode=12;break;case 17:for(;w<14;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(C.nlen=257+(31&p),p>>>=5,w-=5,C.ndist=1+(31&p),p>>>=5,w-=5,C.ncode=4+(15&p),p>>>=4,w-=4,286<C.nlen||30<C.ndist){I.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;w<3;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.lens[Y[C.have++]]=7&p,p>>>=3,w-=3}for(;C.have<19;)C.lens[Y[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,B={bits:C.lenbits},W=u(0,C.lens,0,19,C.lencode,0,C.work,B),C.lenbits=B.bits,W){I.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;X=(E=C.lencode[p&(1<<C.lenbits)-1])>>>16&255,ne=65535&E,!((U=E>>>24)<=w);){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(ne<16)p>>>=U,w-=U,C.lens[C.have++]=ne;else{if(ne===16){for(A=U+2;w<A;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(p>>>=U,w-=U,C.have===0){I.msg="invalid bit length repeat",C.mode=30;break}b=C.lens[C.have-1],P=3+(3&p),p>>>=2,w-=2}else if(ne===17){for(A=U+3;w<A;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}w-=U,b=0,P=3+(7&(p>>>=U)),p>>>=3,w-=3}else{for(A=U+7;w<A;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}w-=U,b=0,P=11+(127&(p>>>=U)),p>>>=7,w-=7}if(C.have+P>C.nlen+C.ndist){I.msg="invalid bit length repeat",C.mode=30;break}for(;P--;)C.lens[C.have++]=b}}if(C.mode===30)break;if(C.lens[256]===0){I.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,B={bits:C.lenbits},W=u(c,C.lens,0,C.nlen,C.lencode,0,C.work,B),C.lenbits=B.bits,W){I.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,B={bits:C.distbits},W=u(h,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,B),C.distbits=B.bits,W){I.msg="invalid distances set",C.mode=30;break}if(C.mode=20,j===6)break e;case 20:C.mode=21;case 21:if(6<=Q&&258<=g){I.next_out=ve,I.avail_out=g,I.next_in=G,I.avail_in=Q,C.hold=p,C.bits=w,l(I,k),ve=I.next_out,fe=I.output,g=I.avail_out,G=I.next_in,z=I.input,Q=I.avail_in,p=C.hold,w=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;X=(E=C.lencode[p&(1<<C.lenbits)-1])>>>16&255,ne=65535&E,!((U=E>>>24)<=w);){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(X&&!(240&X)){for(ie=U,ge=X,be=ne;X=(E=C.lencode[be+((p&(1<<ie+ge)-1)>>ie)])>>>16&255,ne=65535&E,!(ie+(U=E>>>24)<=w);){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}p>>>=ie,w-=ie,C.back+=ie}if(p>>>=U,w-=U,C.back+=U,C.length=ne,X===0){C.mode=26;break}if(32&X){C.back=-1,C.mode=12;break}if(64&X){I.msg="invalid literal/length code",C.mode=30;break}C.extra=15&X,C.mode=22;case 22:if(C.extra){for(A=C.extra;w<A;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.length+=p&(1<<C.extra)-1,p>>>=C.extra,w-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;X=(E=C.distcode[p&(1<<C.distbits)-1])>>>16&255,ne=65535&E,!((U=E>>>24)<=w);){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(!(240&X)){for(ie=U,ge=X,be=ne;X=(E=C.distcode[be+((p&(1<<ie+ge)-1)>>ie)])>>>16&255,ne=65535&E,!(ie+(U=E>>>24)<=w);){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}p>>>=ie,w-=ie,C.back+=ie}if(p>>>=U,w-=U,C.back+=U,64&X){I.msg="invalid distance code",C.mode=30;break}C.offset=ne,C.extra=15&X,C.mode=24;case 24:if(C.extra){for(A=C.extra;w<A;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}C.offset+=p&(1<<C.extra)-1,p>>>=C.extra,w-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){I.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(g===0)break e;if(P=k-g,C.offset>P){if((P=C.offset-P)>C.whave&&C.sane){I.msg="invalid distance too far back",C.mode=30;break}N=P>C.wnext?(P-=C.wnext,C.wsize-P):C.wnext-P,P>C.length&&(P=C.length),Z=C.window}else Z=fe,N=ve-C.offset,P=C.length;for(g<P&&(P=g),g-=P,C.length-=P;fe[ve++]=Z[N++],--P;);C.length===0&&(C.mode=21);break;case 26:if(g===0)break e;fe[ve++]=C.length,g--,C.mode=21;break;case 27:if(C.wrap){for(;w<32;){if(Q===0)break e;Q--,p|=z[G++]<<w,w+=8}if(k-=g,I.total_out+=k,C.total+=k,k&&(I.adler=C.check=C.flags?s(C.check,fe,k,ve-k):a(C.check,fe,k,ve-k)),k=g,(C.flags?p:S(p))!==C.check){I.msg="incorrect data check",C.mode=30;break}w=p=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;w<32;){if(Q===0)break e;Q--,p+=z[G++]<<w,w+=8}if(p!==(4294967295&C.total)){I.msg="incorrect length check",C.mode=30;break}w=p=0}C.mode=29;case 29:W=1;break e;case 30:W=-3;break e;case 31:return-4;case 32:default:return f}return I.next_out=ve,I.avail_out=g,I.next_in=G,I.avail_in=Q,C.hold=p,C.bits=w,(C.wsize||k!==I.avail_out&&C.mode<30&&(C.mode<27||j!==4))&&le(I,I.output,I.next_out,k-I.avail_out)?(C.mode=31,-4):(x-=I.avail_in,k-=I.avail_out,I.total_in+=x,I.total_out+=k,C.total+=k,C.wrap&&k&&(I.adler=C.check=C.flags?s(C.check,fe,k,I.next_out-k):a(C.check,fe,k,I.next_out-k)),I.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(x==0&&k===0||j===4)&&W===d&&(W=-5),W)},i.inflateEnd=function(I){if(!I||!I.state)return f;var j=I.state;return j.window&&(j.window=null),I.state=null,d},i.inflateGetHeader=function(I,j){var C;return I&&I.state&&2&(C=I.state).wrap?((C.head=j).done=!1,d):f},i.inflateSetDictionary=function(I,j){var C,z=j.length;return I&&I.state?(C=I.state).wrap!==0&&C.mode!==11?f:C.mode===11&&a(1,j,z,0)!==C.check?-3:le(I,j,z,z)?(C.mode=31,-4):(C.havedict=1,d):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var o=r("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,h,d,f,v,y,m,S){var _,O,R,T,D,H,V,F,q,le=S.bits,I=0,j=0,C=0,z=0,fe=0,G=0,ve=0,Q=0,g=0,p=0,w=null,x=0,k=new o.Buf16(16),P=new o.Buf16(16),N=null,Z=0;for(I=0;I<=15;I++)k[I]=0;for(j=0;j<f;j++)k[h[d+j]]++;for(fe=le,z=15;1<=z&&k[z]===0;z--);if(z<fe&&(fe=z),z===0)return v[y++]=20971520,v[y++]=20971520,S.bits=1,0;for(C=1;C<z&&k[C]===0;C++);for(fe<C&&(fe=C),I=Q=1;I<=15;I++)if(Q<<=1,(Q-=k[I])<0)return-1;if(0<Q&&(c===0||z!==1))return-1;for(P[1]=0,I=1;I<15;I++)P[I+1]=P[I]+k[I];for(j=0;j<f;j++)h[d+j]!==0&&(m[P[h[d+j]]++]=j);if(H=c===0?(w=N=m,19):c===1?(w=a,x-=257,N=s,Z-=257,256):(w=l,N=u,-1),I=C,D=y,ve=j=p=0,R=-1,T=(g=1<<(G=fe))-1,c===1&&852<g||c===2&&592<g)return 1;for(;;){for(V=I-ve,q=m[j]<H?(F=0,m[j]):m[j]>H?(F=N[Z+m[j]],w[x+m[j]]):(F=96,0),_=1<<I-ve,C=O=1<<G;v[D+(p>>ve)+(O-=_)]=V<<24|F<<16|q|0,O!==0;);for(_=1<<I-1;p&_;)_>>=1;if(_!==0?(p&=_-1,p+=_):p=0,j++,--k[I]==0){if(I===z)break;I=h[d+m[j]]}if(fe<I&&(p&T)!==R){for(ve===0&&(ve=fe),D+=C,Q=1<<(G=I-ve);G+ve<z&&!((Q-=k[G+ve])<=0);)G++,Q<<=1;if(g+=1<<G,c===1&&852<g||c===2&&592<g)return 1;v[R=p&T]=fe<<24|G<<16|D-y|0}}return p!==0&&(v[D+p]=I-ve<<24|64<<16|0),S.bits=fe,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var o=r("../utils/common"),a=0,s=1;function l(E){for(var $=E.length;0<=--$;)E[$]=0}var u=0,c=29,h=256,d=h+1+c,f=30,v=19,y=2*d+1,m=15,S=16,_=7,O=256,R=16,T=17,D=18,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=new Array(2*(d+2));l(le);var I=new Array(2*f);l(I);var j=new Array(512);l(j);var C=new Array(256);l(C);var z=new Array(c);l(z);var fe,G,ve,Q=new Array(f);function g(E,$,Y,K,L){this.static_tree=E,this.extra_bits=$,this.extra_base=Y,this.elems=K,this.max_length=L,this.has_stree=E&&E.length}function p(E,$){this.dyn_tree=E,this.max_code=0,this.stat_desc=$}function w(E){return E<256?j[E]:j[256+(E>>>7)]}function x(E,$){E.pending_buf[E.pending++]=255&$,E.pending_buf[E.pending++]=$>>>8&255}function k(E,$,Y){E.bi_valid>S-Y?(E.bi_buf|=$<<E.bi_valid&65535,x(E,E.bi_buf),E.bi_buf=$>>S-E.bi_valid,E.bi_valid+=Y-S):(E.bi_buf|=$<<E.bi_valid&65535,E.bi_valid+=Y)}function P(E,$,Y){k(E,Y[2*$],Y[2*$+1])}function N(E,$){for(var Y=0;Y|=1&E,E>>>=1,Y<<=1,0<--$;);return Y>>>1}function Z(E,$,Y){var K,L,J=new Array(m+1),oe=0;for(K=1;K<=m;K++)J[K]=oe=oe+Y[K-1]<<1;for(L=0;L<=$;L++){var ee=E[2*L+1];ee!==0&&(E[2*L]=N(J[ee]++,ee))}}function U(E){var $;for($=0;$<d;$++)E.dyn_ltree[2*$]=0;for($=0;$<f;$++)E.dyn_dtree[2*$]=0;for($=0;$<v;$++)E.bl_tree[2*$]=0;E.dyn_ltree[2*O]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function X(E){8<E.bi_valid?x(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function ne(E,$,Y,K){var L=2*$,J=2*Y;return E[L]<E[J]||E[L]===E[J]&&K[$]<=K[Y]}function ie(E,$,Y){for(var K=E.heap[Y],L=Y<<1;L<=E.heap_len&&(L<E.heap_len&&ne($,E.heap[L+1],E.heap[L],E.depth)&&L++,!ne($,K,E.heap[L],E.depth));)E.heap[Y]=E.heap[L],Y=L,L<<=1;E.heap[Y]=K}function ge(E,$,Y){var K,L,J,oe,ee=0;if(E.last_lit!==0)for(;K=E.pending_buf[E.d_buf+2*ee]<<8|E.pending_buf[E.d_buf+2*ee+1],L=E.pending_buf[E.l_buf+ee],ee++,K===0?P(E,L,$):(P(E,(J=C[L])+h+1,$),(oe=H[J])!==0&&k(E,L-=z[J],oe),P(E,J=w(--K),Y),(oe=V[J])!==0&&k(E,K-=Q[J],oe)),ee<E.last_lit;);P(E,O,$)}function be(E,$){var Y,K,L,J=$.dyn_tree,oe=$.stat_desc.static_tree,ee=$.stat_desc.has_stree,de=$.stat_desc.elems,Pe=-1;for(E.heap_len=0,E.heap_max=y,Y=0;Y<de;Y++)J[2*Y]!==0?(E.heap[++E.heap_len]=Pe=Y,E.depth[Y]=0):J[2*Y+1]=0;for(;E.heap_len<2;)J[2*(L=E.heap[++E.heap_len]=Pe<2?++Pe:0)]=1,E.depth[L]=0,E.opt_len--,ee&&(E.static_len-=oe[2*L+1]);for($.max_code=Pe,Y=E.heap_len>>1;1<=Y;Y--)ie(E,J,Y);for(L=de;Y=E.heap[1],E.heap[1]=E.heap[E.heap_len--],ie(E,J,1),K=E.heap[1],E.heap[--E.heap_max]=Y,E.heap[--E.heap_max]=K,J[2*L]=J[2*Y]+J[2*K],E.depth[L]=(E.depth[Y]>=E.depth[K]?E.depth[Y]:E.depth[K])+1,J[2*Y+1]=J[2*K+1]=L,E.heap[1]=L++,ie(E,J,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(Se,Ke){var wt,dt,Dt,De,st,Et,lt=Ke.dyn_tree,Or=Ke.max_code,at=Ke.stat_desc.static_tree,He=Ke.stat_desc.has_stree,ur=Ke.stat_desc.extra_bits,ut=Ke.stat_desc.extra_base,_e=Ke.stat_desc.max_length,Be=0;for(De=0;De<=m;De++)Se.bl_count[De]=0;for(lt[2*Se.heap[Se.heap_max]+1]=0,wt=Se.heap_max+1;wt<y;wt++)_e<(De=lt[2*lt[2*(dt=Se.heap[wt])+1]+1]+1)&&(De=_e,Be++),lt[2*dt+1]=De,Or<dt||(Se.bl_count[De]++,st=0,ut<=dt&&(st=ur[dt-ut]),Et=lt[2*dt],Se.opt_len+=Et*(De+st),He&&(Se.static_len+=Et*(at[2*dt+1]+st)));if(Be!==0){do{for(De=_e-1;Se.bl_count[De]===0;)De--;Se.bl_count[De]--,Se.bl_count[De+1]+=2,Se.bl_count[_e]--,Be-=2}while(0<Be);for(De=_e;De!==0;De--)for(dt=Se.bl_count[De];dt!==0;)Or<(Dt=Se.heap[--wt])||(lt[2*Dt+1]!==De&&(Se.opt_len+=(De-lt[2*Dt+1])*lt[2*Dt],lt[2*Dt+1]=De),dt--)}}(E,$),Z(J,Pe,E.bl_count)}function b(E,$,Y){var K,L,J=-1,oe=$[1],ee=0,de=7,Pe=4;for(oe===0&&(de=138,Pe=3),$[2*(Y+1)+1]=65535,K=0;K<=Y;K++)L=oe,oe=$[2*(K+1)+1],++ee<de&&L===oe||(ee<Pe?E.bl_tree[2*L]+=ee:L!==0?(L!==J&&E.bl_tree[2*L]++,E.bl_tree[2*R]++):ee<=10?E.bl_tree[2*T]++:E.bl_tree[2*D]++,J=L,Pe=(ee=0)===oe?(de=138,3):L===oe?(de=6,3):(de=7,4))}function W(E,$,Y){var K,L,J=-1,oe=$[1],ee=0,de=7,Pe=4;for(oe===0&&(de=138,Pe=3),K=0;K<=Y;K++)if(L=oe,oe=$[2*(K+1)+1],!(++ee<de&&L===oe)){if(ee<Pe)for(;P(E,L,E.bl_tree),--ee!=0;);else L!==0?(L!==J&&(P(E,L,E.bl_tree),ee--),P(E,R,E.bl_tree),k(E,ee-3,2)):ee<=10?(P(E,T,E.bl_tree),k(E,ee-3,3)):(P(E,D,E.bl_tree),k(E,ee-11,7));J=L,Pe=(ee=0)===oe?(de=138,3):L===oe?(de=6,3):(de=7,4)}}l(Q);var B=!1;function A(E,$,Y,K){k(E,(u<<1)+(K?1:0),3),function(L,J,oe,ee){X(L),ee&&(x(L,oe),x(L,~oe)),o.arraySet(L.pending_buf,L.window,J,oe,L.pending),L.pending+=oe}(E,$,Y,!0)}i._tr_init=function(E){B||(function(){var $,Y,K,L,J,oe=new Array(m+1);for(L=K=0;L<c-1;L++)for(z[L]=K,$=0;$<1<<H[L];$++)C[K++]=L;for(C[K-1]=L,L=J=0;L<16;L++)for(Q[L]=J,$=0;$<1<<V[L];$++)j[J++]=L;for(J>>=7;L<f;L++)for(Q[L]=J<<7,$=0;$<1<<V[L]-7;$++)j[256+J++]=L;for(Y=0;Y<=m;Y++)oe[Y]=0;for($=0;$<=143;)le[2*$+1]=8,$++,oe[8]++;for(;$<=255;)le[2*$+1]=9,$++,oe[9]++;for(;$<=279;)le[2*$+1]=7,$++,oe[7]++;for(;$<=287;)le[2*$+1]=8,$++,oe[8]++;for(Z(le,d+1,oe),$=0;$<f;$++)I[2*$+1]=5,I[2*$]=N($,5);fe=new g(le,H,h+1,d,m),G=new g(I,V,0,f,m),ve=new g(new Array(0),F,0,v,_)}(),B=!0),E.l_desc=new p(E.dyn_ltree,fe),E.d_desc=new p(E.dyn_dtree,G),E.bl_desc=new p(E.bl_tree,ve),E.bi_buf=0,E.bi_valid=0,U(E)},i._tr_stored_block=A,i._tr_flush_block=function(E,$,Y,K){var L,J,oe=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(ee){var de,Pe=4093624447;for(de=0;de<=31;de++,Pe>>>=1)if(1&Pe&&ee.dyn_ltree[2*de]!==0)return a;if(ee.dyn_ltree[18]!==0||ee.dyn_ltree[20]!==0||ee.dyn_ltree[26]!==0)return s;for(de=32;de<h;de++)if(ee.dyn_ltree[2*de]!==0)return s;return a}(E)),be(E,E.l_desc),be(E,E.d_desc),oe=function(ee){var de;for(b(ee,ee.dyn_ltree,ee.l_desc.max_code),b(ee,ee.dyn_dtree,ee.d_desc.max_code),be(ee,ee.bl_desc),de=v-1;3<=de&&ee.bl_tree[2*q[de]+1]===0;de--);return ee.opt_len+=3*(de+1)+5+5+4,de}(E),L=E.opt_len+3+7>>>3,(J=E.static_len+3+7>>>3)<=L&&(L=J)):L=J=Y+5,Y+4<=L&&$!==-1?A(E,$,Y,K):E.strategy===4||J===L?(k(E,2+(K?1:0),3),ge(E,le,I)):(k(E,4+(K?1:0),3),function(ee,de,Pe,Se){var Ke;for(k(ee,de-257,5),k(ee,Pe-1,5),k(ee,Se-4,4),Ke=0;Ke<Se;Ke++)k(ee,ee.bl_tree[2*q[Ke]+1],3);W(ee,ee.dyn_ltree,de-1),W(ee,ee.dyn_dtree,Pe-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,oe+1),ge(E,E.dyn_ltree,E.dyn_dtree)),U(E),K&&X(E)},i._tr_tally=function(E,$,Y){return E.pending_buf[E.d_buf+2*E.last_lit]=$>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&$,E.pending_buf[E.l_buf+E.last_lit]=255&Y,E.last_lit++,$===0?E.dyn_ltree[2*Y]++:(E.matches++,$--,E.dyn_ltree[2*(C[Y]+h+1)]++,E.dyn_dtree[2*w($)]++),E.last_lit===E.lit_bufsize-1},i._tr_align=function(E){k(E,2,3),P(E,O,le),function($){$.bi_valid===16?(x($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):8<=$.bi_valid&&($.pending_buf[$.pending++]=255&$.bi_buf,$.bi_buf>>=8,$.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){n.exports=typeof setImmediate=="function"?setImmediate:function(){var o=[].slice.apply(arguments);o.splice(1,0,0),setTimeout.apply(null,o)}},{}]},{},[10])(10)})})(xA);var ice=xA.exports;const oce=Ag(ice);var ag={exports:{}},sg={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParsingError=void 0;class r extends Error{constructor(R,T){super(R),this.cause=T}}t.ParsingError=r;let n;function i(){return l(!1)||d()||h()||c()}function o(){return y(/\s*/),l(!0)||h()||u()||s(!1)}function a(){const O=s(!0),R=[];let T,D=o();for(;D;){if(D.node.type==="Element"){if(T)throw new Error("Found multiple root nodes");T=D.node}D.excluded||R.push(D.node),D=o()}if(!T)throw new r("Failed to parse XML","Root Element not found");if(n.xml.length!==0)throw new r("Failed to parse XML","Not Well-Formed XML");return{declaration:O?O.node:null,root:T,children:R}}function s(O){const R=y(O?/^<\?(xml)\s*/:/^<\?([\w-:.]+)\s*/);if(!R)return;const T={name:R[1],type:"ProcessingInstruction",attributes:{}};for(;!(m()||S("?>"));){const D=f();if(D)T.attributes[D.name]=D.value;else return}return y(/\?>/),{excluded:O?!1:n.options.filter(T)===!1,node:T}}function l(O){const R=y(/^<([\w-:.\u00C0-\u00FF]+)\s*/);if(!R)return;const T={type:"Element",name:R[1],attributes:{},children:[]},D=O?!1:n.options.filter(T)===!1;for(;!(m()||S(">")||S("?>")||S("/>"));){const V=f();if(V)T.attributes[V.name]=V.value;else return}if(y(/^\s*\/>/))return T.children=null,{excluded:D,node:T};y(/\??>/);let H=i();for(;H;)H.excluded||T.children.push(H.node),H=i();return y(/^<\/\s*[\w-:.\u00C0-\u00FF]+>/),{excluded:D,node:T}}function u(){const O=y(/^<!DOCTYPE\s+[^>]*>/);if(O){const R={type:"DocumentType",content:O[0]};return{excluded:n.options.filter(R)===!1,node:R}}}function c(){if(n.xml.startsWith("<![CDATA[")){const O=n.xml.indexOf("]]>");if(O>-1){const R=O+3,T={type:"CDATA",content:n.xml.substring(0,R)};return n.xml=n.xml.slice(R),{excluded:n.options.filter(T)===!1,node:T}}}}function h(){const O=y(/^<!--[\s\S]*?-->/);if(O){const R={type:"Comment",content:O[0]};return{excluded:n.options.filter(R)===!1,node:R}}}function d(){const O=y(/^([^<]+)/);if(O){const R={type:"Text",content:O[1]};return{excluded:n.options.filter(R)===!1,node:R}}}function f(){const O=y(/([\w-:.\u00C0-\u00FF]+)\s*=\s*("[^"]*"|'[^']*'|[\w\u00C0-\u00FF]+)\s*/);if(O)return{name:O[1],value:v(O[2])}}function v(O){return O.replace(/^['"]|['"]$/g,"")}function y(O){const R=n.xml.match(O);if(R)return n.xml=n.xml.slice(R[0].length),R}function m(){return n.xml.length===0}function S(O){return n.xml.indexOf(O)===0}function _(O,R={}){O=O.trim();const T=R.filter||(()=>!0);return n={xml:O,options:Object.assign(Object.assign({},R),{filter:T})},a()}e.exports=_,t.default=_})(sg,sg.exports);var ace=sg.exports;(function(e,t){var r=jn&&jn.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(ace);function i(d){if(!d.options.indentation&&!d.options.lineSeparator)return;d.content+=d.options.lineSeparator;let f;for(f=0;f<d.level;f++)d.content+=d.options.indentation}function o(d,f){d.content+=f}function a(d,f,v){if(typeof d.content=="string")s(d.content,f,v);else if(d.type==="Element")l(d,f,v);else if(d.type==="ProcessingInstruction")c(d,f);else throw new Error("Unknown node type: "+d.type)}function s(d,f,v){v||(d=d.trim()),d.length>0&&(!v&&f.content.length>0&&i(f),o(f,d))}function l(d,f,v){if(!v&&f.content.length>0&&i(f),o(f,"<"+d.name),u(f,d.attributes),d.children===null){const y=f.options.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";o(f,y)}else if(d.children.length===0)o(f,"></"+d.name+">");else{const y=d.children;o(f,">"),f.level++;let m=d.attributes["xml:space"]==="preserve";if(!m&&f.options.collapseContent){let S=!1,_=!1,O=!1;y.forEach(function(R,T){R.type==="Text"?(R.content.includes(`
`)?(_=!0,R.content=R.content.trim()):(T===0||T===y.length-1)&&R.content.trim().length===0&&(R.content=""),R.content.length>0&&(S=!0)):R.type==="CDATA"?S=!0:O=!0}),S&&(!O||!_)&&(m=!0)}y.forEach(function(S){a(S,f,v||m)}),f.level--,!v&&!m&&i(f),o(f,"</"+d.name+">")}}function u(d,f){Object.keys(f).forEach(function(v){const y=f[v].replace(/"/g,"&quot;");o(d," "+v+'="'+y+'"')})}function c(d,f){f.content.length>0&&i(f),o(f,"<?"+d.name),u(f,d.attributes),o(f,"?>")}function h(d,f={}){f.indentation="indentation"in f?f.indentation:"    ",f.collapseContent=f.collapseContent===!0,f.lineSeparator="lineSeparator"in f?f.lineSeparator:`\r
`,f.whiteSpaceAtEndOfSelfclosingTag=f.whiteSpaceAtEndOfSelfclosingTag===!0,f.throwOnFailure=f.throwOnFailure!==!1;try{const v=(0,n.default)(d,{filter:f.filter}),y={content:"",level:0,options:f};return v.declaration&&c(v.declaration,y),v.children.forEach(function(m){a(m,y,!1)}),y.content.replace(/\r\n/g,`
`).replace(/\n/g,f.lineSeparator)}catch(v){if(f.throwOnFailure)throw v;return d}}e.exports=h,t.default=h})(ag,ag.exports);var sce=ag.exports;const IA=Ag(sce);async function PA(e,t,r){r??(r=bg());const n=await Fn(`https://amp-api.music.apple.com/v1/catalog/${r}/songs/${e}/${t?"syllable-lyrics":"lyrics"}`,{headers:{Origin:"https://music.apple.com",Referer:"https://music.apple.com/",Authorization:`Bearer ${await Zl()}`}});return n.status===404?null:(await n.json()).data[0]}function $A(e){return e.trim().replace(/[\/\?<>\\:\*\|":]/g,"_").replace(/\.+$/,"_")}async function lce(e){const t=wg();if(!t){alert("Lyrics can only be ripped when you have an active subscription in the specific storefront.");return}const r=await da(e,t);if(!r)return;const n=new oce;for(const o of r.relationships.tracks.data){if(o.attributes.hasTimeSyncedLyrics){const a=await PA(o.id,!0,t);a&&MA(n,o.attributes,a.attributes,!0)}if(o.attributes.hasLyrics){const a=await PA(o.id,!1,t);a&&MA(n,o.attributes,a.attributes,!1)}await ha(100)}if(Object.keys(n.files).length===0){alert("No lyrics found.");return}const i=await n.generateAsync({type:"blob"});ax(i,$A(`Lyrics {${r.attributes.upc||r.id}}.zip`))}function MA(e,t,r,n){const i=$A(`${t.discNumber}-${t.trackNumber.toString().padStart(2,"0")}. ${t.name.slice(0,120)}`);if(n&&r.ttml.includes("<span begin=")?e.file(`${i}.syllable.ttml`,IA(r.ttml,{lineSeparator:`
`,indentation:"	"})):e.file(`${i}.ttml`,IA(r.ttml,{lineSeparator:`
`,indentation:"	"})),!n){const o=new DOMParser().parseFromString(r.ttml,"text/xml");let a="";for(const s of Array.from(o.querySelectorAll("p"))){const l=s.getAttribute("begin");l?a+=`[${uce(l)}] ${s.textContent}
`:a+=`${s.textContent}
`}e.file(`${i}.lrc`,a+`
`)}}function uce(e){const t=e.split(/[:.]/g).reverse(),r=(t[2]??"").padStart(2,"0"),n=(t[1]??"").padStart(2,"0"),i=Math.floor(Number(t[0])/10).toString().padStart(2,"0");return`${r}:${n}.${i}`}Mc(lle),Mc(rce),Mc(iue),Mc(yue);const NA={id:"ID",discNumber:"Disc #",trackNumber:"Track #",duration:"Duration",isrc:"ISRC",upc:"UPC",albumDate:"Album Date",trackDate:"Track Date",locale:"Locale",lyrics:"Lyrics",genres:"Genres",composer:"Composer",artist:"Artist",title:"Title",label:"Label",copyright:"Copyright",albumArtist:"Album Artist",albumTitle:"Album Title"},cce=Object.fromEntries(Object.entries(NA).map(e=>e.reverse())),DA=["id","discNumber","trackNumber","duration","isrc","upc","albumDate","trackDate","locale","lyrics","genres","composer","artist","title","label","copyright","albumArtist","albumTitle"],lg=ki("Show Info",nce);lg.addEventListener("click",fce);let ug=!1,lr=null;Ln(async()=>{Ai(lg,300),cg()}),fa(()=>{va(lg),cg()});async function fce(){var v;if(ug)return;ug=!0;const e=location.pathname.split("/")[4];let t=null,r=localStorage.getItem("ame-info-storefront")||location.pathname.split("/")[1];const n=await Sg();lr=Qt(`
		<div id="ame-dock">
			<div id="ame-dock-title">Album Info</div>
			<div id="ame-dock-control">
				<select id="ame-dock-control-storefront">
					${n.map(y=>`<option value="${y.id}"${y.id===r?" selected":""}>${y.attributes.name}</option>`).join("")}
				</select>
				<button id="ame-dock-control-isrc2mb">ISRC2MB</button>
				<button id="ame-dock-control-lyrics">LYRICS (${((v=wg())==null?void 0:v.toUpperCase())||"N/A"})</button>
			</div>
			<div id="ame-dock-table"></div>
		</div>
	`);const i=lr.querySelector("#ame-dock-title"),o=lr.querySelector("#ame-dock-control-storefront"),a=lr.querySelector("#ame-dock-control-isrc2mb"),s=lr.querySelector("#ame-dock-control-lyrics"),l=lr.querySelector("#ame-dock-table");i.addEventListener("click",()=>{cg()}),a.addEventListener("click",async()=>{if(!t)return;const y=t.attributes.upc.replace(/^0+/,""),S=await(await Fn(`https://musicbrainz.org/ws/2/release/?fmt=json&query=barcode:${y}%20AND%20format:digitalmedia`)).json(),_=new URLSearchParams;S.releases.length&&_.set("mbid",S.releases[0].id),t.relationships.tracks.data.forEach((O,R)=>{_.set(`isrc${R+1}`,O.attributes.isrc)}),open(`https://magicisrc.kepstin.ca/?${_.toString()}`,"_blank")});let u=!1;s.addEventListener("click",async()=>{if(!u){u=!0;try{await lce(e)}catch(y){console.error(y)}u=!1}});let c=JSON.parse(localStorage.getItem("ame-info-columns")||"[]");c.length!==DA.length&&(c=DA),document.body.appendChild(lr);const h=new Cr(l,{licenseKey:"non-commercial-and-evaluation",data:[],rowHeaders:!0,columns:c.map(y=>({data:y,title:NA[y]})),editor:!1,manualColumnMove:!0,height:Math.max(320,Math.floor(innerHeight/3)),stretchH:"all",wordWrap:!1,renderer(y,m,S,_,O,R,T){const D=y.getSourceDataAtRow(S);switch(S%2&&m.classList.add("ame-table-band"),c[_]){case"trackDate":D.albumDate!==D.trackDate&&(m.style.textDecoration="underline"),m.innerText=R;break;default:m.innerText=R;break}},afterColumnMove(y,m,S,_,O){if(!O)return;const R=Array.from({length:h.countCols()},(T,D)=>cce[h.getColHeader(D)]);localStorage.setItem("ame-info-columns",JSON.stringify(R))}}),d=document.querySelector(".app-container");d.style.paddingBottom=lr.clientHeight+"px";async function f(){const y=await da(e,r);if(!y)return;t=y,console.log("Album Info:",y);let m="Album Info";y.attributes.isComplete||(m+=` (Incomplete - ${y.relationships.tracks.data.length}/${y.attributes.trackCount})`),i.innerText=m,a.style.display=y.attributes.isComplete?"":"none";const S=y.relationships.tracks.data.map(_=>({id:_.id,discNumber:_.attributes.discNumber,trackNumber:_.attributes.trackNumber,duration:hce(_.attributes.durationInMillis),isrc:_.attributes.isrc??"",upc:y.attributes.upc??"",albumDate:y.attributes.releaseDate??"",trackDate:_.attributes.releaseDate??"",locale:_.attributes.audioLocale??"",lyrics:_.attributes.hasLyrics?_.attributes.hasTimeSyncedLyrics?"S":"U":"",genres:_.attributes.genreNames.join("\\\\"),composer:_.attributes.composerName??"",artist:_.attributes.artistName,title:_.attributes.name,label:y.attributes.recordLabel??"",copyright:y.attributes.copyright??"",albumArtist:y.attributes.artistName,albumTitle:y.attributes.name}));h.updateData(S)}await f(),o.addEventListener("change",async y=>{r=y.target.value,localStorage.setItem("ame-info-storefront",r),await f()})}function cg(){ug=!1,lr==null||lr.remove(),lr=null;const e=document.querySelector(".app-container");e&&(e.style.paddingBottom="")}function hce(e){let t=Math.floor(e/1e3);const r=Math.floor(t/60);return t=t%60,`${r}:${t.toString().padStart(2,"0")}`}document.addEventListener("keydown",e=>{e.target.matches("input.search-input__text-field")&&(e.stopPropagation(),e.stopImmediatePropagation())}),sx(()=>MusicKit==null?void 0:MusicKit.getInstance()).then(e=>{e.addEventListener(MusicKit.Events.playbackStateDidChange,async t=>{e.isAuthorized||t.state===MusicKit.PlaybackStates.ended&&await e.skipToNextItem()})});const fg=ki("Seed MusicBrainz",`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" slot="app-icon">
	<path d="M440-120v-319q-64 0-123-24.5T213-533q-45-45-69-104t-24-123v-80h80q63 0 122 24.5T426-746q31 31 51.5 68t31.5 79q5-7 11-13.5t13-13.5q45-45 104-69.5T760-720h80v80q0 64-24.5 123T746-413q-45 45-103.5 69T520-320v200h-80Zm0-400q0-48-18.5-91.5T369-689q-34-34-77.5-52.5T200-760q0 48 18 92t52 78q34 34 78 52t92 18Zm80 120q48 0 91.5-18t77.5-52q34-34 52.5-78t18.5-92q-48 0-92 18.5T590-569q-34 34-52 77.5T520-400Zm0 0Zm-80-120Z" />
</svg>
`);fg.addEventListener("click",()=>{open(`https://seed.musichoarders.xyz?identifier=${encodeURIComponent(location.href)}`,"_blank")}),Ln(()=>{Ai(fg,500)}),fa(()=>{va(fg)});const dce=".ame-color-primary{color:var(--systemPrimary)}.ame-color-secondary{color:var(--systemSecondary)}.ame-color-tertiary{color:var(--systemTertiary)}.ame-color-warning{color:var(--systemYellow)}.upsell-banner,.banner-container,.navigation__native-cta{display:none!important}div[slot=artwork]{height:fit-content}.page-error{width:100%!important;max-width:960px!important}.headings__title,.headings__subtitles *,.description *{user-select:text;-moz-user-select:text;-webkit-user-select:text}.navigation-items__header[data-ame]{border-radius:6px;font-size:10px;font-weight:600;letter-spacing:0;line-height:1.3;margin:0 20px -3px;padding:4px 6px;color:var(--systemSecondary)}.navigation-items__list[data-ame]{font-size:15px;padding:0 25px 9px;font-weight:400;letter-spacing:0}.navigation-item[data-ame]{margin-bottom:1px;height:32px;padding:4px;position:relative;border-radius:6px;--linkHoverTextDecoration: none}.navigation-item__link[data-ame]{align-items:center;border-radius:6px;box-sizing:content-box;-moz-column-gap:8px;column-gap:8px;display:flex;height:100%;margin:-3px;padding:3px;width:100%;font-size:.8rem}.navigation-item__link[data-ame] svg{width:24px;height:24px;fill:var(--systemSecondary);background-color:transparent;display:inline-block;flex-shrink:0}.ame-album-badges-container>svg{margin-right:1em;margin-top:1em;fill:var(--systemSecondary)}.ame-album-storefronts-header{margin:0 var(--bodyGutter);font-size:1.1em}.ame-album-storefronts-container{display:flex;margin:0 var(--bodyGutter);margin-bottom:var(--bodyGutter);padding-top:1em;line-height:2.2;text-align:justify;flex-direction:column}.ame-album-storefronts-container>div:not(:last-child):not(:empty){padding-bottom:1em}.ame-album-storefronts-container *{-webkit-user-select:text;user-select:text}.ame-table-band{background-color:#eee!important}#ame-dock{z-index:999999;position:fixed;left:0;bottom:0;width:100%;background-color:#fff}#ame-dock-title{width:100%;padding:.5rem;background-color:var(--keyColorBG);color:#fff;font-weight:700;cursor:pointer}#ame-dock-control{display:flex;padding:.5rem;background-color:var(--pageBG);align-items:center;gap:1rem}#ame-dock-control input,#ame-dock-control select{padding:.1rem}#ame-dock-control button{margin-top:1px;padding:.1rem}";GM.addStyle(Gl),GM.addStyle(dce),Yl("iframe[src^='/includes/commerce/subscribe']",{timeout:0}).then(e=>{e==null||e.remove()})});
